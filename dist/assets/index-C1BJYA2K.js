var iv=Object.defineProperty;var ov=(t,e,n)=>e in t?iv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Q=(t,e,n)=>ov(t,typeof e!="symbol"?e+"":e,n);function av(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function lv(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var Ep={exports:{}},il={},Mp={exports:{}},te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oo=Symbol.for("react.element"),cv=Symbol.for("react.portal"),dv=Symbol.for("react.fragment"),uv=Symbol.for("react.strict_mode"),hv=Symbol.for("react.profiler"),fv=Symbol.for("react.provider"),mv=Symbol.for("react.context"),pv=Symbol.for("react.forward_ref"),gv=Symbol.for("react.suspense"),xv=Symbol.for("react.memo"),yv=Symbol.for("react.lazy"),xh=Symbol.iterator;function vv(t){return t===null||typeof t!="object"?null:(t=xh&&t[xh]||t["@@iterator"],typeof t=="function"?t:null)}var Tp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Op=Object.assign,Ap={};function Mr(t,e,n){this.props=t,this.context=e,this.refs=Ap,this.updater=n||Tp}Mr.prototype.isReactComponent={};Mr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Mr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Rp(){}Rp.prototype=Mr.prototype;function Qd(t,e,n){this.props=t,this.context=e,this.refs=Ap,this.updater=n||Tp}var Gd=Qd.prototype=new Rp;Gd.constructor=Qd;Op(Gd,Mr.prototype);Gd.isPureReactComponent=!0;var yh=Array.isArray,Dp=Object.prototype.hasOwnProperty,Kd={current:null},Ip={key:!0,ref:!0,__self:!0,__source:!0};function Lp(t,e,n){var s,r={},i=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Dp.call(e,s)&&!Ip.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:oo,type:t,key:i,ref:a,props:r,_owner:Kd.current}}function bv(t,e){return{$$typeof:oo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jd(t){return typeof t=="object"&&t!==null&&t.$$typeof===oo}function wv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vh=/\/+/g;function Hl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wv(""+t.key):e.toString(36)}function ta(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case oo:case cv:a=!0}}if(a)return a=t,r=r(a),t=s===""?"."+Hl(a,0):s,yh(r)?(n="",t!=null&&(n=t.replace(vh,"$&/")+"/"),ta(r,e,n,"",function(d){return d})):r!=null&&(Jd(r)&&(r=bv(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(vh,"$&/")+"/")+t)),e.push(r)),1;if(a=0,s=s===""?".":s+":",yh(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+Hl(i,l);a+=ta(i,e,n,c,r)}else if(c=vv(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+Hl(i,l++),a+=ta(i,e,n,c,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function vo(t,e,n){if(t==null)return t;var s=[],r=0;return ta(t,s,"","",function(i){return e.call(n,i,r++)}),s}function _v(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var et={current:null},na={transition:null},jv={ReactCurrentDispatcher:et,ReactCurrentBatchConfig:na,ReactCurrentOwner:Kd};function Fp(){throw Error("act(...) is not supported in production builds of React.")}te.Children={map:vo,forEach:function(t,e,n){vo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vo(t,function(){e++}),e},toArray:function(t){return vo(t,function(e){return e})||[]},only:function(t){if(!Jd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};te.Component=Mr;te.Fragment=dv;te.Profiler=hv;te.PureComponent=Qd;te.StrictMode=uv;te.Suspense=gv;te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jv;te.act=Fp;te.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=Op({},t.props),r=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Kd.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Dp.call(e,c)&&!Ip.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:oo,type:t.type,key:r,ref:i,props:s,_owner:a}};te.createContext=function(t){return t={$$typeof:mv,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fv,_context:t},t.Consumer=t};te.createElement=Lp;te.createFactory=function(t){var e=Lp.bind(null,t);return e.type=t,e};te.createRef=function(){return{current:null}};te.forwardRef=function(t){return{$$typeof:pv,render:t}};te.isValidElement=Jd;te.lazy=function(t){return{$$typeof:yv,_payload:{_status:-1,_result:t},_init:_v}};te.memo=function(t,e){return{$$typeof:xv,type:t,compare:e===void 0?null:e}};te.startTransition=function(t){var e=na.transition;na.transition={};try{t()}finally{na.transition=e}};te.unstable_act=Fp;te.useCallback=function(t,e){return et.current.useCallback(t,e)};te.useContext=function(t){return et.current.useContext(t)};te.useDebugValue=function(){};te.useDeferredValue=function(t){return et.current.useDeferredValue(t)};te.useEffect=function(t,e){return et.current.useEffect(t,e)};te.useId=function(){return et.current.useId()};te.useImperativeHandle=function(t,e,n){return et.current.useImperativeHandle(t,e,n)};te.useInsertionEffect=function(t,e){return et.current.useInsertionEffect(t,e)};te.useLayoutEffect=function(t,e){return et.current.useLayoutEffect(t,e)};te.useMemo=function(t,e){return et.current.useMemo(t,e)};te.useReducer=function(t,e,n){return et.current.useReducer(t,e,n)};te.useRef=function(t){return et.current.useRef(t)};te.useState=function(t){return et.current.useState(t)};te.useSyncExternalStore=function(t,e,n){return et.current.useSyncExternalStore(t,e,n)};te.useTransition=function(){return et.current.useTransition()};te.version="18.3.1";Mp.exports=te;var w=Mp.exports;const Ke=Pp(w),Nv=av({__proto__:null,default:Ke},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv=w,kv=Symbol.for("react.element"),Cv=Symbol.for("react.fragment"),Pv=Object.prototype.hasOwnProperty,Ev=Sv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mv={key:!0,ref:!0,__self:!0,__source:!0};function Bp(t,e,n){var s,r={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Pv.call(e,s)&&!Mv.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:kv,type:t,key:i,ref:a,props:r,_owner:Ev.current}}il.Fragment=Cv;il.jsx=Bp;il.jsxs=Bp;Ep.exports=il;var o=Ep.exports,$p={exports:{}},yt={},zp={exports:{}},Up={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,z){var U=O.length;O.push(z);e:for(;0<U;){var K=U-1>>>1,G=O[K];if(0<r(G,z))O[K]=z,O[U]=G,U=K;else break e}}function n(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var z=O[0],U=O.pop();if(U!==z){O[0]=U;e:for(var K=0,G=O.length,ye=G>>>1;K<ye;){var F=2*(K+1)-1,J=O[F],X=F+1,Wt=O[X];if(0>r(J,U))X<G&&0>r(Wt,J)?(O[K]=Wt,O[X]=U,K=X):(O[K]=J,O[F]=U,K=F);else if(X<G&&0>r(Wt,U))O[K]=Wt,O[X]=U,K=X;else break e}}return z}function r(O,z){var U=O.sortIndex-z.sortIndex;return U!==0?U:O.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,h=null,f=3,m=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var z=n(d);z!==null;){if(z.callback===null)s(d);else if(z.startTime<=O)s(d),z.sortIndex=z.expirationTime,e(c,z);else break;z=n(d)}}function j(O){if(g=!1,b(O),!x)if(n(c)!==null)x=!0,N(_);else{var z=n(d);z!==null&&R(j,z.startTime-O)}}function _(O,z){x=!1,g&&(g=!1,v(k),k=-1),m=!0;var U=f;try{for(b(z),h=n(c);h!==null&&(!(h.expirationTime>z)||O&&!D());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var G=K(h.expirationTime<=z);z=t.unstable_now(),typeof G=="function"?h.callback=G:h===n(c)&&s(c),b(z)}else s(c);h=n(c)}if(h!==null)var ye=!0;else{var F=n(d);F!==null&&R(j,F.startTime-z),ye=!1}return ye}finally{h=null,f=U,m=!1}}var C=!1,S=null,k=-1,A=5,P=-1;function D(){return!(t.unstable_now()-P<A)}function M(){if(S!==null){var O=t.unstable_now();P=O;var z=!0;try{z=S(!0,O)}finally{z?B():(C=!1,S=null)}}else C=!1}var B;if(typeof p=="function")B=function(){p(M)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,T=E.port2;E.port1.onmessage=M,B=function(){T.postMessage(null)}}else B=function(){y(M,0)};function N(O){S=O,C||(C=!0,B())}function R(O,z){k=y(function(){O(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){x||m||(x=!0,N(_))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(O){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var U=f;f=z;try{return O()}finally{f=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,z){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var U=f;f=O;try{return z()}finally{f=U}},t.unstable_scheduleCallback=function(O,z,U){var K=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?K+U:K):U=K,O){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=U+G,O={id:u++,callback:z,priorityLevel:O,startTime:U,expirationTime:G,sortIndex:-1},U>K?(O.sortIndex=U,e(d,O),n(c)===null&&O===n(d)&&(g?(v(k),k=-1):g=!0,R(j,U-K))):(O.sortIndex=G,e(c,O),x||m||(x=!0,N(_))),O},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(O){var z=f;return function(){var U=f;f=z;try{return O.apply(this,arguments)}finally{f=U}}}})(Up);zp.exports=Up;var Tv=zp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov=w,gt=Tv;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vp=new Set,Mi={};function Os(t,e){fr(t,e),fr(t+"Capture",e)}function fr(t,e){for(Mi[t]=e,t=0;t<e.length;t++)Vp.add(e[t])}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ic=Object.prototype.hasOwnProperty,Av=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bh={},wh={};function Rv(t){return Ic.call(wh,t)?!0:Ic.call(bh,t)?!1:Av.test(t)?wh[t]=!0:(bh[t]=!0,!1)}function Dv(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Iv(t,e,n,s){if(e===null||typeof e>"u"||Dv(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tt(t,e,n,s,r,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var $e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$e[t]=new tt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$e[e]=new tt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$e[t]=new tt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$e[t]=new tt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$e[t]=new tt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$e[t]=new tt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$e[t]=new tt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$e[t]=new tt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$e[t]=new tt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xd=/[\-:]([a-z])/g;function Zd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Xd,Zd);$e[e]=new tt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Xd,Zd);$e[e]=new tt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Xd,Zd);$e[e]=new tt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$e[t]=new tt(t,1,!1,t.toLowerCase(),null,!1,!1)});$e.xlinkHref=new tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$e[t]=new tt(t,1,!1,t.toLowerCase(),null,!0,!0)});function eu(t,e,n,s){var r=$e.hasOwnProperty(e)?$e[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Iv(e,n,r,s)&&(n=null),s||r===null?Rv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var vn=Ov.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bo=Symbol.for("react.element"),Vs=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),tu=Symbol.for("react.strict_mode"),Lc=Symbol.for("react.profiler"),Wp=Symbol.for("react.provider"),Hp=Symbol.for("react.context"),nu=Symbol.for("react.forward_ref"),Fc=Symbol.for("react.suspense"),Bc=Symbol.for("react.suspense_list"),su=Symbol.for("react.memo"),En=Symbol.for("react.lazy"),qp=Symbol.for("react.offscreen"),_h=Symbol.iterator;function Vr(t){return t===null||typeof t!="object"?null:(t=_h&&t[_h]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,ql;function ri(t){if(ql===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ql=e&&e[1]||""}return`
`+ql+t}var Yl=!1;function Ql(t,e){if(!t||Yl)return"";Yl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=s.stack.split(`
`),a=r.length-1,l=i.length-1;1<=a&&0<=l&&r[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(r[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||r[a]!==i[l]){var c=`
`+r[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Yl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ri(t):""}function Lv(t){switch(t.tag){case 5:return ri(t.type);case 16:return ri("Lazy");case 13:return ri("Suspense");case 19:return ri("SuspenseList");case 0:case 2:case 15:return t=Ql(t.type,!1),t;case 11:return t=Ql(t.type.render,!1),t;case 1:return t=Ql(t.type,!0),t;default:return""}}function $c(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ws:return"Fragment";case Vs:return"Portal";case Lc:return"Profiler";case tu:return"StrictMode";case Fc:return"Suspense";case Bc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Hp:return(t.displayName||"Context")+".Consumer";case Wp:return(t._context.displayName||"Context")+".Provider";case nu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case su:return e=t.displayName||null,e!==null?e:$c(t.type)||"Memo";case En:e=t._payload,t=t._init;try{return $c(t(e))}catch{}}return null}function Fv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $c(e);case 8:return e===tu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Jn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Bv(t){var e=Yp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){s=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wo(t){t._valueTracker||(t._valueTracker=Bv(t))}function Qp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=Yp(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function ya(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zc(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function jh(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Jn(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gp(t,e){e=e.checked,e!=null&&eu(t,"checked",e,!1)}function Uc(t,e){Gp(t,e);var n=Jn(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vc(t,e.type,Jn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Nh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vc(t,e,n){(e!=="number"||ya(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ii=Array.isArray;function nr(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Jn(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Wc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(ii(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Jn(n)}}function Kp(t,e){var n=Jn(e.value),s=Jn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function kh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Jp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Jp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _o,Xp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_o=_o||document.createElement("div"),_o.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_o.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ti(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$v=["Webkit","ms","Moz","O"];Object.keys(mi).forEach(function(t){$v.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mi[e]=mi[t]})});function Zp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mi.hasOwnProperty(t)&&mi[t]?(""+e).trim():e+"px"}function eg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=Zp(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var zv=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qc(t,e){if(e){if(zv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Yc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qc=null;function ru(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gc=null,sr=null,rr=null;function Ch(t){if(t=co(t)){if(typeof Gc!="function")throw Error(L(280));var e=t.stateNode;e&&(e=dl(e),Gc(t.stateNode,t.type,e))}}function tg(t){sr?rr?rr.push(t):rr=[t]:sr=t}function ng(){if(sr){var t=sr,e=rr;if(rr=sr=null,Ch(t),e)for(t=0;t<e.length;t++)Ch(e[t])}}function sg(t,e){return t(e)}function rg(){}var Gl=!1;function ig(t,e,n){if(Gl)return t(e,n);Gl=!0;try{return sg(t,e,n)}finally{Gl=!1,(sr!==null||rr!==null)&&(rg(),ng())}}function Oi(t,e){var n=t.stateNode;if(n===null)return null;var s=dl(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Kc=!1;if(pn)try{var Wr={};Object.defineProperty(Wr,"passive",{get:function(){Kc=!0}}),window.addEventListener("test",Wr,Wr),window.removeEventListener("test",Wr,Wr)}catch{Kc=!1}function Uv(t,e,n,s,r,i,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var pi=!1,va=null,ba=!1,Jc=null,Vv={onError:function(t){pi=!0,va=t}};function Wv(t,e,n,s,r,i,a,l,c){pi=!1,va=null,Uv.apply(Vv,arguments)}function Hv(t,e,n,s,r,i,a,l,c){if(Wv.apply(this,arguments),pi){if(pi){var d=va;pi=!1,va=null}else throw Error(L(198));ba||(ba=!0,Jc=d)}}function As(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function og(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ph(t){if(As(t)!==t)throw Error(L(188))}function qv(t){var e=t.alternate;if(!e){if(e=As(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Ph(r),t;if(i===s)return Ph(r),e;i=i.sibling}throw Error(L(188))}if(n.return!==s.return)n=r,s=i;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,s=i;break}if(l===s){a=!0,s=r,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,s=r;break}if(l===s){a=!0,s=i,n=r;break}l=l.sibling}if(!a)throw Error(L(189))}}if(n.alternate!==s)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function ag(t){return t=qv(t),t!==null?lg(t):null}function lg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lg(t);if(e!==null)return e;t=t.sibling}return null}var cg=gt.unstable_scheduleCallback,Eh=gt.unstable_cancelCallback,Yv=gt.unstable_shouldYield,Qv=gt.unstable_requestPaint,Se=gt.unstable_now,Gv=gt.unstable_getCurrentPriorityLevel,iu=gt.unstable_ImmediatePriority,dg=gt.unstable_UserBlockingPriority,wa=gt.unstable_NormalPriority,Kv=gt.unstable_LowPriority,ug=gt.unstable_IdlePriority,ol=null,Zt=null;function Jv(t){if(Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(ol,t,void 0,(t.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:eb,Xv=Math.log,Zv=Math.LN2;function eb(t){return t>>>=0,t===0?32:31-(Xv(t)/Zv|0)|0}var jo=64,No=4194304;function oi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function _a(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~r;l!==0?s=oi(l):(i&=a,i!==0&&(s=oi(i)))}else a=n&~r,a!==0?s=oi(a):i!==0&&(s=oi(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-$t(e),r=1<<n,s|=t[n],e&=~r;return s}function tb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nb(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-$t(i),l=1<<a,c=r[a];c===-1?(!(l&n)||l&s)&&(r[a]=tb(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Xc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hg(){var t=jo;return jo<<=1,!(jo&4194240)&&(jo=64),t}function Kl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ao(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$t(e),t[e]=n}function sb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-$t(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function ou(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-$t(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var le=0;function fg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mg,au,pg,gg,xg,Zc=!1,So=[],zn=null,Un=null,Vn=null,Ai=new Map,Ri=new Map,On=[],rb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mh(t,e){switch(t){case"focusin":case"focusout":zn=null;break;case"dragenter":case"dragleave":Un=null;break;case"mouseover":case"mouseout":Vn=null;break;case"pointerover":case"pointerout":Ai.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ri.delete(e.pointerId)}}function Hr(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=co(e),e!==null&&au(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function ib(t,e,n,s,r){switch(e){case"focusin":return zn=Hr(zn,t,e,n,s,r),!0;case"dragenter":return Un=Hr(Un,t,e,n,s,r),!0;case"mouseover":return Vn=Hr(Vn,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return Ai.set(i,Hr(Ai.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Ri.set(i,Hr(Ri.get(i)||null,t,e,n,s,r)),!0}return!1}function yg(t){var e=xs(t.target);if(e!==null){var n=As(e);if(n!==null){if(e=n.tag,e===13){if(e=og(n),e!==null){t.blockedOn=e,xg(t.priority,function(){pg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ed(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Qc=s,n.target.dispatchEvent(s),Qc=null}else return e=co(n),e!==null&&au(e),t.blockedOn=n,!1;e.shift()}return!0}function Th(t,e,n){sa(t)&&n.delete(e)}function ob(){Zc=!1,zn!==null&&sa(zn)&&(zn=null),Un!==null&&sa(Un)&&(Un=null),Vn!==null&&sa(Vn)&&(Vn=null),Ai.forEach(Th),Ri.forEach(Th)}function qr(t,e){t.blockedOn===e&&(t.blockedOn=null,Zc||(Zc=!0,gt.unstable_scheduleCallback(gt.unstable_NormalPriority,ob)))}function Di(t){function e(r){return qr(r,t)}if(0<So.length){qr(So[0],t);for(var n=1;n<So.length;n++){var s=So[n];s.blockedOn===t&&(s.blockedOn=null)}}for(zn!==null&&qr(zn,t),Un!==null&&qr(Un,t),Vn!==null&&qr(Vn,t),Ai.forEach(e),Ri.forEach(e),n=0;n<On.length;n++)s=On[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<On.length&&(n=On[0],n.blockedOn===null);)yg(n),n.blockedOn===null&&On.shift()}var ir=vn.ReactCurrentBatchConfig,ja=!0;function ab(t,e,n,s){var r=le,i=ir.transition;ir.transition=null;try{le=1,lu(t,e,n,s)}finally{le=r,ir.transition=i}}function lb(t,e,n,s){var r=le,i=ir.transition;ir.transition=null;try{le=4,lu(t,e,n,s)}finally{le=r,ir.transition=i}}function lu(t,e,n,s){if(ja){var r=ed(t,e,n,s);if(r===null)oc(t,e,s,Na,n),Mh(t,s);else if(ib(r,t,e,n,s))s.stopPropagation();else if(Mh(t,s),e&4&&-1<rb.indexOf(t)){for(;r!==null;){var i=co(r);if(i!==null&&mg(i),i=ed(t,e,n,s),i===null&&oc(t,e,s,Na,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else oc(t,e,s,null,n)}}var Na=null;function ed(t,e,n,s){if(Na=null,t=ru(s),t=xs(t),t!==null)if(e=As(t),e===null)t=null;else if(n=e.tag,n===13){if(t=og(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Na=t,null}function vg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gv()){case iu:return 1;case dg:return 4;case wa:case Kv:return 16;case ug:return 536870912;default:return 16}default:return 16}}var Dn=null,cu=null,ra=null;function bg(){if(ra)return ra;var t,e=cu,n=e.length,s,r="value"in Dn?Dn.value:Dn.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===r[i-s];s++);return ra=r.slice(t,1<s?1-s:void 0)}function ia(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ko(){return!0}function Oh(){return!1}function vt(t){function e(n,s,r,i,a){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ko:Oh,this.isPropagationStopped=Oh,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ko)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ko)},persist:function(){},isPersistent:ko}),e}var Tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},du=vt(Tr),lo=je({},Tr,{view:0,detail:0}),cb=vt(lo),Jl,Xl,Yr,al=je({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Yr&&(Yr&&t.type==="mousemove"?(Jl=t.screenX-Yr.screenX,Xl=t.screenY-Yr.screenY):Xl=Jl=0,Yr=t),Jl)},movementY:function(t){return"movementY"in t?t.movementY:Xl}}),Ah=vt(al),db=je({},al,{dataTransfer:0}),ub=vt(db),hb=je({},lo,{relatedTarget:0}),Zl=vt(hb),fb=je({},Tr,{animationName:0,elapsedTime:0,pseudoElement:0}),mb=vt(fb),pb=je({},Tr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),gb=vt(pb),xb=je({},Tr,{data:0}),Rh=vt(xb),yb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bb[t])?!!e[t]:!1}function uu(){return wb}var _b=je({},lo,{key:function(t){if(t.key){var e=yb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ia(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uu,charCode:function(t){return t.type==="keypress"?ia(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ia(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jb=vt(_b),Nb=je({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dh=vt(Nb),Sb=je({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uu}),kb=vt(Sb),Cb=je({},Tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pb=vt(Cb),Eb=je({},al,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Mb=vt(Eb),Tb=[9,13,27,32],hu=pn&&"CompositionEvent"in window,gi=null;pn&&"documentMode"in document&&(gi=document.documentMode);var Ob=pn&&"TextEvent"in window&&!gi,wg=pn&&(!hu||gi&&8<gi&&11>=gi),Ih=" ",Lh=!1;function _g(t,e){switch(t){case"keyup":return Tb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hs=!1;function Ab(t,e){switch(t){case"compositionend":return jg(e);case"keypress":return e.which!==32?null:(Lh=!0,Ih);case"textInput":return t=e.data,t===Ih&&Lh?null:t;default:return null}}function Rb(t,e){if(Hs)return t==="compositionend"||!hu&&_g(t,e)?(t=bg(),ra=cu=Dn=null,Hs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wg&&e.locale!=="ko"?null:e.data;default:return null}}var Db={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Db[t.type]:e==="textarea"}function Ng(t,e,n,s){tg(s),e=Sa(e,"onChange"),0<e.length&&(n=new du("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var xi=null,Ii=null;function Ib(t){Dg(t,0)}function ll(t){var e=Qs(t);if(Qp(e))return t}function Lb(t,e){if(t==="change")return e}var Sg=!1;if(pn){var ec;if(pn){var tc="oninput"in document;if(!tc){var Bh=document.createElement("div");Bh.setAttribute("oninput","return;"),tc=typeof Bh.oninput=="function"}ec=tc}else ec=!1;Sg=ec&&(!document.documentMode||9<document.documentMode)}function $h(){xi&&(xi.detachEvent("onpropertychange",kg),Ii=xi=null)}function kg(t){if(t.propertyName==="value"&&ll(Ii)){var e=[];Ng(e,Ii,t,ru(t)),ig(Ib,e)}}function Fb(t,e,n){t==="focusin"?($h(),xi=e,Ii=n,xi.attachEvent("onpropertychange",kg)):t==="focusout"&&$h()}function Bb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ll(Ii)}function $b(t,e){if(t==="click")return ll(e)}function zb(t,e){if(t==="input"||t==="change")return ll(e)}function Ub(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ut=typeof Object.is=="function"?Object.is:Ub;function Li(t,e){if(Ut(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Ic.call(e,r)||!Ut(t[r],e[r]))return!1}return!0}function zh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Uh(t,e){var n=zh(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zh(n)}}function Cg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Cg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Pg(){for(var t=window,e=ya();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ya(t.document)}return e}function fu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Vb(t){var e=Pg(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Cg(n.ownerDocument.documentElement,n)){if(s!==null&&fu(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Uh(n,i);var a=Uh(n,s);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Wb=pn&&"documentMode"in document&&11>=document.documentMode,qs=null,td=null,yi=null,nd=!1;function Vh(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nd||qs==null||qs!==ya(s)||(s=qs,"selectionStart"in s&&fu(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),yi&&Li(yi,s)||(yi=s,s=Sa(td,"onSelect"),0<s.length&&(e=new du("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=qs)))}function Co(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ys={animationend:Co("Animation","AnimationEnd"),animationiteration:Co("Animation","AnimationIteration"),animationstart:Co("Animation","AnimationStart"),transitionend:Co("Transition","TransitionEnd")},nc={},Eg={};pn&&(Eg=document.createElement("div").style,"AnimationEvent"in window||(delete Ys.animationend.animation,delete Ys.animationiteration.animation,delete Ys.animationstart.animation),"TransitionEvent"in window||delete Ys.transitionend.transition);function cl(t){if(nc[t])return nc[t];if(!Ys[t])return t;var e=Ys[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Eg)return nc[t]=e[n];return t}var Mg=cl("animationend"),Tg=cl("animationiteration"),Og=cl("animationstart"),Ag=cl("transitionend"),Rg=new Map,Wh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(t,e){Rg.set(t,e),Os(e,[t])}for(var sc=0;sc<Wh.length;sc++){var rc=Wh[sc],Hb=rc.toLowerCase(),qb=rc[0].toUpperCase()+rc.slice(1);ts(Hb,"on"+qb)}ts(Mg,"onAnimationEnd");ts(Tg,"onAnimationIteration");ts(Og,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(Ag,"onTransitionEnd");fr("onMouseEnter",["mouseout","mouseover"]);fr("onMouseLeave",["mouseout","mouseover"]);fr("onPointerEnter",["pointerout","pointerover"]);fr("onPointerLeave",["pointerout","pointerover"]);Os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Os("onBeforeInput",["compositionend","keypress","textInput","paste"]);Os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ai="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ai));function Hh(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,Hv(s,e,void 0,t),t.currentTarget=null}function Dg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var a=s.length-1;0<=a;a--){var l=s[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;Hh(r,l,d),i=c}else for(a=0;a<s.length;a++){if(l=s[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;Hh(r,l,d),i=c}}}if(ba)throw t=Jc,ba=!1,Jc=null,t}function me(t,e){var n=e[ad];n===void 0&&(n=e[ad]=new Set);var s=t+"__bubble";n.has(s)||(Ig(e,t,2,!1),n.add(s))}function ic(t,e,n){var s=0;e&&(s|=4),Ig(n,t,s,e)}var Po="_reactListening"+Math.random().toString(36).slice(2);function Fi(t){if(!t[Po]){t[Po]=!0,Vp.forEach(function(n){n!=="selectionchange"&&(Yb.has(n)||ic(n,!1,t),ic(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Po]||(e[Po]=!0,ic("selectionchange",!1,e))}}function Ig(t,e,n,s){switch(vg(e)){case 1:var r=ab;break;case 4:r=lb;break;default:r=lu}n=r.bind(null,e,n,t),r=void 0,!Kc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function oc(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;a=a.return}for(;l!==null;){if(a=xs(l),a===null)return;if(c=a.tag,c===5||c===6){s=i=a;continue e}l=l.parentNode}}s=s.return}ig(function(){var d=i,u=ru(n),h=[];e:{var f=Rg.get(t);if(f!==void 0){var m=du,x=t;switch(t){case"keypress":if(ia(n)===0)break e;case"keydown":case"keyup":m=jb;break;case"focusin":x="focus",m=Zl;break;case"focusout":x="blur",m=Zl;break;case"beforeblur":case"afterblur":m=Zl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ah;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ub;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=kb;break;case Mg:case Tg:case Og:m=mb;break;case Ag:m=Pb;break;case"scroll":m=cb;break;case"wheel":m=Mb;break;case"copy":case"cut":case"paste":m=gb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Dh}var g=(e&4)!==0,y=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var p=d,b;p!==null;){b=p;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,v!==null&&(j=Oi(p,v),j!=null&&g.push(Bi(p,j,b)))),y)break;p=p.return}0<g.length&&(f=new m(f,x,null,n,u),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==Qc&&(x=n.relatedTarget||n.fromElement)&&(xs(x)||x[gn]))break e;if((m||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,m?(x=n.relatedTarget||n.toElement,m=d,x=x?xs(x):null,x!==null&&(y=As(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=d),m!==x)){if(g=Ah,j="onMouseLeave",v="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(g=Dh,j="onPointerLeave",v="onPointerEnter",p="pointer"),y=m==null?f:Qs(m),b=x==null?f:Qs(x),f=new g(j,p+"leave",m,n,u),f.target=y,f.relatedTarget=b,j=null,xs(u)===d&&(g=new g(v,p+"enter",x,n,u),g.target=b,g.relatedTarget=y,j=g),y=j,m&&x)t:{for(g=m,v=x,p=0,b=g;b;b=Ls(b))p++;for(b=0,j=v;j;j=Ls(j))b++;for(;0<p-b;)g=Ls(g),p--;for(;0<b-p;)v=Ls(v),b--;for(;p--;){if(g===v||v!==null&&g===v.alternate)break t;g=Ls(g),v=Ls(v)}g=null}else g=null;m!==null&&qh(h,f,m,g,!1),x!==null&&y!==null&&qh(h,y,x,g,!0)}}e:{if(f=d?Qs(d):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var _=Lb;else if(Fh(f))if(Sg)_=zb;else{_=Bb;var C=Fb}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=$b);if(_&&(_=_(t,d))){Ng(h,_,n,u);break e}C&&C(t,f,d),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Vc(f,"number",f.value)}switch(C=d?Qs(d):window,t){case"focusin":(Fh(C)||C.contentEditable==="true")&&(qs=C,td=d,yi=null);break;case"focusout":yi=td=qs=null;break;case"mousedown":nd=!0;break;case"contextmenu":case"mouseup":case"dragend":nd=!1,Vh(h,n,u);break;case"selectionchange":if(Wb)break;case"keydown":case"keyup":Vh(h,n,u)}var S;if(hu)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Hs?_g(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(wg&&n.locale!=="ko"&&(Hs||k!=="onCompositionStart"?k==="onCompositionEnd"&&Hs&&(S=bg()):(Dn=u,cu="value"in Dn?Dn.value:Dn.textContent,Hs=!0)),C=Sa(d,k),0<C.length&&(k=new Rh(k,t,null,n,u),h.push({event:k,listeners:C}),S?k.data=S:(S=jg(n),S!==null&&(k.data=S)))),(S=Ob?Ab(t,n):Rb(t,n))&&(d=Sa(d,"onBeforeInput"),0<d.length&&(u=new Rh("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:d}),u.data=S))}Dg(h,e)})}function Bi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Sa(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Oi(t,n),i!=null&&s.unshift(Bi(t,i,r)),i=Oi(t,e),i!=null&&s.push(Bi(t,i,r))),t=t.return}return s}function Ls(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function qh(t,e,n,s,r){for(var i=e._reactName,a=[];n!==null&&n!==s;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,r?(c=Oi(n,i),c!=null&&a.unshift(Bi(n,c,l))):r||(c=Oi(n,i),c!=null&&a.push(Bi(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Qb=/\r\n?/g,Gb=/\u0000|\uFFFD/g;function Yh(t){return(typeof t=="string"?t:""+t).replace(Qb,`
`).replace(Gb,"")}function Eo(t,e,n){if(e=Yh(e),Yh(t)!==e&&n)throw Error(L(425))}function ka(){}var sd=null,rd=null;function id(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var od=typeof setTimeout=="function"?setTimeout:void 0,Kb=typeof clearTimeout=="function"?clearTimeout:void 0,Qh=typeof Promise=="function"?Promise:void 0,Jb=typeof queueMicrotask=="function"?queueMicrotask:typeof Qh<"u"?function(t){return Qh.resolve(null).then(t).catch(Xb)}:od;function Xb(t){setTimeout(function(){throw t})}function ac(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Di(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Di(e)}function Wn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Gh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Or=Math.random().toString(36).slice(2),Kt="__reactFiber$"+Or,$i="__reactProps$"+Or,gn="__reactContainer$"+Or,ad="__reactEvents$"+Or,Zb="__reactListeners$"+Or,ew="__reactHandles$"+Or;function xs(t){var e=t[Kt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[gn]||n[Kt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Gh(t);t!==null;){if(n=t[Kt])return n;t=Gh(t)}return e}t=n,n=t.parentNode}return null}function co(t){return t=t[Kt]||t[gn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function dl(t){return t[$i]||null}var ld=[],Gs=-1;function ns(t){return{current:t}}function ge(t){0>Gs||(t.current=ld[Gs],ld[Gs]=null,Gs--)}function he(t,e){Gs++,ld[Gs]=t.current,t.current=e}var Xn={},Qe=ns(Xn),lt=ns(!1),ks=Xn;function mr(t,e){var n=t.type.contextTypes;if(!n)return Xn;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ct(t){return t=t.childContextTypes,t!=null}function Ca(){ge(lt),ge(Qe)}function Kh(t,e,n){if(Qe.current!==Xn)throw Error(L(168));he(Qe,e),he(lt,n)}function Lg(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(L(108,Fv(t)||"Unknown",r));return je({},n,s)}function Pa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xn,ks=Qe.current,he(Qe,t),he(lt,lt.current),!0}function Jh(t,e,n){var s=t.stateNode;if(!s)throw Error(L(169));n?(t=Lg(t,e,ks),s.__reactInternalMemoizedMergedChildContext=t,ge(lt),ge(Qe),he(Qe,t)):ge(lt),he(lt,n)}var dn=null,ul=!1,lc=!1;function Fg(t){dn===null?dn=[t]:dn.push(t)}function tw(t){ul=!0,Fg(t)}function ss(){if(!lc&&dn!==null){lc=!0;var t=0,e=le;try{var n=dn;for(le=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}dn=null,ul=!1}catch(r){throw dn!==null&&(dn=dn.slice(t+1)),cg(iu,ss),r}finally{le=e,lc=!1}}return null}var Ks=[],Js=0,Ea=null,Ma=0,wt=[],_t=0,Cs=null,hn=1,fn="";function ds(t,e){Ks[Js++]=Ma,Ks[Js++]=Ea,Ea=t,Ma=e}function Bg(t,e,n){wt[_t++]=hn,wt[_t++]=fn,wt[_t++]=Cs,Cs=t;var s=hn;t=fn;var r=32-$t(s)-1;s&=~(1<<r),n+=1;var i=32-$t(e)+r;if(30<i){var a=r-r%5;i=(s&(1<<a)-1).toString(32),s>>=a,r-=a,hn=1<<32-$t(e)+r|n<<r|s,fn=i+t}else hn=1<<i|n<<r|s,fn=t}function mu(t){t.return!==null&&(ds(t,1),Bg(t,1,0))}function pu(t){for(;t===Ea;)Ea=Ks[--Js],Ks[Js]=null,Ma=Ks[--Js],Ks[Js]=null;for(;t===Cs;)Cs=wt[--_t],wt[_t]=null,fn=wt[--_t],wt[_t]=null,hn=wt[--_t],wt[_t]=null}var pt=null,ft=null,xe=!1,Ft=null;function $g(t,e){var n=jt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Xh(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,pt=t,ft=Wn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,pt=t,ft=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cs!==null?{id:hn,overflow:fn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,pt=t,ft=null,!0):!1;default:return!1}}function cd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dd(t){if(xe){var e=ft;if(e){var n=e;if(!Xh(t,e)){if(cd(t))throw Error(L(418));e=Wn(n.nextSibling);var s=pt;e&&Xh(t,e)?$g(s,n):(t.flags=t.flags&-4097|2,xe=!1,pt=t)}}else{if(cd(t))throw Error(L(418));t.flags=t.flags&-4097|2,xe=!1,pt=t}}}function Zh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pt=t}function Mo(t){if(t!==pt)return!1;if(!xe)return Zh(t),xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!id(t.type,t.memoizedProps)),e&&(e=ft)){if(cd(t))throw zg(),Error(L(418));for(;e;)$g(t,e),e=Wn(e.nextSibling)}if(Zh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ft=Wn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ft=null}}else ft=pt?Wn(t.stateNode.nextSibling):null;return!0}function zg(){for(var t=ft;t;)t=Wn(t.nextSibling)}function pr(){ft=pt=null,xe=!1}function gu(t){Ft===null?Ft=[t]:Ft.push(t)}var nw=vn.ReactCurrentBatchConfig;function Qr(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var s=n.stateNode}if(!s)throw Error(L(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=r.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function To(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ef(t){var e=t._init;return e(t._payload)}function Ug(t){function e(v,p){if(t){var b=v.deletions;b===null?(v.deletions=[p],v.flags|=16):b.push(p)}}function n(v,p){if(!t)return null;for(;p!==null;)e(v,p),p=p.sibling;return null}function s(v,p){for(v=new Map;p!==null;)p.key!==null?v.set(p.key,p):v.set(p.index,p),p=p.sibling;return v}function r(v,p){return v=Qn(v,p),v.index=0,v.sibling=null,v}function i(v,p,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<p?(v.flags|=2,p):b):(v.flags|=2,p)):(v.flags|=1048576,p)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,p,b,j){return p===null||p.tag!==6?(p=pc(b,v.mode,j),p.return=v,p):(p=r(p,b),p.return=v,p)}function c(v,p,b,j){var _=b.type;return _===Ws?u(v,p,b.props.children,j,b.key):p!==null&&(p.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===En&&ef(_)===p.type)?(j=r(p,b.props),j.ref=Qr(v,p,b),j.return=v,j):(j=ha(b.type,b.key,b.props,null,v.mode,j),j.ref=Qr(v,p,b),j.return=v,j)}function d(v,p,b,j){return p===null||p.tag!==4||p.stateNode.containerInfo!==b.containerInfo||p.stateNode.implementation!==b.implementation?(p=gc(b,v.mode,j),p.return=v,p):(p=r(p,b.children||[]),p.return=v,p)}function u(v,p,b,j,_){return p===null||p.tag!==7?(p=Ns(b,v.mode,j,_),p.return=v,p):(p=r(p,b),p.return=v,p)}function h(v,p,b){if(typeof p=="string"&&p!==""||typeof p=="number")return p=pc(""+p,v.mode,b),p.return=v,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case bo:return b=ha(p.type,p.key,p.props,null,v.mode,b),b.ref=Qr(v,null,p),b.return=v,b;case Vs:return p=gc(p,v.mode,b),p.return=v,p;case En:var j=p._init;return h(v,j(p._payload),b)}if(ii(p)||Vr(p))return p=Ns(p,v.mode,b,null),p.return=v,p;To(v,p)}return null}function f(v,p,b,j){var _=p!==null?p.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:l(v,p,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bo:return b.key===_?c(v,p,b,j):null;case Vs:return b.key===_?d(v,p,b,j):null;case En:return _=b._init,f(v,p,_(b._payload),j)}if(ii(b)||Vr(b))return _!==null?null:u(v,p,b,j,null);To(v,b)}return null}function m(v,p,b,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return v=v.get(b)||null,l(p,v,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case bo:return v=v.get(j.key===null?b:j.key)||null,c(p,v,j,_);case Vs:return v=v.get(j.key===null?b:j.key)||null,d(p,v,j,_);case En:var C=j._init;return m(v,p,b,C(j._payload),_)}if(ii(j)||Vr(j))return v=v.get(b)||null,u(p,v,j,_,null);To(p,j)}return null}function x(v,p,b,j){for(var _=null,C=null,S=p,k=p=0,A=null;S!==null&&k<b.length;k++){S.index>k?(A=S,S=null):A=S.sibling;var P=f(v,S,b[k],j);if(P===null){S===null&&(S=A);break}t&&S&&P.alternate===null&&e(v,S),p=i(P,p,k),C===null?_=P:C.sibling=P,C=P,S=A}if(k===b.length)return n(v,S),xe&&ds(v,k),_;if(S===null){for(;k<b.length;k++)S=h(v,b[k],j),S!==null&&(p=i(S,p,k),C===null?_=S:C.sibling=S,C=S);return xe&&ds(v,k),_}for(S=s(v,S);k<b.length;k++)A=m(S,v,k,b[k],j),A!==null&&(t&&A.alternate!==null&&S.delete(A.key===null?k:A.key),p=i(A,p,k),C===null?_=A:C.sibling=A,C=A);return t&&S.forEach(function(D){return e(v,D)}),xe&&ds(v,k),_}function g(v,p,b,j){var _=Vr(b);if(typeof _!="function")throw Error(L(150));if(b=_.call(b),b==null)throw Error(L(151));for(var C=_=null,S=p,k=p=0,A=null,P=b.next();S!==null&&!P.done;k++,P=b.next()){S.index>k?(A=S,S=null):A=S.sibling;var D=f(v,S,P.value,j);if(D===null){S===null&&(S=A);break}t&&S&&D.alternate===null&&e(v,S),p=i(D,p,k),C===null?_=D:C.sibling=D,C=D,S=A}if(P.done)return n(v,S),xe&&ds(v,k),_;if(S===null){for(;!P.done;k++,P=b.next())P=h(v,P.value,j),P!==null&&(p=i(P,p,k),C===null?_=P:C.sibling=P,C=P);return xe&&ds(v,k),_}for(S=s(v,S);!P.done;k++,P=b.next())P=m(S,v,k,P.value,j),P!==null&&(t&&P.alternate!==null&&S.delete(P.key===null?k:P.key),p=i(P,p,k),C===null?_=P:C.sibling=P,C=P);return t&&S.forEach(function(M){return e(v,M)}),xe&&ds(v,k),_}function y(v,p,b,j){if(typeof b=="object"&&b!==null&&b.type===Ws&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case bo:e:{for(var _=b.key,C=p;C!==null;){if(C.key===_){if(_=b.type,_===Ws){if(C.tag===7){n(v,C.sibling),p=r(C,b.props.children),p.return=v,v=p;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===En&&ef(_)===C.type){n(v,C.sibling),p=r(C,b.props),p.ref=Qr(v,C,b),p.return=v,v=p;break e}n(v,C);break}else e(v,C);C=C.sibling}b.type===Ws?(p=Ns(b.props.children,v.mode,j,b.key),p.return=v,v=p):(j=ha(b.type,b.key,b.props,null,v.mode,j),j.ref=Qr(v,p,b),j.return=v,v=j)}return a(v);case Vs:e:{for(C=b.key;p!==null;){if(p.key===C)if(p.tag===4&&p.stateNode.containerInfo===b.containerInfo&&p.stateNode.implementation===b.implementation){n(v,p.sibling),p=r(p,b.children||[]),p.return=v,v=p;break e}else{n(v,p);break}else e(v,p);p=p.sibling}p=gc(b,v.mode,j),p.return=v,v=p}return a(v);case En:return C=b._init,y(v,p,C(b._payload),j)}if(ii(b))return x(v,p,b,j);if(Vr(b))return g(v,p,b,j);To(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,p!==null&&p.tag===6?(n(v,p.sibling),p=r(p,b),p.return=v,v=p):(n(v,p),p=pc(b,v.mode,j),p.return=v,v=p),a(v)):n(v,p)}return y}var gr=Ug(!0),Vg=Ug(!1),Ta=ns(null),Oa=null,Xs=null,xu=null;function yu(){xu=Xs=Oa=null}function vu(t){var e=Ta.current;ge(Ta),t._currentValue=e}function ud(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function or(t,e){Oa=t,xu=Xs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(at=!0),t.firstContext=null)}function Ct(t){var e=t._currentValue;if(xu!==t)if(t={context:t,memoizedValue:e,next:null},Xs===null){if(Oa===null)throw Error(L(308));Xs=t,Oa.dependencies={lanes:0,firstContext:t}}else Xs=Xs.next=t;return e}var ys=null;function bu(t){ys===null?ys=[t]:ys.push(t)}function Wg(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,bu(e)):(n.next=r.next,r.next=n),e.interleaved=n,xn(t,s)}function xn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Mn=!1;function wu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hn(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,re&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,xn(t,n)}return r=s.interleaved,r===null?(e.next=e,bu(s)):(e.next=r.next,r.next=e),s.interleaved=e,xn(t,n)}function oa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ou(t,n)}}function tf(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Aa(t,e,n,s){var r=t.updateQueue;Mn=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var h=r.baseState;a=0,u=d=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((s&f)===f){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,g=l;switch(f=e,m=n,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(m,h,f);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,f=typeof x=="function"?x.call(m,h,f):x,f==null)break e;h=je({},h,f);break e;case 2:Mn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=h):u=u.next=m,a|=f;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;f=l,l=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(c=h),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Es|=a,t.lanes=a,t.memoizedState=h}}function nf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(L(191,r));r.call(s)}}}var uo={},en=ns(uo),zi=ns(uo),Ui=ns(uo);function vs(t){if(t===uo)throw Error(L(174));return t}function _u(t,e){switch(he(Ui,e),he(zi,t),he(en,uo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hc(e,t)}ge(en),he(en,e)}function xr(){ge(en),ge(zi),ge(Ui)}function qg(t){vs(Ui.current);var e=vs(en.current),n=Hc(e,t.type);e!==n&&(he(zi,t),he(en,n))}function ju(t){zi.current===t&&(ge(en),ge(zi))}var be=ns(0);function Ra(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cc=[];function Nu(){for(var t=0;t<cc.length;t++)cc[t]._workInProgressVersionPrimary=null;cc.length=0}var aa=vn.ReactCurrentDispatcher,dc=vn.ReactCurrentBatchConfig,Ps=0,we=null,Pe=null,Ae=null,Da=!1,vi=!1,Vi=0,sw=0;function Ve(){throw Error(L(321))}function Su(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ut(t[n],e[n]))return!1;return!0}function ku(t,e,n,s,r,i){if(Ps=i,we=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,aa.current=t===null||t.memoizedState===null?aw:lw,t=n(s,r),vi){i=0;do{if(vi=!1,Vi=0,25<=i)throw Error(L(301));i+=1,Ae=Pe=null,e.updateQueue=null,aa.current=cw,t=n(s,r)}while(vi)}if(aa.current=Ia,e=Pe!==null&&Pe.next!==null,Ps=0,Ae=Pe=we=null,Da=!1,e)throw Error(L(300));return t}function Cu(){var t=Vi!==0;return Vi=0,t}function Qt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ae===null?we.memoizedState=Ae=t:Ae=Ae.next=t,Ae}function Pt(){if(Pe===null){var t=we.alternate;t=t!==null?t.memoizedState:null}else t=Pe.next;var e=Ae===null?we.memoizedState:Ae.next;if(e!==null)Ae=e,Pe=t;else{if(t===null)throw Error(L(310));Pe=t,t={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},Ae===null?we.memoizedState=Ae=t:Ae=Ae.next=t}return Ae}function Wi(t,e){return typeof e=="function"?e(t):e}function uc(t){var e=Pt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var s=Pe,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var a=r.next;r.next=i.next,i.next=a}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var l=a=null,c=null,d=i;do{var u=d.lane;if((Ps&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,a=s):c=c.next=h,we.lanes|=u,Es|=u}d=d.next}while(d!==null&&d!==i);c===null?a=s:c.next=l,Ut(s,e.memoizedState)||(at=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,we.lanes|=i,Es|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function hc(t){var e=Pt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do i=t(i,a.action),a=a.next;while(a!==r);Ut(i,e.memoizedState)||(at=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function Yg(){}function Qg(t,e){var n=we,s=Pt(),r=e(),i=!Ut(s.memoizedState,r);if(i&&(s.memoizedState=r,at=!0),s=s.queue,Pu(Jg.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Ae!==null&&Ae.memoizedState.tag&1){if(n.flags|=2048,Hi(9,Kg.bind(null,n,s,r,e),void 0,null),Re===null)throw Error(L(349));Ps&30||Gg(n,e,r)}return r}function Gg(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Kg(t,e,n,s){e.value=n,e.getSnapshot=s,Xg(e)&&Zg(t)}function Jg(t,e,n){return n(function(){Xg(e)&&Zg(t)})}function Xg(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ut(t,n)}catch{return!0}}function Zg(t){var e=xn(t,1);e!==null&&zt(e,t,1,-1)}function sf(t){var e=Qt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:t},e.queue=t,t=t.dispatch=ow.bind(null,we,t),[e.memoizedState,t]}function Hi(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function ex(){return Pt().memoizedState}function la(t,e,n,s){var r=Qt();we.flags|=t,r.memoizedState=Hi(1|e,n,void 0,s===void 0?null:s)}function hl(t,e,n,s){var r=Pt();s=s===void 0?null:s;var i=void 0;if(Pe!==null){var a=Pe.memoizedState;if(i=a.destroy,s!==null&&Su(s,a.deps)){r.memoizedState=Hi(e,n,i,s);return}}we.flags|=t,r.memoizedState=Hi(1|e,n,i,s)}function rf(t,e){return la(8390656,8,t,e)}function Pu(t,e){return hl(2048,8,t,e)}function tx(t,e){return hl(4,2,t,e)}function nx(t,e){return hl(4,4,t,e)}function sx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function rx(t,e,n){return n=n!=null?n.concat([t]):null,hl(4,4,sx.bind(null,e,t),n)}function Eu(){}function ix(t,e){var n=Pt();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Su(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function ox(t,e){var n=Pt();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Su(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function ax(t,e,n){return Ps&21?(Ut(n,e)||(n=hg(),we.lanes|=n,Es|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,at=!0),t.memoizedState=n)}function rw(t,e){var n=le;le=n!==0&&4>n?n:4,t(!0);var s=dc.transition;dc.transition={};try{t(!1),e()}finally{le=n,dc.transition=s}}function lx(){return Pt().memoizedState}function iw(t,e,n){var s=Yn(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},cx(t))dx(e,n);else if(n=Wg(t,e,n,s),n!==null){var r=Je();zt(n,t,s,r),ux(n,e,s)}}function ow(t,e,n){var s=Yn(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(cx(t))dx(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(r.hasEagerState=!0,r.eagerState=l,Ut(l,a)){var c=e.interleaved;c===null?(r.next=r,bu(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=Wg(t,e,r,s),n!==null&&(r=Je(),zt(n,t,s,r),ux(n,e,s))}}function cx(t){var e=t.alternate;return t===we||e!==null&&e===we}function dx(t,e){vi=Da=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ux(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ou(t,n)}}var Ia={readContext:Ct,useCallback:Ve,useContext:Ve,useEffect:Ve,useImperativeHandle:Ve,useInsertionEffect:Ve,useLayoutEffect:Ve,useMemo:Ve,useReducer:Ve,useRef:Ve,useState:Ve,useDebugValue:Ve,useDeferredValue:Ve,useTransition:Ve,useMutableSource:Ve,useSyncExternalStore:Ve,useId:Ve,unstable_isNewReconciler:!1},aw={readContext:Ct,useCallback:function(t,e){return Qt().memoizedState=[t,e===void 0?null:e],t},useContext:Ct,useEffect:rf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,la(4194308,4,sx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return la(4194308,4,t,e)},useInsertionEffect:function(t,e){return la(4,2,t,e)},useMemo:function(t,e){var n=Qt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Qt();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=iw.bind(null,we,t),[s.memoizedState,t]},useRef:function(t){var e=Qt();return t={current:t},e.memoizedState=t},useState:sf,useDebugValue:Eu,useDeferredValue:function(t){return Qt().memoizedState=t},useTransition:function(){var t=sf(!1),e=t[0];return t=rw.bind(null,t[1]),Qt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=we,r=Qt();if(xe){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Re===null)throw Error(L(349));Ps&30||Gg(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,rf(Jg.bind(null,s,i,t),[t]),s.flags|=2048,Hi(9,Kg.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Qt(),e=Re.identifierPrefix;if(xe){var n=fn,s=hn;n=(s&~(1<<32-$t(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Vi++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sw++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lw={readContext:Ct,useCallback:ix,useContext:Ct,useEffect:Pu,useImperativeHandle:rx,useInsertionEffect:tx,useLayoutEffect:nx,useMemo:ox,useReducer:uc,useRef:ex,useState:function(){return uc(Wi)},useDebugValue:Eu,useDeferredValue:function(t){var e=Pt();return ax(e,Pe.memoizedState,t)},useTransition:function(){var t=uc(Wi)[0],e=Pt().memoizedState;return[t,e]},useMutableSource:Yg,useSyncExternalStore:Qg,useId:lx,unstable_isNewReconciler:!1},cw={readContext:Ct,useCallback:ix,useContext:Ct,useEffect:Pu,useImperativeHandle:rx,useInsertionEffect:tx,useLayoutEffect:nx,useMemo:ox,useReducer:hc,useRef:ex,useState:function(){return hc(Wi)},useDebugValue:Eu,useDeferredValue:function(t){var e=Pt();return Pe===null?e.memoizedState=t:ax(e,Pe.memoizedState,t)},useTransition:function(){var t=hc(Wi)[0],e=Pt().memoizedState;return[t,e]},useMutableSource:Yg,useSyncExternalStore:Qg,useId:lx,unstable_isNewReconciler:!1};function Dt(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hd(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fl={isMounted:function(t){return(t=t._reactInternals)?As(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Je(),r=Yn(t),i=mn(s,r);i.payload=e,n!=null&&(i.callback=n),e=Hn(t,i,r),e!==null&&(zt(e,t,r,s),oa(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Je(),r=Yn(t),i=mn(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Hn(t,i,r),e!==null&&(zt(e,t,r,s),oa(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Je(),s=Yn(t),r=mn(n,s);r.tag=2,e!=null&&(r.callback=e),e=Hn(t,r,s),e!==null&&(zt(e,t,s,n),oa(e,t,s))}};function of(t,e,n,s,r,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,a):e.prototype&&e.prototype.isPureReactComponent?!Li(n,s)||!Li(r,i):!0}function hx(t,e,n){var s=!1,r=Xn,i=e.contextType;return typeof i=="object"&&i!==null?i=Ct(i):(r=ct(e)?ks:Qe.current,s=e.contextTypes,i=(s=s!=null)?mr(t,r):Xn),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fl,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function af(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&fl.enqueueReplaceState(e,e.state,null)}function fd(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},wu(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Ct(i):(i=ct(e)?ks:Qe.current,r.context=mr(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hd(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&fl.enqueueReplaceState(r,r.state,null),Aa(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function yr(t,e){try{var n="",s=e;do n+=Lv(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function fc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function md(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dw=typeof WeakMap=="function"?WeakMap:Map;function fx(t,e,n){n=mn(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Fa||(Fa=!0,Nd=s),md(t,e)},n}function mx(t,e,n){n=mn(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){md(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){md(t,e),typeof s!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function lf(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new dw;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=Nw.bind(null,t,e,n),e.then(t,t))}function cf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function df(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mn(-1,1),e.tag=2,Hn(n,e,1))),n.lanes|=1),t)}var uw=vn.ReactCurrentOwner,at=!1;function Ge(t,e,n,s){e.child=t===null?Vg(e,null,n,s):gr(e,t.child,n,s)}function uf(t,e,n,s,r){n=n.render;var i=e.ref;return or(e,r),s=ku(t,e,n,s,i,r),n=Cu(),t!==null&&!at?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,yn(t,e,r)):(xe&&n&&mu(e),e.flags|=1,Ge(t,e,s,r),e.child)}function hf(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Lu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,px(t,e,i,s,r)):(t=ha(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Li,n(a,s)&&t.ref===e.ref)return yn(t,e,r)}return e.flags|=1,t=Qn(i,s),t.ref=e.ref,t.return=e,e.child=t}function px(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Li(i,s)&&t.ref===e.ref)if(at=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(at=!0);else return e.lanes=t.lanes,yn(t,e,r)}return pd(t,e,n,s,r)}function gx(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(er,ht),ht|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,he(er,ht),ht|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,he(er,ht),ht|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,he(er,ht),ht|=s;return Ge(t,e,r,n),e.child}function xx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function pd(t,e,n,s,r){var i=ct(n)?ks:Qe.current;return i=mr(e,i),or(e,r),n=ku(t,e,n,s,i,r),s=Cu(),t!==null&&!at?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,yn(t,e,r)):(xe&&s&&mu(e),e.flags|=1,Ge(t,e,n,r),e.child)}function ff(t,e,n,s,r){if(ct(n)){var i=!0;Pa(e)}else i=!1;if(or(e,r),e.stateNode===null)ca(t,e),hx(e,n,s),fd(e,n,s,r),s=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ct(d):(d=ct(n)?ks:Qe.current,d=mr(e,d));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==s||c!==d)&&af(e,a,s,d),Mn=!1;var f=e.memoizedState;a.state=f,Aa(e,s,a,r),c=e.memoizedState,l!==s||f!==c||lt.current||Mn?(typeof u=="function"&&(hd(e,n,u,s),c=e.memoizedState),(l=Mn||of(e,n,l,s,f,c,d))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=d,s=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Hg(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Dt(e.type,l),a.props=d,h=e.pendingProps,f=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ct(c):(c=ct(n)?ks:Qe.current,c=mr(e,c));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||f!==c)&&af(e,a,s,c),Mn=!1,f=e.memoizedState,a.state=f,Aa(e,s,a,r);var x=e.memoizedState;l!==h||f!==x||lt.current||Mn?(typeof m=="function"&&(hd(e,n,m,s),x=e.memoizedState),(d=Mn||of(e,n,d,s,f,x,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,x,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,x,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=x),a.props=s,a.state=x,a.context=c,s=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return gd(t,e,n,s,i,r)}function gd(t,e,n,s,r,i){xx(t,e);var a=(e.flags&128)!==0;if(!s&&!a)return r&&Jh(e,n,!1),yn(t,e,i);s=e.stateNode,uw.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&a?(e.child=gr(e,t.child,null,i),e.child=gr(e,null,l,i)):Ge(t,e,l,i),e.memoizedState=s.state,r&&Jh(e,n,!0),e.child}function yx(t){var e=t.stateNode;e.pendingContext?Kh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Kh(t,e.context,!1),_u(t,e.containerInfo)}function mf(t,e,n,s,r){return pr(),gu(r),e.flags|=256,Ge(t,e,n,s),e.child}var xd={dehydrated:null,treeContext:null,retryLane:0};function yd(t){return{baseLanes:t,cachePool:null,transitions:null}}function vx(t,e,n){var s=e.pendingProps,r=be.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),he(be,r&1),t===null)return dd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,t=s.fallback,i?(s=e.mode,i=e.child,a={mode:"hidden",children:a},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gl(a,s,0,null),t=Ns(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=yd(n),e.memoizedState=xd,t):Mu(e,a));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return hw(t,e,a,s,l,r,n);if(i){i=s.fallback,a=e.mode,r=t.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Qn(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=Qn(l,i):(i=Ns(i,a,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,a=t.child.memoizedState,a=a===null?yd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=xd,s}return i=t.child,t=i.sibling,s=Qn(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Mu(t,e){return e=gl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Oo(t,e,n,s){return s!==null&&gu(s),gr(e,t.child,null,n),t=Mu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hw(t,e,n,s,r,i,a){if(n)return e.flags&256?(e.flags&=-257,s=fc(Error(L(422))),Oo(t,e,a,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=gl({mode:"visible",children:s.children},r,0,null),i=Ns(i,r,a,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&gr(e,t.child,null,a),e.child.memoizedState=yd(a),e.memoizedState=xd,i);if(!(e.mode&1))return Oo(t,e,a,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(L(419)),s=fc(i,s,void 0),Oo(t,e,a,s)}if(l=(a&t.childLanes)!==0,at||l){if(s=Re,s!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|a)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,xn(t,r),zt(s,t,r,-1))}return Iu(),s=fc(Error(L(421))),Oo(t,e,a,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Sw.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,ft=Wn(r.nextSibling),pt=e,xe=!0,Ft=null,t!==null&&(wt[_t++]=hn,wt[_t++]=fn,wt[_t++]=Cs,hn=t.id,fn=t.overflow,Cs=e),e=Mu(e,s.children),e.flags|=4096,e)}function pf(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),ud(t.return,e,n)}function mc(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function bx(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Ge(t,e,s.children,n),s=be.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pf(t,n,e);else if(t.tag===19)pf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(he(be,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Ra(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),mc(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Ra(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}mc(e,!0,n,null,i);break;case"together":mc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ca(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Es|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Qn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fw(t,e,n){switch(e.tag){case 3:yx(e),pr();break;case 5:qg(e);break;case 1:ct(e.type)&&Pa(e);break;case 4:_u(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;he(Ta,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(he(be,be.current&1),e.flags|=128,null):n&e.child.childLanes?vx(t,e,n):(he(be,be.current&1),t=yn(t,e,n),t!==null?t.sibling:null);he(be,be.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return bx(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),he(be,be.current),s)break;return null;case 22:case 23:return e.lanes=0,gx(t,e,n)}return yn(t,e,n)}var wx,vd,_x,jx;wx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vd=function(){};_x=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,vs(en.current);var i=null;switch(n){case"input":r=zc(t,r),s=zc(t,s),i=[];break;case"select":r=je({},r,{value:void 0}),s=je({},s,{value:void 0}),i=[];break;case"textarea":r=Wc(t,r),s=Wc(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=ka)}qc(n,s);var a;n=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var l=r[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Mi.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Mi.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&me("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};jx=function(t,e,n,s){n!==s&&(e.flags|=4)};function Gr(t,e){if(!xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function We(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function mw(t,e,n){var s=e.pendingProps;switch(pu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(e),null;case 1:return ct(e.type)&&Ca(),We(e),null;case 3:return s=e.stateNode,xr(),ge(lt),ge(Qe),Nu(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Mo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ft!==null&&(Cd(Ft),Ft=null))),vd(t,e),We(e),null;case 5:ju(e);var r=vs(Ui.current);if(n=e.type,t!==null&&e.stateNode!=null)_x(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(L(166));return We(e),null}if(t=vs(en.current),Mo(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Kt]=e,s[$i]=i,t=(e.mode&1)!==0,n){case"dialog":me("cancel",s),me("close",s);break;case"iframe":case"object":case"embed":me("load",s);break;case"video":case"audio":for(r=0;r<ai.length;r++)me(ai[r],s);break;case"source":me("error",s);break;case"img":case"image":case"link":me("error",s),me("load",s);break;case"details":me("toggle",s);break;case"input":jh(s,i),me("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},me("invalid",s);break;case"textarea":Sh(s,i),me("invalid",s)}qc(n,i),r=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Eo(s.textContent,l,t),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Eo(s.textContent,l,t),r=["children",""+l]):Mi.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&me("scroll",s)}switch(n){case"input":wo(s),Nh(s,i,!0);break;case"textarea":wo(s),kh(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=ka)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Jp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=a.createElement(n,{is:s.is}):(t=a.createElement(n),n==="select"&&(a=t,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):t=a.createElementNS(t,n),t[Kt]=e,t[$i]=s,wx(t,e,!1,!1),e.stateNode=t;e:{switch(a=Yc(n,s),n){case"dialog":me("cancel",t),me("close",t),r=s;break;case"iframe":case"object":case"embed":me("load",t),r=s;break;case"video":case"audio":for(r=0;r<ai.length;r++)me(ai[r],t);r=s;break;case"source":me("error",t),r=s;break;case"img":case"image":case"link":me("error",t),me("load",t),r=s;break;case"details":me("toggle",t),r=s;break;case"input":jh(t,s),r=zc(t,s),me("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=je({},s,{value:void 0}),me("invalid",t);break;case"textarea":Sh(t,s),r=Wc(t,s),me("invalid",t);break;default:r=s}qc(n,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?eg(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Xp(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ti(t,c):typeof c=="number"&&Ti(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Mi.hasOwnProperty(i)?c!=null&&i==="onScroll"&&me("scroll",t):c!=null&&eu(t,i,c,a))}switch(n){case"input":wo(t),Nh(t,s,!1);break;case"textarea":wo(t),kh(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Jn(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?nr(t,!!s.multiple,i,!1):s.defaultValue!=null&&nr(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=ka)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return We(e),null;case 6:if(t&&e.stateNode!=null)jx(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(L(166));if(n=vs(Ui.current),vs(en.current),Mo(e)){if(s=e.stateNode,n=e.memoizedProps,s[Kt]=e,(i=s.nodeValue!==n)&&(t=pt,t!==null))switch(t.tag){case 3:Eo(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Eo(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Kt]=e,e.stateNode=s}return We(e),null;case 13:if(ge(be),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xe&&ft!==null&&e.mode&1&&!(e.flags&128))zg(),pr(),e.flags|=98560,i=!1;else if(i=Mo(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(L(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(L(317));i[Kt]=e}else pr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;We(e),i=!1}else Ft!==null&&(Cd(Ft),Ft=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||be.current&1?Me===0&&(Me=3):Iu())),e.updateQueue!==null&&(e.flags|=4),We(e),null);case 4:return xr(),vd(t,e),t===null&&Fi(e.stateNode.containerInfo),We(e),null;case 10:return vu(e.type._context),We(e),null;case 17:return ct(e.type)&&Ca(),We(e),null;case 19:if(ge(be),i=e.memoizedState,i===null)return We(e),null;if(s=(e.flags&128)!==0,a=i.rendering,a===null)if(s)Gr(i,!1);else{if(Me!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ra(t),a!==null){for(e.flags|=128,Gr(i,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return he(be,be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Se()>vr&&(e.flags|=128,s=!0,Gr(i,!1),e.lanes=4194304)}else{if(!s)if(t=Ra(a),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!xe)return We(e),null}else 2*Se()-i.renderingStartTime>vr&&n!==1073741824&&(e.flags|=128,s=!0,Gr(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Se(),e.sibling=null,n=be.current,he(be,s?n&1|2:n&1),e):(We(e),null);case 22:case 23:return Du(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ht&1073741824&&(We(e),e.subtreeFlags&6&&(e.flags|=8192)):We(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function pw(t,e){switch(pu(e),e.tag){case 1:return ct(e.type)&&Ca(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xr(),ge(lt),ge(Qe),Nu(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ju(e),null;case 13:if(ge(be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));pr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ge(be),null;case 4:return xr(),null;case 10:return vu(e.type._context),null;case 22:case 23:return Du(),null;case 24:return null;default:return null}}var Ao=!1,qe=!1,gw=typeof WeakSet=="function"?WeakSet:Set,W=null;function Zs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ne(t,e,s)}else n.current=null}function bd(t,e,n){try{n()}catch(s){Ne(t,e,s)}}var gf=!1;function xw(t,e){if(sd=ja,t=Pg(),fu(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,h=t,f=null;t:for(;;){for(var m;h!==n||r!==0&&h.nodeType!==3||(l=a+r),h!==i||s!==0&&h.nodeType!==3||(c=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++d===r&&(l=a),f===i&&++u===s&&(c=a),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rd={focusedElem:t,selectionRange:n},ja=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,v=e.stateNode,p=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:Dt(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(j){Ne(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return x=gf,gf=!1,x}function bi(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&bd(e,n,i)}r=r.next}while(r!==s)}}function ml(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function wd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Nx(t){var e=t.alternate;e!==null&&(t.alternate=null,Nx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kt],delete e[$i],delete e[ad],delete e[Zb],delete e[ew])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Sx(t){return t.tag===5||t.tag===3||t.tag===4}function xf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Sx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _d(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ka));else if(s!==4&&(t=t.child,t!==null))for(_d(t,e,n),t=t.sibling;t!==null;)_d(t,e,n),t=t.sibling}function jd(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(jd(t,e,n),t=t.sibling;t!==null;)jd(t,e,n),t=t.sibling}var Le=null,It=!1;function jn(t,e,n){for(n=n.child;n!==null;)kx(t,e,n),n=n.sibling}function kx(t,e,n){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(ol,n)}catch{}switch(n.tag){case 5:qe||Zs(n,e);case 6:var s=Le,r=It;Le=null,jn(t,e,n),Le=s,It=r,Le!==null&&(It?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(It?(t=Le,n=n.stateNode,t.nodeType===8?ac(t.parentNode,n):t.nodeType===1&&ac(t,n),Di(t)):ac(Le,n.stateNode));break;case 4:s=Le,r=It,Le=n.stateNode.containerInfo,It=!0,jn(t,e,n),Le=s,It=r;break;case 0:case 11:case 14:case 15:if(!qe&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&bd(n,e,a),r=r.next}while(r!==s)}jn(t,e,n);break;case 1:if(!qe&&(Zs(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){Ne(n,e,l)}jn(t,e,n);break;case 21:jn(t,e,n);break;case 22:n.mode&1?(qe=(s=qe)||n.memoizedState!==null,jn(t,e,n),qe=s):jn(t,e,n);break;default:jn(t,e,n)}}function yf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gw),e.forEach(function(s){var r=kw.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function At(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Le=l.stateNode,It=!1;break e;case 3:Le=l.stateNode.containerInfo,It=!0;break e;case 4:Le=l.stateNode.containerInfo,It=!0;break e}l=l.return}if(Le===null)throw Error(L(160));kx(i,a,r),Le=null,It=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){Ne(r,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cx(e,t),e=e.sibling}function Cx(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(At(e,t),Ht(t),s&4){try{bi(3,t,t.return),ml(3,t)}catch(g){Ne(t,t.return,g)}try{bi(5,t,t.return)}catch(g){Ne(t,t.return,g)}}break;case 1:At(e,t),Ht(t),s&512&&n!==null&&Zs(n,n.return);break;case 5:if(At(e,t),Ht(t),s&512&&n!==null&&Zs(n,n.return),t.flags&32){var r=t.stateNode;try{Ti(r,"")}catch(g){Ne(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Gp(r,i),Yc(l,a);var d=Yc(l,i);for(a=0;a<c.length;a+=2){var u=c[a],h=c[a+1];u==="style"?eg(r,h):u==="dangerouslySetInnerHTML"?Xp(r,h):u==="children"?Ti(r,h):eu(r,u,h,d)}switch(l){case"input":Uc(r,i);break;case"textarea":Kp(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?nr(r,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?nr(r,!!i.multiple,i.defaultValue,!0):nr(r,!!i.multiple,i.multiple?[]:"",!1))}r[$i]=i}catch(g){Ne(t,t.return,g)}}break;case 6:if(At(e,t),Ht(t),s&4){if(t.stateNode===null)throw Error(L(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(g){Ne(t,t.return,g)}}break;case 3:if(At(e,t),Ht(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Di(e.containerInfo)}catch(g){Ne(t,t.return,g)}break;case 4:At(e,t),Ht(t);break;case 13:At(e,t),Ht(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Au=Se())),s&4&&yf(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(qe=(d=qe)||u,At(e,t),qe=d):At(e,t),Ht(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(W=t,u=t.child;u!==null;){for(h=W=u;W!==null;){switch(f=W,m=f.child,f.tag){case 0:case 11:case 14:case 15:bi(4,f,f.return);break;case 1:Zs(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(g){Ne(s,n,g)}}break;case 5:Zs(f,f.return);break;case 22:if(f.memoizedState!==null){bf(h);continue}}m!==null?(m.return=f,W=m):bf(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Zp("display",a))}catch(g){Ne(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Ne(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:At(e,t),Ht(t),s&4&&yf(t);break;case 21:break;default:At(e,t),Ht(t)}}function Ht(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Sx(n)){var s=n;break e}n=n.return}throw Error(L(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Ti(r,""),s.flags&=-33);var i=xf(t);jd(t,i,r);break;case 3:case 4:var a=s.stateNode.containerInfo,l=xf(t);_d(t,l,a);break;default:throw Error(L(161))}}catch(c){Ne(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yw(t,e,n){W=t,Px(t)}function Px(t,e,n){for(var s=(t.mode&1)!==0;W!==null;){var r=W,i=r.child;if(r.tag===22&&s){var a=r.memoizedState!==null||Ao;if(!a){var l=r.alternate,c=l!==null&&l.memoizedState!==null||qe;l=Ao;var d=qe;if(Ao=a,(qe=c)&&!d)for(W=r;W!==null;)a=W,c=a.child,a.tag===22&&a.memoizedState!==null?wf(r):c!==null?(c.return=a,W=c):wf(r);for(;i!==null;)W=i,Px(i),i=i.sibling;W=r,Ao=l,qe=d}vf(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,W=i):vf(t)}}function vf(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qe||ml(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!qe)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Dt(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&nf(e,i,s);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}nf(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Di(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}qe||e.flags&512&&wd(e)}catch(f){Ne(e,e.return,f)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function bf(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function wf(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ml(4,e)}catch(c){Ne(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){Ne(e,r,c)}}var i=e.return;try{wd(e)}catch(c){Ne(e,i,c)}break;case 5:var a=e.return;try{wd(e)}catch(c){Ne(e,a,c)}}}catch(c){Ne(e,e.return,c)}if(e===t){W=null;break}var l=e.sibling;if(l!==null){l.return=e.return,W=l;break}W=e.return}}var vw=Math.ceil,La=vn.ReactCurrentDispatcher,Tu=vn.ReactCurrentOwner,St=vn.ReactCurrentBatchConfig,re=0,Re=null,Ce=null,Fe=0,ht=0,er=ns(0),Me=0,qi=null,Es=0,pl=0,Ou=0,wi=null,rt=null,Au=0,vr=1/0,cn=null,Fa=!1,Nd=null,qn=null,Ro=!1,In=null,Ba=0,_i=0,Sd=null,da=-1,ua=0;function Je(){return re&6?Se():da!==-1?da:da=Se()}function Yn(t){return t.mode&1?re&2&&Fe!==0?Fe&-Fe:nw.transition!==null?(ua===0&&(ua=hg()),ua):(t=le,t!==0||(t=window.event,t=t===void 0?16:vg(t.type)),t):1}function zt(t,e,n,s){if(50<_i)throw _i=0,Sd=null,Error(L(185));ao(t,n,s),(!(re&2)||t!==Re)&&(t===Re&&(!(re&2)&&(pl|=n),Me===4&&An(t,Fe)),dt(t,s),n===1&&re===0&&!(e.mode&1)&&(vr=Se()+500,ul&&ss()))}function dt(t,e){var n=t.callbackNode;nb(t,e);var s=_a(t,t===Re?Fe:0);if(s===0)n!==null&&Eh(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&Eh(n),e===1)t.tag===0?tw(_f.bind(null,t)):Fg(_f.bind(null,t)),Jb(function(){!(re&6)&&ss()}),n=null;else{switch(fg(s)){case 1:n=iu;break;case 4:n=dg;break;case 16:n=wa;break;case 536870912:n=ug;break;default:n=wa}n=Ix(n,Ex.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ex(t,e){if(da=-1,ua=0,re&6)throw Error(L(327));var n=t.callbackNode;if(ar()&&t.callbackNode!==n)return null;var s=_a(t,t===Re?Fe:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=$a(t,s);else{e=s;var r=re;re|=2;var i=Tx();(Re!==t||Fe!==e)&&(cn=null,vr=Se()+500,js(t,e));do try{_w();break}catch(l){Mx(t,l)}while(!0);yu(),La.current=i,re=r,Ce!==null?e=0:(Re=null,Fe=0,e=Me)}if(e!==0){if(e===2&&(r=Xc(t),r!==0&&(s=r,e=kd(t,r))),e===1)throw n=qi,js(t,0),An(t,s),dt(t,Se()),n;if(e===6)An(t,s);else{if(r=t.current.alternate,!(s&30)&&!bw(r)&&(e=$a(t,s),e===2&&(i=Xc(t),i!==0&&(s=i,e=kd(t,i))),e===1))throw n=qi,js(t,0),An(t,s),dt(t,Se()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(L(345));case 2:us(t,rt,cn);break;case 3:if(An(t,s),(s&130023424)===s&&(e=Au+500-Se(),10<e)){if(_a(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Je(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=od(us.bind(null,t,rt,cn),e);break}us(t,rt,cn);break;case 4:if(An(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var a=31-$t(s);i=1<<a,a=e[a],a>r&&(r=a),s&=~i}if(s=r,s=Se()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*vw(s/1960))-s,10<s){t.timeoutHandle=od(us.bind(null,t,rt,cn),s);break}us(t,rt,cn);break;case 5:us(t,rt,cn);break;default:throw Error(L(329))}}}return dt(t,Se()),t.callbackNode===n?Ex.bind(null,t):null}function kd(t,e){var n=wi;return t.current.memoizedState.isDehydrated&&(js(t,e).flags|=256),t=$a(t,e),t!==2&&(e=rt,rt=n,e!==null&&Cd(e)),t}function Cd(t){rt===null?rt=t:rt.push.apply(rt,t)}function bw(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Ut(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function An(t,e){for(e&=~Ou,e&=~pl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$t(e),s=1<<n;t[n]=-1,e&=~s}}function _f(t){if(re&6)throw Error(L(327));ar();var e=_a(t,0);if(!(e&1))return dt(t,Se()),null;var n=$a(t,e);if(t.tag!==0&&n===2){var s=Xc(t);s!==0&&(e=s,n=kd(t,s))}if(n===1)throw n=qi,js(t,0),An(t,e),dt(t,Se()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,us(t,rt,cn),dt(t,Se()),null}function Ru(t,e){var n=re;re|=1;try{return t(e)}finally{re=n,re===0&&(vr=Se()+500,ul&&ss())}}function Ms(t){In!==null&&In.tag===0&&!(re&6)&&ar();var e=re;re|=1;var n=St.transition,s=le;try{if(St.transition=null,le=1,t)return t()}finally{le=s,St.transition=n,re=e,!(re&6)&&ss()}}function Du(){ht=er.current,ge(er)}function js(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Kb(n)),Ce!==null)for(n=Ce.return;n!==null;){var s=n;switch(pu(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ca();break;case 3:xr(),ge(lt),ge(Qe),Nu();break;case 5:ju(s);break;case 4:xr();break;case 13:ge(be);break;case 19:ge(be);break;case 10:vu(s.type._context);break;case 22:case 23:Du()}n=n.return}if(Re=t,Ce=t=Qn(t.current,null),Fe=ht=e,Me=0,qi=null,Ou=pl=Es=0,rt=wi=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var a=i.next;i.next=r,s.next=a}n.pending=s}ys=null}return t}function Mx(t,e){do{var n=Ce;try{if(yu(),aa.current=Ia,Da){for(var s=we.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Da=!1}if(Ps=0,Ae=Pe=we=null,vi=!1,Vi=0,Tu.current=null,n===null||n.return===null){Me=1,qi=e,Ce=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=Fe,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=cf(a);if(m!==null){m.flags&=-257,df(m,a,l,i,e),m.mode&1&&lf(i,d,e),e=m,c=d;var x=e.updateQueue;if(x===null){var g=new Set;g.add(c),e.updateQueue=g}else x.add(c);break e}else{if(!(e&1)){lf(i,d,e),Iu();break e}c=Error(L(426))}}else if(xe&&l.mode&1){var y=cf(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),df(y,a,l,i,e),gu(yr(c,l));break e}}i=c=yr(c,l),Me!==4&&(Me=2),wi===null?wi=[i]:wi.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=fx(i,c,e);tf(i,v);break e;case 1:l=c;var p=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qn===null||!qn.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=mx(i,l,e);tf(i,j);break e}}i=i.return}while(i!==null)}Ax(n)}catch(_){e=_,Ce===n&&n!==null&&(Ce=n=n.return);continue}break}while(!0)}function Tx(){var t=La.current;return La.current=Ia,t===null?Ia:t}function Iu(){(Me===0||Me===3||Me===2)&&(Me=4),Re===null||!(Es&268435455)&&!(pl&268435455)||An(Re,Fe)}function $a(t,e){var n=re;re|=2;var s=Tx();(Re!==t||Fe!==e)&&(cn=null,js(t,e));do try{ww();break}catch(r){Mx(t,r)}while(!0);if(yu(),re=n,La.current=s,Ce!==null)throw Error(L(261));return Re=null,Fe=0,Me}function ww(){for(;Ce!==null;)Ox(Ce)}function _w(){for(;Ce!==null&&!Yv();)Ox(Ce)}function Ox(t){var e=Dx(t.alternate,t,ht);t.memoizedProps=t.pendingProps,e===null?Ax(t):Ce=e,Tu.current=null}function Ax(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pw(n,e),n!==null){n.flags&=32767,Ce=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Me=6,Ce=null;return}}else if(n=mw(n,e,ht),n!==null){Ce=n;return}if(e=e.sibling,e!==null){Ce=e;return}Ce=e=t}while(e!==null);Me===0&&(Me=5)}function us(t,e,n){var s=le,r=St.transition;try{St.transition=null,le=1,jw(t,e,n,s)}finally{St.transition=r,le=s}return null}function jw(t,e,n,s){do ar();while(In!==null);if(re&6)throw Error(L(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(sb(t,i),t===Re&&(Ce=Re=null,Fe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ro||(Ro=!0,Ix(wa,function(){return ar(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=St.transition,St.transition=null;var a=le;le=1;var l=re;re|=4,Tu.current=null,xw(t,n),Cx(n,t),Vb(rd),ja=!!sd,rd=sd=null,t.current=n,yw(n),Qv(),re=l,le=a,St.transition=i}else t.current=n;if(Ro&&(Ro=!1,In=t,Ba=r),i=t.pendingLanes,i===0&&(qn=null),Jv(n.stateNode),dt(t,Se()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Fa)throw Fa=!1,t=Nd,Nd=null,t;return Ba&1&&t.tag!==0&&ar(),i=t.pendingLanes,i&1?t===Sd?_i++:(_i=0,Sd=t):_i=0,ss(),null}function ar(){if(In!==null){var t=fg(Ba),e=St.transition,n=le;try{if(St.transition=null,le=16>t?16:t,In===null)var s=!1;else{if(t=In,In=null,Ba=0,re&6)throw Error(L(331));var r=re;for(re|=4,W=t.current;W!==null;){var i=W,a=i.child;if(W.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(W=d;W!==null;){var u=W;switch(u.tag){case 0:case 11:case 15:bi(8,u,i)}var h=u.child;if(h!==null)h.return=u,W=h;else for(;W!==null;){u=W;var f=u.sibling,m=u.return;if(Nx(u),u===d){W=null;break}if(f!==null){f.return=m,W=f;break}W=m}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}W=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,W=a;else e:for(;W!==null;){if(i=W,i.flags&2048)switch(i.tag){case 0:case 11:case 15:bi(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,W=v;break e}W=i.return}}var p=t.current;for(W=p;W!==null;){a=W;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,W=b;else e:for(a=p;W!==null;){if(l=W,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ml(9,l)}}catch(_){Ne(l,l.return,_)}if(l===a){W=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,W=j;break e}W=l.return}}if(re=r,ss(),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(ol,t)}catch{}s=!0}return s}finally{le=n,St.transition=e}}return!1}function jf(t,e,n){e=yr(n,e),e=fx(t,e,1),t=Hn(t,e,1),e=Je(),t!==null&&(ao(t,1,e),dt(t,e))}function Ne(t,e,n){if(t.tag===3)jf(t,t,n);else for(;e!==null;){if(e.tag===3){jf(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(qn===null||!qn.has(s))){t=yr(n,t),t=mx(e,t,1),e=Hn(e,t,1),t=Je(),e!==null&&(ao(e,1,t),dt(e,t));break}}e=e.return}}function Nw(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Je(),t.pingedLanes|=t.suspendedLanes&n,Re===t&&(Fe&n)===n&&(Me===4||Me===3&&(Fe&130023424)===Fe&&500>Se()-Au?js(t,0):Ou|=n),dt(t,e)}function Rx(t,e){e===0&&(t.mode&1?(e=No,No<<=1,!(No&130023424)&&(No=4194304)):e=1);var n=Je();t=xn(t,e),t!==null&&(ao(t,e,n),dt(t,n))}function Sw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Rx(t,n)}function kw(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(L(314))}s!==null&&s.delete(e),Rx(t,n)}var Dx;Dx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||lt.current)at=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return at=!1,fw(t,e,n);at=!!(t.flags&131072)}else at=!1,xe&&e.flags&1048576&&Bg(e,Ma,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;ca(t,e),t=e.pendingProps;var r=mr(e,Qe.current);or(e,n),r=ku(null,e,s,t,r,n);var i=Cu();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ct(s)?(i=!0,Pa(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,wu(e),r.updater=fl,e.stateNode=r,r._reactInternals=e,fd(e,s,t,n),e=gd(null,e,s,!0,i,n)):(e.tag=0,xe&&i&&mu(e),Ge(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(ca(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=Pw(s),t=Dt(s,t),r){case 0:e=pd(null,e,s,t,n);break e;case 1:e=ff(null,e,s,t,n);break e;case 11:e=uf(null,e,s,t,n);break e;case 14:e=hf(null,e,s,Dt(s.type,t),n);break e}throw Error(L(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Dt(s,r),pd(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Dt(s,r),ff(t,e,s,r,n);case 3:e:{if(yx(e),t===null)throw Error(L(387));s=e.pendingProps,i=e.memoizedState,r=i.element,Hg(t,e),Aa(e,s,null,n);var a=e.memoizedState;if(s=a.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=yr(Error(L(423)),e),e=mf(t,e,s,n,r);break e}else if(s!==r){r=yr(Error(L(424)),e),e=mf(t,e,s,n,r);break e}else for(ft=Wn(e.stateNode.containerInfo.firstChild),pt=e,xe=!0,Ft=null,n=Vg(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(pr(),s===r){e=yn(t,e,n);break e}Ge(t,e,s,n)}e=e.child}return e;case 5:return qg(e),t===null&&dd(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,a=r.children,id(s,r)?a=null:i!==null&&id(s,i)&&(e.flags|=32),xx(t,e),Ge(t,e,a,n),e.child;case 6:return t===null&&dd(e),null;case 13:return vx(t,e,n);case 4:return _u(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=gr(e,null,s,n):Ge(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Dt(s,r),uf(t,e,s,r,n);case 7:return Ge(t,e,e.pendingProps,n),e.child;case 8:return Ge(t,e,e.pendingProps.children,n),e.child;case 12:return Ge(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,a=r.value,he(Ta,s._currentValue),s._currentValue=a,i!==null)if(Ut(i.value,a)){if(i.children===r.children&&!lt.current){e=yn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=mn(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ud(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(L(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),ud(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Ge(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,or(e,n),r=Ct(r),s=s(r),e.flags|=1,Ge(t,e,s,n),e.child;case 14:return s=e.type,r=Dt(s,e.pendingProps),r=Dt(s.type,r),hf(t,e,s,r,n);case 15:return px(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Dt(s,r),ca(t,e),e.tag=1,ct(s)?(t=!0,Pa(e)):t=!1,or(e,n),hx(e,s,r),fd(e,s,r,n),gd(null,e,s,!0,t,n);case 19:return bx(t,e,n);case 22:return gx(t,e,n)}throw Error(L(156,e.tag))};function Ix(t,e){return cg(t,e)}function Cw(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(t,e,n,s){return new Cw(t,e,n,s)}function Lu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pw(t){if(typeof t=="function")return Lu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nu)return 11;if(t===su)return 14}return 2}function Qn(t,e){var n=t.alternate;return n===null?(n=jt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ha(t,e,n,s,r,i){var a=2;if(s=t,typeof t=="function")Lu(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ws:return Ns(n.children,r,i,e);case tu:a=8,r|=8;break;case Lc:return t=jt(12,n,e,r|2),t.elementType=Lc,t.lanes=i,t;case Fc:return t=jt(13,n,e,r),t.elementType=Fc,t.lanes=i,t;case Bc:return t=jt(19,n,e,r),t.elementType=Bc,t.lanes=i,t;case qp:return gl(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Wp:a=10;break e;case Hp:a=9;break e;case nu:a=11;break e;case su:a=14;break e;case En:a=16,s=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=jt(a,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Ns(t,e,n,s){return t=jt(7,t,s,e),t.lanes=n,t}function gl(t,e,n,s){return t=jt(22,t,s,e),t.elementType=qp,t.lanes=n,t.stateNode={isHidden:!1},t}function pc(t,e,n){return t=jt(6,t,null,e),t.lanes=n,t}function gc(t,e,n){return e=jt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ew(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kl(0),this.expirationTimes=Kl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kl(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fu(t,e,n,s,r,i,a,l,c){return t=new Ew(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=jt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wu(i),t}function Mw(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vs,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function Lx(t){if(!t)return Xn;t=t._reactInternals;e:{if(As(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ct(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(ct(n))return Lg(t,n,e)}return e}function Fx(t,e,n,s,r,i,a,l,c){return t=Fu(n,s,!0,t,r,i,a,l,c),t.context=Lx(null),n=t.current,s=Je(),r=Yn(n),i=mn(s,r),i.callback=e??null,Hn(n,i,r),t.current.lanes=r,ao(t,r,s),dt(t,s),t}function xl(t,e,n,s){var r=e.current,i=Je(),a=Yn(r);return n=Lx(n),e.context===null?e.context=n:e.pendingContext=n,e=mn(i,a),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Hn(r,e,a),t!==null&&(zt(t,r,a,i),oa(t,r,a)),a}function za(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Nf(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Bu(t,e){Nf(t,e),(t=t.alternate)&&Nf(t,e)}function Tw(){return null}var Bx=typeof reportError=="function"?reportError:function(t){console.error(t)};function $u(t){this._internalRoot=t}yl.prototype.render=$u.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));xl(t,e,null,null)};yl.prototype.unmount=$u.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ms(function(){xl(null,t,null,null)}),e[gn]=null}};function yl(t){this._internalRoot=t}yl.prototype.unstable_scheduleHydration=function(t){if(t){var e=gg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<On.length&&e!==0&&e<On[n].priority;n++);On.splice(n,0,t),n===0&&yg(t)}};function zu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Sf(){}function Ow(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var d=za(a);i.call(d)}}var a=Fx(e,s,t,0,null,!1,!1,"",Sf);return t._reactRootContainer=a,t[gn]=a.current,Fi(t.nodeType===8?t.parentNode:t),Ms(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var d=za(c);l.call(d)}}var c=Fu(t,0,!1,null,null,!1,!1,"",Sf);return t._reactRootContainer=c,t[gn]=c.current,Fi(t.nodeType===8?t.parentNode:t),Ms(function(){xl(e,c,n,s)}),c}function bl(t,e,n,s,r){var i=n._reactRootContainer;if(i){var a=i;if(typeof r=="function"){var l=r;r=function(){var c=za(a);l.call(c)}}xl(e,a,t,r)}else a=Ow(n,e,t,r,s);return za(a)}mg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=oi(e.pendingLanes);n!==0&&(ou(e,n|1),dt(e,Se()),!(re&6)&&(vr=Se()+500,ss()))}break;case 13:Ms(function(){var s=xn(t,1);if(s!==null){var r=Je();zt(s,t,1,r)}}),Bu(t,1)}};au=function(t){if(t.tag===13){var e=xn(t,134217728);if(e!==null){var n=Je();zt(e,t,134217728,n)}Bu(t,134217728)}};pg=function(t){if(t.tag===13){var e=Yn(t),n=xn(t,e);if(n!==null){var s=Je();zt(n,t,e,s)}Bu(t,e)}};gg=function(){return le};xg=function(t,e){var n=le;try{return le=t,e()}finally{le=n}};Gc=function(t,e,n){switch(e){case"input":if(Uc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=dl(s);if(!r)throw Error(L(90));Qp(s),Uc(s,r)}}}break;case"textarea":Kp(t,n);break;case"select":e=n.value,e!=null&&nr(t,!!n.multiple,e,!1)}};sg=Ru;rg=Ms;var Aw={usingClientEntryPoint:!1,Events:[co,Qs,dl,tg,ng,Ru]},Kr={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rw={bundleType:Kr.bundleType,version:Kr.version,rendererPackageName:Kr.rendererPackageName,rendererConfig:Kr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ag(t),t===null?null:t.stateNode},findFiberByHostInstance:Kr.findFiberByHostInstance||Tw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Do=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Do.isDisabled&&Do.supportsFiber)try{ol=Do.inject(Rw),Zt=Do}catch{}}yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Aw;yt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zu(e))throw Error(L(200));return Mw(t,e,null,n)};yt.createRoot=function(t,e){if(!zu(t))throw Error(L(299));var n=!1,s="",r=Bx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Fu(t,1,!1,null,null,n,!1,s,r),t[gn]=e.current,Fi(t.nodeType===8?t.parentNode:t),new $u(e)};yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=ag(e),t=t===null?null:t.stateNode,t};yt.flushSync=function(t){return Ms(t)};yt.hydrate=function(t,e,n){if(!vl(e))throw Error(L(200));return bl(null,t,e,!0,n)};yt.hydrateRoot=function(t,e,n){if(!zu(t))throw Error(L(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",a=Bx;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Fx(e,null,t,1,n??null,r,!1,i,a),t[gn]=e.current,Fi(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new yl(e)};yt.render=function(t,e,n){if(!vl(e))throw Error(L(200));return bl(null,t,e,!1,n)};yt.unmountComponentAtNode=function(t){if(!vl(t))throw Error(L(40));return t._reactRootContainer?(Ms(function(){bl(null,null,t,!1,function(){t._reactRootContainer=null,t[gn]=null})}),!0):!1};yt.unstable_batchedUpdates=Ru;yt.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!vl(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return bl(t,e,n,!1,s)};yt.version="18.3.1-next-f1338f8080-20240426";function $x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($x)}catch(t){console.error(t)}}$x(),$p.exports=yt;var Dw=$p.exports,zx,kf=Dw;zx=kf.createRoot,kf.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yi(){return Yi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Yi.apply(this,arguments)}var Ln;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ln||(Ln={}));const Cf="popstate";function Iw(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:a,hash:l}=s.location;return Pd("",{pathname:i,search:a,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Ua(r)}return Fw(e,n,null,t)}function _e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ux(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Lw(){return Math.random().toString(36).substr(2,8)}function Pf(t,e){return{usr:t.state,key:t.key,idx:e}}function Pd(t,e,n,s){return n===void 0&&(n=null),Yi({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ar(e):e,{state:n,key:e&&e.key||s||Lw()})}function Ua(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Ar(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function Fw(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,l=Ln.Pop,c=null,d=u();d==null&&(d=0,a.replaceState(Yi({},a.state,{idx:d}),""));function u(){return(a.state||{idx:null}).idx}function h(){l=Ln.Pop;let y=u(),v=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:v})}function f(y,v){l=Ln.Push;let p=Pd(g.location,y,v);d=u()+1;let b=Pf(p,d),j=g.createHref(p);try{a.pushState(b,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;r.location.assign(j)}i&&c&&c({action:l,location:g.location,delta:1})}function m(y,v){l=Ln.Replace;let p=Pd(g.location,y,v);d=u();let b=Pf(p,d),j=g.createHref(p);a.replaceState(b,"",j),i&&c&&c({action:l,location:g.location,delta:0})}function x(y){let v=r.location.origin!=="null"?r.location.origin:r.location.href,p=typeof y=="string"?y:Ua(y);return p=p.replace(/ $/,"%20"),_e(v,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,v)}let g={get action(){return l},get location(){return t(r,a)},listen(y){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(Cf,h),c=y,()=>{r.removeEventListener(Cf,h),c=null}},createHref(y){return e(r,y)},createURL:x,encodeLocation(y){let v=x(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(y){return a.go(y)}};return g}var Ef;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ef||(Ef={}));function Bw(t,e,n){return n===void 0&&(n="/"),$w(t,e,n,!1)}function $w(t,e,n,s){let r=typeof e=="string"?Ar(e):e,i=br(r.pathname||"/",n);if(i==null)return null;let a=Vx(t);zw(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let d=Xw(i);l=Kw(a[c],d,s)}return l}function Vx(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(_e(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=Gn([s,c.relativePath]),u=n.concat(c);i.children&&i.children.length>0&&(_e(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Vx(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Qw(d,i.index),routesMeta:u})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))r(i,a);else for(let c of Wx(i.path))r(i,a,c)}),e}function Wx(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let a=Wx(s.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function zw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Gw(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Uw=/^:[\w-]+$/,Vw=3,Ww=2,Hw=1,qw=10,Yw=-2,Mf=t=>t==="*";function Qw(t,e){let n=t.split("/"),s=n.length;return n.some(Mf)&&(s+=Yw),e&&(s+=Ww),n.filter(r=>!Mf(r)).reduce((r,i)=>r+(Uw.test(i)?Vw:i===""?Hw:qw),s)}function Gw(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function Kw(t,e,n){let{routesMeta:s}=t,r={},i="/",a=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=Va({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h&&d&&n&&!s[s.length-1].route.index&&(h=Va({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(r,h.params),a.push({params:r,pathname:Gn([i,h.pathname]),pathnameBase:n_(Gn([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Gn([i,h.pathnameBase]))}return a}function Va(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=Jw(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((d,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let g=l[h]||"";a=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const x=l[h];return m&&!x?d[f]=void 0:d[f]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:t}}function Jw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Ux(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function Xw(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ux(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function br(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function Zw(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Ar(t):t;return{pathname:n?n.startsWith("/")?n:e_(n,e):e,search:s_(s),hash:r_(r)}}function e_(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function xc(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function t_(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Uu(t,e){let n=t_(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Vu(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Ar(t):(r=Yi({},t),_e(!r.pathname||!r.pathname.includes("?"),xc("?","pathname","search",r)),_e(!r.pathname||!r.pathname.includes("#"),xc("#","pathname","hash",r)),_e(!r.search||!r.search.includes("#"),xc("#","search","hash",r)));let i=t===""||r.pathname==="",a=i?"/":r.pathname,l;if(a==null)l=n;else{let h=e.length-1;if(!s&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=Zw(r,l),d=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Gn=t=>t.join("/").replace(/\/\/+/g,"/"),n_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),s_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,r_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function i_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Hx=["post","put","patch","delete"];new Set(Hx);const o_=["get",...Hx];new Set(o_);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qi(){return Qi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Qi.apply(this,arguments)}const wl=w.createContext(null),qx=w.createContext(null),bn=w.createContext(null),_l=w.createContext(null),wn=w.createContext({outlet:null,matches:[],isDataRoute:!1}),Yx=w.createContext(null);function a_(t,e){let{relative:n}=e===void 0?{}:e;Rr()||_e(!1);let{basename:s,navigator:r}=w.useContext(bn),{hash:i,pathname:a,search:l}=Nl(t,{relative:n}),c=a;return s!=="/"&&(c=a==="/"?s:Gn([s,a])),r.createHref({pathname:c,search:l,hash:i})}function Rr(){return w.useContext(_l)!=null}function rs(){return Rr()||_e(!1),w.useContext(_l).location}function Qx(t){w.useContext(bn).static||w.useLayoutEffect(t)}function jl(){let{isDataRoute:t}=w.useContext(wn);return t?__():l_()}function l_(){Rr()||_e(!1);let t=w.useContext(wl),{basename:e,future:n,navigator:s}=w.useContext(bn),{matches:r}=w.useContext(wn),{pathname:i}=rs(),a=JSON.stringify(Uu(r,n.v7_relativeSplatPath)),l=w.useRef(!1);return Qx(()=>{l.current=!0}),w.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let h=Vu(d,JSON.parse(a),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Gn([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,a,i,t])}const c_=w.createContext(null);function d_(t){let e=w.useContext(wn).outlet;return e&&w.createElement(c_.Provider,{value:t},e)}function Nl(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=w.useContext(bn),{matches:r}=w.useContext(wn),{pathname:i}=rs(),a=JSON.stringify(Uu(r,s.v7_relativeSplatPath));return w.useMemo(()=>Vu(t,JSON.parse(a),i,n==="path"),[t,a,i,n])}function u_(t,e){return h_(t,e)}function h_(t,e,n,s){Rr()||_e(!1);let{navigator:r}=w.useContext(bn),{matches:i}=w.useContext(wn),a=i[i.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let d=rs(),u;if(e){var h;let y=typeof e=="string"?Ar(e):e;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||_e(!1),u=y}else u=d;let f=u.pathname||"/",m=f;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=Bw(t,{pathname:m}),g=x_(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Gn([c,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Gn([c,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,s);return e&&g?w.createElement(_l.Provider,{value:{location:Qi({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ln.Pop}},g):g}function f_(){let t=w_(),e=i_(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),n?w.createElement("pre",{style:r},n):null,null)}const m_=w.createElement(f_,null);class p_ extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(wn.Provider,{value:this.props.routeContext},w.createElement(Yx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function g_(t){let{routeContext:e,match:n,children:s}=t,r=w.useContext(wl);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(wn.Provider,{value:e},s)}function x_(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,l=(r=n)==null?void 0:r.errors;if(l!=null){let u=a.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||_e(!1),a=a.slice(0,Math.min(a.length,u+1))}let c=!1,d=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:m}=n,x=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||x){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((u,h,f)=>{let m,x=!1,g=null,y=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,g=h.route.errorElement||m_,c&&(d<0&&f===0?(x=!0,y=null):d===f&&(x=!0,y=h.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),p=()=>{let b;return m?b=g:x?b=y:h.route.Component?b=w.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,w.createElement(g_,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?w.createElement(p_,{location:n.location,revalidation:n.revalidation,component:g,error:m,children:p(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):p()},null)}var Gx=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Gx||{}),Wa=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Wa||{});function y_(t){let e=w.useContext(wl);return e||_e(!1),e}function v_(t){let e=w.useContext(qx);return e||_e(!1),e}function b_(t){let e=w.useContext(wn);return e||_e(!1),e}function Kx(t){let e=b_(),n=e.matches[e.matches.length-1];return n.route.id||_e(!1),n.route.id}function w_(){var t;let e=w.useContext(Yx),n=v_(Wa.UseRouteError),s=Kx(Wa.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function __(){let{router:t}=y_(Gx.UseNavigateStable),e=Kx(Wa.UseNavigateStable),n=w.useRef(!1);return Qx(()=>{n.current=!0}),w.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Qi({fromRouteId:e},i)))},[t,e])}const Tf={};function j_(t,e){Tf[e]||(Tf[e]=!0,console.warn(e))}const Of=(t,e,n)=>j_(t,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function N_(t,e){t!=null&&t.v7_startTransition||Of("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&Of("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Ha(t){let{to:e,replace:n,state:s,relative:r}=t;Rr()||_e(!1);let{future:i,static:a}=w.useContext(bn),{matches:l}=w.useContext(wn),{pathname:c}=rs(),d=jl(),u=Vu(e,Uu(l,i.v7_relativeSplatPath),c,r==="path"),h=JSON.stringify(u);return w.useEffect(()=>d(JSON.parse(h),{replace:n,state:s,relative:r}),[d,h,r,n,s]),null}function S_(t){return d_(t.context)}function de(t){_e(!1)}function k_(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Ln.Pop,navigator:i,static:a=!1,future:l}=t;Rr()&&_e(!1);let c=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:c,navigator:i,static:a,future:Qi({v7_relativeSplatPath:!1},l)}),[c,l,i,a]);typeof s=="string"&&(s=Ar(s));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:x="default"}=s,g=w.useMemo(()=>{let y=br(u,c);return y==null?null:{location:{pathname:y,search:h,hash:f,state:m,key:x},navigationType:r}},[c,u,h,f,m,x,r]);return g==null?null:w.createElement(bn.Provider,{value:d},w.createElement(_l.Provider,{children:n,value:g}))}function C_(t){let{children:e,location:n}=t;return u_(Ed(e),n)}new Promise(()=>{});function Ed(t,e){e===void 0&&(e=[]);let n=[];return w.Children.forEach(t,(s,r)=>{if(!w.isValidElement(s))return;let i=[...e,r];if(s.type===w.Fragment){n.push.apply(n,Ed(s.props.children,i));return}s.type!==de&&_e(!1),!s.props.index||!s.props.children||_e(!1);let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Ed(s.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qa(){return qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},qa.apply(this,arguments)}function Jx(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function P_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function E_(t,e){return t.button===0&&(!e||e==="_self")&&!P_(t)}const M_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],T_=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],O_="6";try{window.__reactRouterVersion=O_}catch{}const A_=w.createContext({isTransitioning:!1}),R_="startTransition",Af=Nv[R_];function D_(t){let{basename:e,children:n,future:s,window:r}=t,i=w.useRef();i.current==null&&(i.current=Iw({window:r,v5Compat:!0}));let a=i.current,[l,c]=w.useState({action:a.action,location:a.location}),{v7_startTransition:d}=s||{},u=w.useCallback(h=>{d&&Af?Af(()=>c(h)):c(h)},[c,d]);return w.useLayoutEffect(()=>a.listen(u),[a,u]),w.useEffect(()=>N_(s),[s]),w.createElement(k_,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a,future:s})}const I_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,F_=w.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:a,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h}=e,f=Jx(e,M_),{basename:m}=w.useContext(bn),x,g=!1;if(typeof d=="string"&&L_.test(d)&&(x=d,I_))try{let b=new URL(window.location.href),j=d.startsWith("//")?new URL(b.protocol+d):new URL(d),_=br(j.pathname,m);j.origin===b.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let y=a_(d,{relative:r}),v=z_(d,{replace:a,state:l,target:c,preventScrollReset:u,relative:r,viewTransition:h});function p(b){s&&s(b),b.defaultPrevented||v(b)}return w.createElement("a",qa({},f,{href:x||y,onClick:g||i?s:p,ref:n,target:c}))}),B_=w.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:d,children:u}=e,h=Jx(e,T_),f=Nl(c,{relative:h.relative}),m=rs(),x=w.useContext(qx),{navigator:g,basename:y}=w.useContext(bn),v=x!=null&&U_(f)&&d===!0,p=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,b=m.pathname,j=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;r||(b=b.toLowerCase(),j=j?j.toLowerCase():null,p=p.toLowerCase()),j&&y&&(j=br(j,y)||j);const _=p!=="/"&&p.endsWith("/")?p.length-1:p.length;let C=b===p||!a&&b.startsWith(p)&&b.charAt(_)==="/",S=j!=null&&(j===p||!a&&j.startsWith(p)&&j.charAt(p.length)==="/"),k={isActive:C,isPending:S,isTransitioning:v},A=C?s:void 0,P;typeof i=="function"?P=i(k):P=[i,C?"active":null,S?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(k):l;return w.createElement(F_,qa({},h,{"aria-current":A,className:P,ref:n,style:D,to:c,viewTransition:d}),typeof u=="function"?u(k):u)});var Md;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Md||(Md={}));var Rf;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Rf||(Rf={}));function $_(t){let e=w.useContext(wl);return e||_e(!1),e}function z_(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:a,viewTransition:l}=e===void 0?{}:e,c=jl(),d=rs(),u=Nl(t,{relative:a});return w.useCallback(h=>{if(E_(h,n)){h.preventDefault();let f=s!==void 0?s:Ua(d)===Ua(u);c(t,{replace:f,state:r,preventScrollReset:i,relative:a,viewTransition:l})}},[d,c,u,s,r,n,t,i,a,l])}function U_(t,e){e===void 0&&(e={});let n=w.useContext(A_);n==null&&_e(!1);let{basename:s}=$_(Md.useViewTransitionState),r=Nl(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=br(n.currentLocation.pathname,s)||n.currentLocation.pathname,a=br(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Va(r.pathname,a)!=null||Va(r.pathname,i)!=null}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var V_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),H=(t,e)=>{const n=w.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:c,...d},u)=>w.createElement("svg",{ref:u,...V_,width:r,height:r,stroke:s,strokeWidth:a?Number(i)*24/Number(r):i,className:["lucide",`lucide-${W_(t)}`,l].join(" "),...d},[...e.map(([h,f])=>w.createElement(h,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=H("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=H("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=H("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=H("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=H("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=H("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=H("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=H("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=H("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=H("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=H("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=H("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=H("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=H("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=H("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=H("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=H("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=H("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=H("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=H("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=H("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=H("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=H("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=H("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=H("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=H("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=H("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=H("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=H("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=H("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=H("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=H("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=H("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=H("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=H("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=H("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=H("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=H("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=H("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=H("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=H("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=H("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=H("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=H("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=H("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=H("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=H("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=H("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p1=H("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g1=H("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=H("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),x1={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUwNDQ2OTEsImV4cCI6MjA1MDYyMDY5MX0.BkDQ9YLN1j-6NsTGS0JcZmBibPlwav7yzmibOutmw4g",VITE_SUPABASE_SERVICE_ROLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI",VITE_SUPABASE_URL:"https://qpzpxtlzgtdxaskmgoku.supabase.co"},Ff=t=>{let e;const n=new Set,s=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(x=>x(e,m))}},r=()=>e,c={setState:s,getState:r,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(x1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=e=t(s,r,c);return c},y1=t=>t?Ff(t):Ff;var l0={exports:{}},c0={},d0={exports:{}},u0={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jr=w;function v1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var b1=typeof Object.is=="function"?Object.is:v1,w1=jr.useState,_1=jr.useEffect,j1=jr.useLayoutEffect,N1=jr.useDebugValue;function S1(t,e){var n=e(),s=w1({inst:{value:n,getSnapshot:e}}),r=s[0].inst,i=s[1];return j1(function(){r.value=n,r.getSnapshot=e,yc(r)&&i({inst:r})},[t,n,e]),_1(function(){return yc(r)&&i({inst:r}),t(function(){yc(r)&&i({inst:r})})},[t]),N1(n),n}function yc(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!b1(t,n)}catch{return!0}}function k1(t,e){return e()}var C1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?k1:S1;u0.useSyncExternalStore=jr.useSyncExternalStore!==void 0?jr.useSyncExternalStore:C1;d0.exports=u0;var P1=d0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sl=w,E1=P1;function M1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var T1=typeof Object.is=="function"?Object.is:M1,O1=E1.useSyncExternalStore,A1=Sl.useRef,R1=Sl.useEffect,D1=Sl.useMemo,I1=Sl.useDebugValue;c0.useSyncExternalStoreWithSelector=function(t,e,n,s,r){var i=A1(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=D1(function(){function c(m){if(!d){if(d=!0,u=m,m=s(m),r!==void 0&&a.hasValue){var x=a.value;if(r(x,m))return h=x}return h=m}if(x=h,T1(u,m))return x;var g=s(m);return r!==void 0&&r(x,g)?x:(u=m,h=g)}var d=!1,u,h,f=n===void 0?null:n;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,n,s,r]);var l=O1(t,i[0],i[1]);return R1(function(){a.hasValue=!0,a.value=l},[l]),I1(l),l};l0.exports=c0;var L1=l0.exports;const F1=Pp(L1),h0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUwNDQ2OTEsImV4cCI6MjA1MDYyMDY5MX0.BkDQ9YLN1j-6NsTGS0JcZmBibPlwav7yzmibOutmw4g",VITE_SUPABASE_SERVICE_ROLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI",VITE_SUPABASE_URL:"https://qpzpxtlzgtdxaskmgoku.supabase.co"},{useDebugValue:B1}=Ke,{useSyncExternalStoreWithSelector:$1}=F1;let Bf=!1;const z1=t=>t;function U1(t,e=z1,n){(h0?"production":void 0)!=="production"&&n&&!Bf&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Bf=!0);const s=$1(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return B1(s),s}const V1=t=>{(h0?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?y1(t):t,n=(s,r)=>U1(e,s,r);return Object.assign(n,e),n},kl=t=>V1,W1={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUwNDQ2OTEsImV4cCI6MjA1MDYyMDY5MX0.BkDQ9YLN1j-6NsTGS0JcZmBibPlwav7yzmibOutmw4g",VITE_SUPABASE_SERVICE_ROLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI",VITE_SUPABASE_URL:"https://qpzpxtlzgtdxaskmgoku.supabase.co"};function H1(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var i;const a=c=>c===null?null:JSON.parse(c,void 0),l=(i=n.getItem(r))!=null?i:null;return l instanceof Promise?l.then(a):a(l)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const Ki=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(s){return Ki(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return Ki(s)(n)}}}},q1=(t,e)=>(n,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,v)=>({...v,...y}),...e},a=!1;const l=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},s,r);const u=Ki(i.serialize),h=()=>{const y=i.partialize({...s()});let v;const p=u({state:y,version:i.version}).then(b=>d.setItem(i.name,b)).catch(b=>{v=b});if(v)throw v;return p},f=r.setState;r.setState=(y,v)=>{f(y,v),h()};const m=t((...y)=>{n(...y),h()},s,r);let x;const g=()=>{var y;if(!d)return;a=!1,l.forEach(p=>p(s()));const v=((y=i.onRehydrateStorage)==null?void 0:y.call(i,s()))||void 0;return Ki(d.getItem.bind(d))(i.name).then(p=>{if(p)return i.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return i.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var b;return x=i.merge(p,(b=s())!=null?b:m),n(x,!0),h()}).then(()=>{v==null||v(x,void 0),a=!0,c.forEach(p=>p(x))}).catch(p=>{v==null||v(void 0,p)})};return r.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>a,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),x||m},Y1=(t,e)=>(n,s,r)=>{let i={storage:H1(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...e},a=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},s,r);const u=()=>{const g=i.partialize({...s()});return d.setItem(i.name,{state:g,version:i.version})},h=r.setState;r.setState=(g,y)=>{h(g,y),u()};const f=t((...g)=>{n(...g),u()},s,r);r.getInitialState=()=>f;let m;const x=()=>{var g,y;if(!d)return;a=!1,l.forEach(p=>{var b;return p((b=s())!=null?b:f)});const v=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(g=s())!=null?g:f))||void 0;return Ki(d.getItem.bind(d))(i.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return[!0,i.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var b;const[j,_]=p;if(m=i.merge(_,(b=s())!=null?b:f),n(m,!0),j)return u()}).then(()=>{v==null||v(m,void 0),m=s(),a=!0,c.forEach(p=>p(m))}).catch(p=>{v==null||v(void 0,p)})};return r.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:g=>(l.add(g),()=>{l.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||x(),m||f},Q1=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((W1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),q1(t,e)):Y1(t,e),Cl=Q1,ce=kl()(Cl(t=>({user:null,businessCode:null,setUser:e=>t({user:e,businessCode:(e==null?void 0:e.businessCode)||null}),setBusinessCode:e=>t({businessCode:e})}),{name:"auth-storage"})),Y=kl()(Cl(t=>({language:"ar",setLanguage:e=>t({language:e})}),{name:"language-storage"})),ve=({to:t,icon:e,children:n})=>o.jsxs(B_,{to:t,className:({isActive:s})=>`flex items-center space-x-2 space-x-reverse px-4 py-2 rounded-md transition-colors ${s?"bg-indigo-500 text-white":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,children:[o.jsx(e,{className:"w-5 h-5"}),o.jsx("span",{children:n})]});function G1(){const{user:t}=ce(),{language:e}=Y();return o.jsx("aside",{className:"w-64 bg-white border-l border-gray-200 overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-center p-4",children:[o.jsx(Be,{className:"w-8 h-8 text-indigo-600"}),o.jsx("span",{className:"mr-2 text-xl font-bold text-gray-900",children:e==="ar"?"متجري":"My Store"})]}),o.jsx("nav",{className:"mt-8 space-y-2",children:(t==null?void 0:t.role)==="admin"?o.jsxs(o.Fragment,{children:[o.jsx(ve,{to:"/dashboard",icon:u1,children:e==="ar"?"أصحاب المتاجر":"Store Owners"}),o.jsx(ve,{to:"/cashiers",icon:Gi,children:e==="ar"?"الكاشير":"Cashiers"}),o.jsx(ve,{to:"/vendors",icon:Be,children:e==="ar"?"الموردين":"Vendors"})]}):(t==null?void 0:t.role)==="vendor"?o.jsxs(o.Fragment,{children:[o.jsx(ve,{to:"/dashboard",icon:Df,children:e==="ar"?"لوحة التحكم":"Dashboard"}),o.jsx(ve,{to:"/products",icon:tn,children:e==="ar"?"منتجاتي":"My Products"}),o.jsx(ve,{to:"/settings",icon:If,children:e==="ar"?"الإعدادات":"Settings"})]}):o.jsxs(o.Fragment,{children:[o.jsx(ve,{to:"/dashboard",icon:Df,children:e==="ar"?"الرئيسية":"Dashboard"}),o.jsx(ve,{to:"/pos",icon:r0,children:e==="ar"?"نقطة البيع":"POS"}),o.jsx(ve,{to:"/products",icon:tn,children:e==="ar"?"المنتجات":"Products"}),o.jsx(ve,{to:"/upcoming-products",icon:tn,children:e==="ar"?"المنتجات القادمة":"Upcoming Products"}),o.jsx(ve,{to:"/customers",icon:Gi,children:e==="ar"?"العملاء":"Customers"}),o.jsx(ve,{to:"/cash-drawer",icon:ho,children:e==="ar"?"درج النقود":"Cash Drawer"}),o.jsx(ve,{to:"/returns",icon:Xx,children:e==="ar"?"المرتجعات":"Returns"}),o.jsx(ve,{to:"/receipts",icon:a1,children:e==="ar"?"سجل الفواتير":"Receipts"}),o.jsx(ve,{to:"/reports",icon:Y_,children:e==="ar"?"التقارير":"Reports"}),((t==null?void 0:t.role)==="owner"||(t==null?void 0:t.role)==="manager")&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"pt-4 mb-2 border-t",children:o.jsx("p",{className:"px-4 text-xs font-semibold text-gray-500 uppercase",children:e==="ar"?"الإدارة":"Management"})}),o.jsx(ve,{to:"/cashiers",icon:Lf,children:e==="ar"?"الكاشير":"Cashiers"}),o.jsx(ve,{to:"/managers",icon:Lf,children:e==="ar"?"المدراء":"Managers"}),o.jsx(ve,{to:"/sub-vendors",icon:m1,children:e==="ar"?"الموردين":"Vendors"}),o.jsx(ve,{to:"/branches",icon:wr,children:e==="ar"?"الفروع":"Branches"}),o.jsx(ve,{to:"/rentals",icon:wr,children:e==="ar"?"الإيجارات":"Rentals"}),o.jsx(ve,{to:"/coupons",icon:o0,children:e==="ar"?"الكوبونات":"Coupons"}),o.jsx(ve,{to:"/settings",icon:If,children:e==="ar"?"الإعدادات":"Settings"}),o.jsx(ve,{to:"/developer",icon:X_,children:e==="ar"?"المطور":"Developer"})]})]})})]})})}const K1="modulepreload",J1=function(t){return"/"+t},$f={},Nr=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=J1(c),c in $f)return;$f[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":K1,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return r.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},X1=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Nr(async()=>{const{default:s}=await Promise.resolve().then(()=>Dr);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class Yu extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class Z1 extends Yu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ej extends Yu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tj extends Yu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Td;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Td||(Td={}));var nj=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class sj{constructor(e,{headers:n={},customFetch:s,region:r=Td.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=X1(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var s;return nj(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:a}=n;let l={},{region:c}=n;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let d;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(l["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(l["Content-Type"]="application/json",d=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:d}).catch(x=>{throw new Z1(x)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new ej(u);if(!u.ok)throw new tj(u);let f=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield u.json():f==="application/octet-stream"?m=yield u.blob():f==="text/event-stream"?m=u:f==="multipart/form-data"?m=yield u.formData():m=yield u.text(),{data:m,error:null}}catch(r){return{data:null,error:r}}})}}var it={},Qu={},Pl={},fo={},El={},Ml={},rj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Sr=rj();const ij=Sr.fetch,f0=Sr.fetch.bind(Sr),m0=Sr.Headers,oj=Sr.Request,aj=Sr.Response,Dr=Object.freeze(Object.defineProperty({__proto__:null,Headers:m0,Request:oj,Response:aj,default:f0,fetch:ij},Symbol.toStringTag,{value:"Module"})),lj=lv(Dr);var Tl={};Object.defineProperty(Tl,"__esModule",{value:!0});class cj extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}Tl.default=cj;var p0=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ml,"__esModule",{value:!0});const dj=p0(lj),uj=p0(Tl);let hj=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=dj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,c;let d=null,u=null,h=null,f=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const v=await i.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const g=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),y=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,f=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await i.text();try{d=JSON.parse(g),Array.isArray(d)&&i.status===404&&(u=[],d=null,f=200,m="OK")}catch{i.status===404&&g===""?(f=204,m="No Content"):d={message:g}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,f=200,m="OK"),d&&this.shouldThrowOnError)throw new uj.default(d)}return{error:d,data:u,count:h,status:f,statusText:m}});return this.shouldThrowOnError||(r=r.catch(i=>{var a,l,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}};Ml.default=hj;var fj=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(El,"__esModule",{value:!0});const mj=fj(Ml);let pj=class extends mj.default{select(e){let n=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:s,referencedTable:r=s}={}){const i=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};El.default=pj;var gj=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fo,"__esModule",{value:!0});const xj=gj(El);let yj=class extends xj.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const s=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(e,n,s){return this.url.searchParams.append(e,`not.${n}.${s}`),this}or(e,{foreignTable:n,referencedTable:s=n}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,s){return this.url.searchParams.append(e,`${n}.${s}`),this}};fo.default=yj;var vj=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pl,"__esModule",{value:!0});const Jr=vj(fo);let bj=class{constructor(e,{headers:n={},schema:s,fetch:r}){this.url=e,this.headers=n,this.schema=s,this.fetch=r}select(e,{head:n=!1,count:s}={}){const r=n?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new Jr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:s=!0}={}){const r="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Jr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const a="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Jr.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const s="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new Jr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Jr.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Pl.default=bj;var Ol={},Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.version=void 0;Al.version="0.0.0-automated";Object.defineProperty(Ol,"__esModule",{value:!0});Ol.DEFAULT_HEADERS=void 0;const wj=Al;Ol.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${wj.version}`};var g0=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qu,"__esModule",{value:!0});const _j=g0(Pl),jj=g0(fo),Nj=Ol;let Sj=class x0{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Nj.DEFAULT_HEADERS),n),this.schemaName=s,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new _j.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new x0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){let a;const l=new URL(`${this.url}/rpc/${e}`);let c;s||r?(a=s?"HEAD":"GET",Object.entries(n).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(a="POST",c=n);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new jj.default({method:a,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Qu.default=Sj;var Ir=kt&&kt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(it,"__esModule",{value:!0});it.PostgrestError=it.PostgrestBuilder=it.PostgrestTransformBuilder=it.PostgrestFilterBuilder=it.PostgrestQueryBuilder=it.PostgrestClient=void 0;const y0=Ir(Qu);it.PostgrestClient=y0.default;const v0=Ir(Pl);it.PostgrestQueryBuilder=v0.default;const b0=Ir(fo);it.PostgrestFilterBuilder=b0.default;const w0=Ir(El);it.PostgrestTransformBuilder=w0.default;const _0=Ir(Ml);it.PostgrestBuilder=_0.default;const j0=Ir(Tl);it.PostgrestError=j0.default;var kj=it.default={PostgrestClient:y0.default,PostgrestQueryBuilder:v0.default,PostgrestFilterBuilder:b0.default,PostgrestTransformBuilder:w0.default,PostgrestBuilder:_0.default,PostgrestError:j0.default};const{PostgrestClient:Cj,PostgrestQueryBuilder:gT,PostgrestFilterBuilder:xT,PostgrestTransformBuilder:yT,PostgrestBuilder:vT}=kj,Pj="2.10.7",Ej={"X-Client-Info":`realtime-js/${Pj}`},Mj="1.0.0",N0=1e4,Tj=1e3;var lr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(lr||(lr={}));var ut;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ut||(ut={}));var Lt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Lt||(Lt={}));var Od;(function(t){t.websocket="websocket"})(Od||(Od={}));var gs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(gs||(gs={}));class Oj{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2);let a=this.HEADER_LENGTH+2;const l=s.decode(e.slice(a,a+r));a=a+r;const c=s.decode(e.slice(a,a+i));a=a+i;const d=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class S0{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ue;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ue||(ue={}));const zf=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=Aj(a,t,e,r),i),{})},Aj=(t,e,n,s)=>{const r=e.find(l=>l.name===t),i=r==null?void 0:r.type,a=n[t];return i&&!s.includes(i)?k0(i,a):Ad(a)},k0=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Lj(e,n)}switch(t){case ue.bool:return Rj(e);case ue.float4:case ue.float8:case ue.int2:case ue.int4:case ue.int8:case ue.numeric:case ue.oid:return Dj(e);case ue.json:case ue.jsonb:return Ij(e);case ue.timestamp:return Fj(e);case ue.abstime:case ue.date:case ue.daterange:case ue.int4range:case ue.int8range:case ue.money:case ue.reltime:case ue.text:case ue.time:case ue.timestamptz:case ue.timetz:case ue.tsrange:case ue.tstzrange:return Ad(e);default:return Ad(e)}},Ad=t=>t,Rj=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Dj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ij=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Lj=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const a=t.slice(1,n);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>k0(e,l))}return t},Fj=t=>typeof t=="string"?t.replace(" ","T"):t,C0=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class vc{constructor(e,n,s={},r=N0){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Uf;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Uf||(Uf={}));class ji{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ji.syncState(this.state,r,i,a),this.pendingDiffs.forEach(c=>{this.state=ji.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ji.syncDiff(this.state,r,i,a),l())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),a=this.transformState(n),l={},c={};return this.map(i,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const h=i[d];if(h){const f=u.map(y=>y.presence_ref),m=h.map(y=>y.presence_ref),x=u.filter(y=>m.indexOf(y.presence_ref)<0),g=h.filter(y=>f.indexOf(y.presence_ref)<0);x.length>0&&(l[d]=x),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);e[l].unshift(...f)}s(l,u,c)}),this.map(a,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,r(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Vf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Vf||(Vf={}));var Wf;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Wf||(Wf={}));var Hf;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Hf||(Hf={}));class Gu{constructor(e,n={config:{}},s){this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new vc(this,Lt.join,this.params,this.timeout),this.rejoinTimer=new S0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ut.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lt.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new ji(this),this.broadcastEndpointURL=C0(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:l}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const c={},d={broadcast:i,presence:a,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&r!==void 0?r:[],private:l};this.socket.accessToken&&(c.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const f=this.bindings.postgres_changes,m=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,x=[];for(let g=0;g<m;g++){const y=f[g],{filter:{event:v,schema:p,table:b,filter:j}}=y,_=u&&u[g];if(_&&_.event===v&&_.schema===p&&_.table===b&&_.filter===j)x.push(Object.assign(Object.assign({},y),{id:_.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this._on(e,n,s)}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ut.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const r=new vc(this,Lt.leave,{},e);r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),a}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new vc(this,e,n,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Lt;if(s&&[l,c,d,u].indexOf(a)>=0&&s!==this._joinRef())return;let f=this._onMessage(a,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(m=>{var x,g,y;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((y=(g=m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===a}).map(m=>m.callback(f,s)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var x,g,y,v,p,b;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const j=m.id,_=(x=m.filter)===null||x===void 0?void 0:x.event;return j&&((g=n.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(p=(v=m==null?void 0:m.filter)===null||v===void 0?void 0:v.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return j==="*"||j===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:g,table:y,commit_timestamp:v,type:p,errors:b}=x;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:v,eventType:p,new:{},old:{},errors:b}),this._getPayloadRecords(x))}m.callback(f,s)})}_isClosed(){return this.state===ut.closed}_isJoined(){return this.state===ut.joined}_isJoining(){return this.state===ut.joining}_isLeaving(){return this.state===ut.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Gu.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Lt.close,{},e)}_onError(e){this._on(Lt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ut.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=zf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=zf(e.columns,e.old_record)),n}}const Bj=()=>{},$j=typeof WebSocket<"u",zj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Uj{constructor(e,n){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Ej,this.params={},this.timeout=N0,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Bj,this.conn=null,this.sendBuffer=[],this.serializer=new Oj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...l)=>Nr(async()=>{const{default:c}=await Promise.resolve().then(()=>Dr);return{default:c}},void 0).then(({default:c})=>c(...l)):a=fetch,(...l)=>a(...l)},this.endPoint=`${e}/${Od.websocket}`,this.httpEndpoint=C0(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(s=n==null?void 0:n.params)===null||s===void 0?void 0:s.apikey;if(r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,a)=>a(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new S0(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if($j){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Vj(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Nr(async()=>{const{default:e}=await import("./browser-Cad1C9fo.js").then(n=>n.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case lr.connecting:return gs.Connecting;case lr.open:return gs.Open;case lr.closing:return gs.Closing;default:return gs.Closed}}isConnected(){return this.connectionState()===gs.Open}channel(e,n={config:{}}){const s=new Gu(`realtime:${e}`,n,this);return this.channels.push(s),s}push(e){const{topic:n,event:s,payload:r,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(Lt.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Mj}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:s,event:r,payload:i,ref:a}=n;(a&&a===this.pendingHeartbeatRef||r===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${r} ${a&&"("+a+")"||""}`,i),this.channels.filter(l=>l._isMember(s)).forEach(l=>l._trigger(r,i,a)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Lt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Tj,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([zj],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}}class Vj{constructor(e,n,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=lr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Ku extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Oe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Wj extends Ku{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Rd extends Ku{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Hj=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const P0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Nr(async()=>{const{default:s}=await Promise.resolve().then(()=>Dr);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},qj=()=>Hj(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Nr(()=>Promise.resolve().then(()=>Dr),void 0)).Response:Response}),Dd=t=>{if(Array.isArray(t))return t.map(n=>Dd(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=Dd(s)}),e};var Rs=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const bc=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Yj=(t,e,n)=>Rs(void 0,void 0,void 0,function*(){const s=yield qj();t instanceof s&&!(n!=null&&n.noResolveJson)?t.json().then(r=>{e(new Wj(bc(r),t.status||500))}).catch(r=>{e(new Rd(bc(r),r))}):e(new Rd(bc(t),t))}),Qj=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(r.body=JSON.stringify(s)),Object.assign(Object.assign({},r),n))};function mo(t,e,n,s,r,i){return Rs(this,void 0,void 0,function*(){return new Promise((a,l)=>{t(n,Qj(e,s,r,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Yj(c,l,s))})})}function Ya(t,e,n,s){return Rs(this,void 0,void 0,function*(){return mo(t,"GET",e,n,s)})}function Tn(t,e,n,s,r){return Rs(this,void 0,void 0,function*(){return mo(t,"POST",e,s,r,n)})}function Gj(t,e,n,s,r){return Rs(this,void 0,void 0,function*(){return mo(t,"PUT",e,s,r,n)})}function Kj(t,e,n,s){return Rs(this,void 0,void 0,function*(){return mo(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function E0(t,e,n,s,r){return Rs(this,void 0,void 0,function*(){return mo(t,"DELETE",e,s,r,n)})}var nt=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Jj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xj{constructor(e,n={},s,r){this.url=e,this.headers=n,this.bucketId=s,this.fetch=P0(r)}uploadOrUpdate(e,n,s,r){return nt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},qf),r);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),r!=null&&r.headers&&(l=Object.assign(Object.assign({},l),r.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{})),f=yield h.json();return h.ok?{data:{path:d,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(Oe(i))return{data:null,error:i};throw i}})}upload(e,n,s){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,r){return nt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:qf.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:u}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(c){if(Oe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return nt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);n!=null&&n.upsert&&(r["x-upsert"]="true");const i=yield Tn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new Ku("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}})}update(e,n,s){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return nt(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}copy(e,n,s){return nt(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}createSignedUrl(e,n,s){return nt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield Tn(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,s){return nt(this,void 0,void 0,function*(){try{const r=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}download(e,n){return nt(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ya(this.fetch,`${this.url}/${r}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Oe(l))return{data:null,error:l};throw l}})}info(e){return nt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield Ya(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Dd(s),error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}})}exists(e){return nt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Kj(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Oe(s)&&s instanceof Rd){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),r=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&r.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&r.push(c);let d=r.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return nt(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}list(e,n,s){return nt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Jj),n),{prefix:e||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Zj="2.7.1",eN={"X-Client-Info":`storage-js/${Zj}`};var Fs=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class tN{constructor(e,n={},s){this.url=e,this.headers=Object.assign(Object.assign({},eN),n),this.fetch=P0(s)}listBuckets(){return Fs(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Oe(e))return{data:null,error:e};throw e}})}getBucket(e){return Fs(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Fs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return Fs(this,void 0,void 0,function*(){try{return{data:yield Gj(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Oe(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Fs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Fs(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}}class nN extends tN{constructor(e,n={},s){super(e,n,s)}from(e){return new Xj(this.url,this.headers,e,this.fetch)}}const sN="2.46.1";let li="";typeof Deno<"u"?li="deno":typeof document<"u"?li="web":typeof navigator<"u"&&navigator.product==="ReactNative"?li="react-native":li="node";const rN={"X-Client-Info":`supabase-js-${li}/${sN}`},iN={headers:rN},oN={schema:"public"},aN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lN={};var cN=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const dN=t=>{let e;return t?e=t:typeof fetch>"u"?e=f0:e=fetch,(...n)=>e(...n)},uN=()=>typeof Headers>"u"?m0:Headers,hN=(t,e,n)=>{const s=dN(n),r=uN();return(i,a)=>cN(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new r(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},a),{headers:d}))})};var fN=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};function mN(t){return t.replace(/\/$/,"")}function pN(t,e){const{db:n,auth:s,realtime:r,global:i}=t,{db:a,auth:l,realtime:c,global:d}=e,u={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},l),s),realtime:Object.assign(Object.assign({},c),r),global:Object.assign(Object.assign({},d),i),accessToken:()=>fN(this,void 0,void 0,function*(){return""})};return t.accessToken?u.accessToken=t.accessToken:delete u.accessToken,u}const M0="2.65.1",gN="http://localhost:9999",xN="supabase.auth.token",yN={"X-Client-Info":`gotrue-js/${M0}`},Yf=10,Id="X-Supabase-Api-Version",T0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function vN(t){return Math.round(Date.now()/1e3)+t}function bN(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Rt=()=>typeof document<"u",os={tested:!1,writable:!1},Ni=()=>{if(!Rt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(os.tested)return os.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),os.tested=!0,os.writable=!0}catch{os.tested=!0,os.writable=!1}return os.writable};function wc(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const O0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Nr(async()=>{const{default:s}=await Promise.resolve().then(()=>Dr);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},wN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",A0=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Io=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Lo=async(t,e)=>{await t.removeItem(e)};function _N(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",s,r,i,a,l,c,d,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)a=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),d=e.indexOf(t.charAt(u++)),s=a<<2|l>>4,r=(l&15)<<4|c>>2,i=(c&3)<<6|d,n=n+String.fromCharCode(s),c!=64&&r!=0&&(n=n+String.fromCharCode(r)),d!=64&&i!=0&&(n=n+String.fromCharCode(i));return n}class Rl{constructor(){this.promise=new Rl.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Rl.promiseConstructor=Promise;function Qf(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=n[1];return JSON.parse(_N(s))}async function jN(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function NN(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function SN(t){return("0"+t.toString(16)).substr(-2)}function kN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,SN).join("")}async function CN(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}function PN(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function EN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await CN(t);return PN(n)}async function Bs(t,e,n=!1){const s=kN();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await A0(t,`${e}-code-verifier`,r);const i=await EN(s);return[i,s===i?"plain":"s256"]}const MN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function TN(t){const e=t.headers.get(Id);if(!e||!e.match(MN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Ju extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Z(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class ON extends Ju{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function AN(t){return Z(t)&&t.name==="AuthApiError"}class R0 extends Ju{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ds extends Ju{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class kn extends Ds{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function RN(t){return Z(t)&&t.name==="AuthSessionMissingError"}class _c extends Ds{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fo extends Ds{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Bo extends Ds{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gf extends Ds{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ld extends Ds{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function jc(t){return Z(t)&&t.name==="AuthRetryableFetchError"}class Kf extends Ds{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}var DN=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};const hs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),IN=[502,503,504];async function Jf(t){var e;if(!wN(t))throw new Ld(hs(t),0);if(IN.includes(t.status))throw new Ld(hs(t),t.status);let n;try{n=await t.json()}catch(i){throw new R0(hs(i),i)}let s;const r=TN(t);if(r&&r.getTime()>=T0["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Kf(hs(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new kn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Kf(hs(n),t.status,n.weak_password.reasons);throw new ON(hs(n),t.status||500,s)}const LN=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function ne(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[Id]||(i[Id]=T0["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await FN(t,e,n+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function FN(t,e,n,s,r,i){const a=LN(e,s,r,i);let l;try{l=await t(n,Object.assign({},a))}catch(c){throw console.error(c),new Ld(hs(c),0)}if(l.ok||await Jf(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Jf(c)}}function Cn(t){var e;let n=null;UN(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=vN(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function Xf(t){const e=Cn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Rn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function BN(t){return{data:t,error:null}}function $N(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,a=DN(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function zN(t){return t}function UN(t){return t.access_token&&t.refresh_token&&t.expires_in}var VN=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class WN{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=O0(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Rn})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=VN(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:$N,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Z(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Rn})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:zN});if(u.error)throw u.error;const h=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(x.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Z(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Rn})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Rn})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Rn})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:n,error:s}=await ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}}const HN={getItem:t=>Ni()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Ni()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Ni()&&globalThis.localStorage.removeItem(t)}};function Zf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function qN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $s={debug:!!(globalThis&&Ni()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class D0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class YN extends D0{}async function QN(t,e,n){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),$s.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw $s.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new YN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if($s.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}qN();const GN={url:gN,storageKey:xN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Xr=30*1e3,em=3;async function tm(t,e,n){return await n()}class Ji{constructor(e){var n,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ji.nextInstanceID,Ji.nextInstanceID+=1,this.instanceID>0&&Rt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},GN),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new WN({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=O0(r.fetch),this.lock=r.lock||tm,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Rt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=QN:this.lock=tm,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Ni()?this.storage=HN:(this.memoryStorage={},this.storage=Zf(this.memoryStorage)):(this.memoryStorage={},this.storage=Zf(this.memoryStorage)),Rt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${M0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=Rt()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.code)==="identity_already_exists"?{error:s}:(await this._removeSession(),{error:s});const{session:r,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Z(e)?{error:e}:{error:new R0("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Cn}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Bs(this.storage,this.storageKey)),i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:x},xform:Cn})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Cn})}else throw new Fo("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:a,options:l}=e;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Xf})}else if("phone"in e){const{phone:i,password:a,options:l}=e;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Xf})}else throw new Fo("You must provide either an email or phone number and a password");const{data:s,error:r}=n;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new _c}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{const{data:i,error:a}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Cn});if(await Lo(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new _c}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:a})}catch(i){if(Z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:a}=e,l=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Cn}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new _c}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,r,i,a;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Bs(this.storage,this.storageKey));const{error:h}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Fo("You must provide either an email or phone number.")}catch(l){if(Z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:l}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Cn});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,s,r;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Bs(this.storage,this.storageKey)),await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:BN})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new kn;const{error:r}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:l}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new Fo("You must provide either an email or phone number and a type")}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Rn}):await this._useSession(async n=>{var s,r,i;const{data:a,error:l}=n;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kn}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Rn})})}catch(n){if(Z(n))return RN(n)&&(await this._removeSession(),await Lo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new kn;const a=r.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Bs(this.storage,this.storageKey));const{data:d,error:u}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Rn});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Qf(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kn;const n=Date.now()/1e3;let s=n,r=!0,i=null;const a=Qf(e.access_token);if(a.exp&&(s=a.exp,r=s<=n),r){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Z(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:a,error:l}=n;if(l)throw l;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new kn;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!Rt())throw new Bo("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Bo("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Gf("Not a valid PKCE flow url.");const n=wc(window.location.href);if(e){if(!n.code)throw new Gf("No code detected.");const{data:p,error:b}=await this._exchangeCodeForSession(n.code);if(b)throw b;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:p.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new Bo(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:d}=n;if(!i||!l||!a||!d)throw new Bo("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const m=f-u;m*1e3<=Xr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const x=f-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,u);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const v={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:n.type},error:null}}catch(n){if(Z(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=wc(window.location.href);return!!(Rt()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=wc(window.location.href),n=await Io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return{error:i};const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(AN(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Lo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=bN(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:a}=n;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Bs(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var a,l,c,d,u;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return Rt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Z(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:a}=n;if(a)throw a;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await NN(async r=>(r>0&&await jN(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Cn})),(r,i)=>{const a=200*Math.pow(2,r);return i&&jc(i)&&Date.now()+a-s<Xr})}catch(s){if(this._debug(n,"error",s),Z(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Rt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Io(this.storage,this.storageKey);if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+Yf;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Yf}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),jc(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Rl;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new kn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(r,"error",i),Z(i)){const a={session:null,error:i};return jc(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await A0(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Lo(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Rt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Xr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Xr}ms, refresh threshold is ${em} ticks`),r<=em&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof D0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Rt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Bs(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?{data:null,error:i}:await ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:a}=n;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((r=c==null?void 0:c.totp)===null||r===void 0)&&r.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return{data:null,error:i};const{data:a,error:l}=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(n){if(Z(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?{data:null,error:i}:await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Z(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s=(e==null?void 0:e.factors)||[],r=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((s=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}}Ji.nextInstanceID=0;const KN=Ji;class JN extends KN{constructor(e){super(e)}}var XN=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):r(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class ZN{constructor(e,n,s){var r,i,a;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=mN(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const c=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,d={db:oN,realtime:lN,auth:Object.assign(Object.assign({},aN),{storageKey:c}),global:iN},u=pN(s??{},d);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=hN(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},u.realtime)),this.rest=new Cj(`${l}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new sj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new nN(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return XN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:r,storageKey:i,flowType:a,lock:l,debug:c},d,u){var h;const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new JN({url:this.authUrl,headers:Object.assign(Object.assign({},f),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:r,flowType:a,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:(h="Authorization"in this.headers)!==null&&h!==void 0?h:!1})}_initRealtimeClient(e){return new Uj(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Dl=(t,e,n)=>new ZN(t,e,n),eS="https://qpzpxtlzgtdxaskmgoku.supabase.co",tS="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUwNDQ2OTEsImV4cCI6MjA1MDYyMDY5MX0.BkDQ9YLN1j-6NsTGS0JcZmBibPlwav7yzmibOutmw4g",V=Dl(eS,tS);async function I0(t){const{data:e,error:n}=await V.from("profiles").select("main_branch").eq("user_id",t).single();return n?(console.error("Error fetching user main branch:",n),null):(e==null?void 0:e.main_branch)||null}async function nS(t){console.log("Fetching profile for user:",t);const{data:e,error:n}=await V.from("profiles").select("*").eq("user_id",t).single();return n?(console.error("Error fetching profile:",n),null):(console.log("Profile data retrieved:",{userId:t,role:e==null?void 0:e.role,mainBranch:e==null?void 0:e.main_branch,businessCode:e==null?void 0:e.business_code}),e)}function sS(t){if(!t.role)return"/setup-profile";const e=t.role.toLowerCase();switch(console.log("Determining redirect path for role:",e),e){case"admin":return"/admin/dashboard";case"owner":return"/dashboard";case"cashier":return"/pos";case"vendor":return console.log("Redirecting vendor to sub-vendor dashboard"),"/dashboard";default:return console.log("Using default redirect to dashboard"),"/dashboard"}}async function Il(t){console.log("Fetching branches for business code:",t);const{data:e,error:n}=await V.from("branches").select("*").eq("business_code",t);return n?(console.error("Error fetching branches:",n),[]):(console.log("Supabase branches response:",{businessCode:t,data:e,error:n}),e||[])}async function rS(t){return!t.role||!t.business_code?(console.error("Missing required profile fields:",{role:t.role,business_code:t.business_code}),!1):t.role==="vendor"&&!t.is_vendor?(console.error("Invalid vendor profile: is_vendor flag not set"),!1):t.role==="admin"?(console.log("Admin access granted"),!0):(console.log("Default access granted for role:",t.role),!0)}function L0(){const[t,e]=w.useState(!1),[n,s]=w.useState(null),{setUser:r}=ce();return{signIn:async(l,c)=>{try{e(!0),s(null);const{data:d,error:u}=await V.auth.signInWithPassword({email:l,password:c});if(u)throw u;if(d.user){const h=await nS(d.user.id);if(h){console.log("Profile loaded:",h);const f=await rS(h);if(console.log("Business access validated:",f),!f)throw new Error("Invalid business code or no access to this business");console.log("Setting user with business code:",h.business_code),r({id:d.user.id,email:d.user.email,name:h.full_name||"",role:h.role||"user",businessCode:h.business_code||""})}return{user:d.user,profile:h}}return{user:null,profile:null}}catch(d){return s(d instanceof Error?d.message:"An error occurred"),{user:null,profile:null}}finally{e(!1)}},signOut:async()=>{try{e(!0),s(null),localStorage.removeItem("business-storage");const{error:l}=await V.auth.signOut();if(l)throw l;r(null)}catch(l){s(l instanceof Error?l.message:"An error occurred")}finally{e(!1)}},isLoading:t,error:n}}function iS(){const{language:t,setLanguage:e}=Y();return o.jsx("div",{className:"relative inline-block text-left",children:o.jsxs("button",{type:"button",onClick:()=>e(t==="ar"?"en":"ar"),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[o.jsx(e0,{className:"h-4 w-4 ml-2"}),t==="ar"?"English":"العربية"]})})}function oS(){const{user:t}=ce(),{signOut:e}=L0(),{language:n}=Y(),s=jl(),r=async()=>{await e(),s("/login")};return o.jsx("header",{className:"bg-white shadow-sm",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n==="ar"?"نظام نقاط البيع":"POS System"}),o.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[o.jsx(iS,{}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(g1,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-gray-700",children:t==null?void 0:t.name})]}),o.jsxs("button",{onClick:r,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[o.jsx(n1,{className:"w-4 h-4 ml-2"}),n==="ar"?"تسجيل الخروج":"Logout"]})]})]})})}const Ze=kl()(Cl((t,e)=>({businessCode:null,branches:[],selectedBranchId:null,defaultBranchId:null,setBusinessCode:n=>t({businessCode:n}),setBranches:n=>t({branches:n}),setSelectedBranch:n=>t({selectedBranchId:n}),setDefaultBranch:n=>t({defaultBranchId:n}),getCurrentBranch:()=>{const{branches:n,selectedBranchId:s}=e();return!s||s==="all"?null:n.find(r=>r.branch_id===s)||null}}),{name:"business-storage"}));function aS(){const{language:t}=Y(),{user:e}=ce(),{setBranches:n}=Ze();return w.useEffect(()=>{e!=null&&e.businessCode&&Il(e.businessCode).then(s=>{console.log("Fetched branches:",s),n(s)}).catch(s=>{console.error("Error fetching branches:",s)})},[e==null?void 0:e.businessCode]),o.jsxs("div",{className:"flex h-screen bg-gray-50",dir:t==="ar"?"rtl":"ltr",children:[o.jsx(G1,{}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx(oS,{}),o.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",children:o.jsx(S_,{})})]})]})}const _n=kl()(Cl(t=>({settings:null,isLoading:!1,error:null,setSettings:e=>t({settings:e}),setIsLoading:e=>t({isLoading:e}),setError:e=>t({error:e}),updateSettings:e=>t(n=>({settings:n.settings?{...n.settings,...e}:null}))}),{name:"business-settings-storage"}));async function F0(t){try{const{data:e,error:n}=await V.from("business_settings").select("*").eq("business_code_",t).maybeSingle();if(n&&n.code!=="PGRST116")throw n;return e||B0(t)}catch(e){throw console.error("Error in getBusinessSettings:",e),e}}async function B0(t){const e={business_code_:t,receipt_header:null,receipt_footer:null,url_logo_of_business:null,loyalty_system_enabled:!1,vendor_commission_enabled:!1,default_commission_rate:10,minimum_commission_amount:0,tax_enabled:!1,tax_rate:0},{data:n,error:s}=await V.from("business_settings").insert([e]).select().single();if(s)throw console.error("Error creating default settings:",s),s;return n}async function Fd(t,e){console.log("Updating settings with:",e);const n={...e,default_commission_rate:e.default_commission_rate!==void 0?Number(e.default_commission_rate):void 0,minimum_commission_amount:e.minimum_commission_amount!==void 0?Number(e.minimum_commission_amount):void 0,tax_rate:e.tax_rate!==void 0?Number(e.tax_rate):void 0,updated_at:new Date().toISOString()},{data:s}=await V.from("business_settings").select("setting_id").eq("business_code_",t).maybeSingle();if(!s)return await B0(t),Fd(t,e);const{data:r,error:i}=await V.from("business_settings").update(n).eq("business_code_",t).select().single();if(i)throw console.error("Error updating business settings:",i),i;return console.log("Settings updated successfully:",r),r}function lS(){const{user:t}=ce(),{settings:e,isLoading:n,error:s,setSettings:r,setIsLoading:i,setError:a}=_n();return w.useEffect(()=>{e||(async()=>{if(t!=null&&t.businessCode)try{i(!0),a(null);const c=await F0(t.businessCode);r(c)}catch(c){console.error("Error loading business settings:",c),a(c instanceof Error?c.message:"Failed to load settings")}finally{i(!1)}})()},[t==null?void 0:t.businessCode]),{settings:e,isLoading:n,error:s}}const cS={ar:{title:"تسجيل الدخول إلى نظام نقاط البيع",email:"البريد الإلكتروني",password:"كلمة المرور",login:"تسجيل الدخول",loggingIn:"جاري تسجيل الدخول...",invalidCredentials:"اسم المستخدم أو كلمة المرور غير صحيحة",demoAccounts:"حسابات تجريبية",owner:"مالك المتجر",manager:"مدير المتجر",vendor:"المورد",cashier:"الكاشير",admin:"المشرف"},en:{title:"Sign in to POS System",email:"Email",password:"Password",login:"Sign in",loggingIn:"Signing in...",invalidCredentials:"Invalid username or password",demoAccounts:"Demo Accounts",owner:"Store Owner",manager:"Store Manager",vendor:"Vendor",cashier:"Cashier",admin:"Admin"}};function dS(){const{language:t}=Y(),e=cS[t],n=jl(),{user:s}=ce(),{signIn:r,isLoading:i,error:a}=L0(),[l,c]=w.useState(""),[d,u]=w.useState("");if(s)return o.jsx(Ha,{to:"/dashboard",replace:!0});const h=async f=>{f.preventDefault();const{user:m,profile:x}=await r(l,d);if(m&&x){const g=sS(x);n(g)}};return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[o.jsx("div",{className:"flex justify-center",children:o.jsx(Be,{className:"w-12 h-12 text-indigo-600"})}),o.jsx("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900",children:e.title})]}),o.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:o.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[o.jsxs("form",{className:"space-y-6",onSubmit:h,children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:e.email}),o.jsx("div",{className:"mt-1",children:o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:l,onChange:f=>c(f.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:e.password}),o.jsx("div",{className:"mt-1",children:o.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:d,onChange:f=>u(f.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})})]}),a&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(H_,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:a})})]})}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:i?e.loggingIn:e.login})})]}),o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-gray-300"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-white text-gray-500",children:e.demoAccounts})})]}),o.jsx("div",{className:"mt-6 grid grid-cols-1 gap-3",children:o.jsx("div",{className:"rounded-md bg-gray-50 p-4",children:o.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[o.jsxs("p",{children:[o.jsxs("strong",{children:[e.owner,":"]})," username: owner, password: owner123"]}),o.jsxs("p",{children:[o.jsxs("strong",{children:[e.vendor,":"]})," username: vendor, password: vendor123"]}),o.jsxs("p",{children:[o.jsxs("strong",{children:[e.cashier,":"]})," username: cashier, password: cashier123"]}),o.jsxs("p",{children:[o.jsxs("strong",{children:[e.admin,":"]})," username: admin, password: admin123"]})]})})})]})]})})]})}const uS={ar:{dashboard:"لوحة التحكم",dailySales:"المبيعات اليومية",newCustomers:"العملاء الجدد",totalSales:"إجمالي المبيعات",activeProducts:"المنتجات النشطة",latestSales:"أحدث المبيعات",topProducts:"المنتجات الأكثر مبيعاً",today:"اليوم",yesterday:"أمس",thisWeek:"هذا الأسبوع",thisMonth:"هذا الشهر",currency:"ر.ع",from:"من",increase:"ارتفاع",decrease:"انخفاض",noSalesData:"سيتم إضافة جدول المبيعات الأخيرة هنا",noProductsData:"سيتم إضافة قائمة المنتجات الأكثر مبيعاً هنا"},en:{dashboard:"Dashboard",dailySales:"Daily Sales",newCustomers:"New Customers",totalSales:"Total Sales",activeProducts:"Active Products",latestSales:"Latest Sales",topProducts:"Top Products",today:"Today",yesterday:"Yesterday",thisWeek:"This Week",thisMonth:"This Month",currency:"OMR",from:"from",increase:"increase",decrease:"decrease",noSalesData:"Latest sales table will be added here",noProductsData:"Top selling products list will be added here"}};function hS(){const{language:t}=Y(),e=uS[t];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.dashboard}),o.jsx("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString(t==="ar"?"ar":"en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx($o,{icon:h1,label:e.dailySales,value:`1,234 ${e.currency}`,trend:`↑ 12% ${e.from} ${e.yesterday}`}),o.jsx($o,{icon:Gi,label:e.newCustomers,value:"48",trend:`↑ 8% ${e.thisWeek}`}),o.jsx($o,{icon:a0,label:e.totalSales,value:`45,678 ${e.currency}`,trend:`↑ 23% ${e.thisMonth}`}),o.jsx($o,{icon:tn,label:e.activeProducts,value:"567",trend:`↑ 5% ${e.from} ${e.yesterday}`})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.latestSales}),o.jsx("p",{className:"text-gray-500 text-center py-8",children:e.noSalesData})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.topProducts}),o.jsx("p",{className:"text-gray-500 text-center py-8",children:e.noProductsData})]})]})]})}const $o=({icon:t,label:e,value:n,trend:s})=>o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e}),o.jsx("h3",{className:"text-2xl font-bold",children:n}),o.jsx("p",{className:"text-sm text-green-600 mt-1",children:s})]}),o.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:o.jsx(t,{className:"w-6 h-6 text-indigo-600"})})]})}),Vt={ar:{pointOfSale:"نقطة البيع",searchProduct:"ابحث عن منتج...",loading:"جاري التحميل...",retry:"إعادة المحاولة",errorLoadingProducts:"حدث خطأ أثناء تحميل المنتجات",errorLoadingBranches:"حدث خطأ أثناء تحميل الفروع",invalidBranch:"الفرع المحدد غير صالح",expiryDate:"تاريخ الانتهاء",inStock:"المتوفر",scanBarcode:"مسح الباركود",scannerActive:"وضع المسح نشط",enterManually:"أدخل الباركود يدوياً...",readyToScan:"جاهز للمسح...",cart:"سلة المشتريات",noItems:"لم يتم إضافة منتجات بعد",customerPhone:"رقم هاتف العميل...",customerName:"اسم العميل",search:"بحث",searching:"جاري البحث...",customerNotFound:"لم يتم العثور على العميل",addNewCustomer:"إضافة عميل جديد",guestCustomer:"عميل عابر",errorSearchingCustomer:"حدث خطأ أثناء البحث عن العميل",errorCreatingCustomer:"حدث خطأ أثناء إضافة العميل",discount:"الخصم",fixed:"ثابت",percentage:"نسبة",value:"القيمة...",apply:"تطبيق",coupon:"كوبون الخصم",enterCoupon:"أدخل رمز الكوبون...",total:"المجموع",checkout:"إتمام الشراء",addNotes:"إضافة ملاحظات",editNotes:"تعديل الملاحظات",removeFromCart:"إزالة من السلة",food:"طعام",product:"منتج",save:"حفظ",cancel:"إلغاء",currency:"ر.ع",subtotal:"المجموع الفرعي",tax:"الضريبة",discountApplied:"الخصم المطبق",discountExceedsTotal:"قيمة الخصم تتجاوز المجموع",invalidPercentage:"النسبة المئوية يجب أن تكون بين 0 و 100",invalidCoupon:"كوبون غير صالح",cartNotes:"ملاحظات الطلب",showNotes:"إظهار الملاحظات",hideNotes:"إخفاء الملاحظات",addCartNotes:"أضف ملاحظات للطلب...",paymentMethod:"طريقة الدفع",cashPayment:"نقدي",creditPayment:"بطاقة ائتمان",onlinePayment:"دفع إلكتروني",confirmPayment:"تأكيد الدفع",confirm:"تأكيد",processing:"جاري المعالجة...",confirmCheckout:"تأكيد عملية البيع",customer:"العميل",confirmCashMessage:"هل تم استلام المبلغ النقدي بالكامل؟",confirmCashRequired:"يجب تأكيد استلام النقد قبل إتمام العملية",allBranches:"جميع الفروع",selectBranch:"اختر الفرع",cashReceived:"المبلغ المستلم",changeDue:"المبلغ المتبقي",enterCashAmount:"أدخل المبلغ المستلم",insufficientCash:"المبلغ المستلم أقل من المطلوب",noBranchSelected:"يجب اختيار فرع أولاً",vendorProduct:"منتج مورد",shareToWhatsApp:"مشاركة الفاتورة عبر واتساب"},en:{pointOfSale:"Point of Sale",searchProduct:"Search for a product...",loading:"Loading...",retry:"Retry",errorLoadingProducts:"Error loading products",errorLoadingBranches:"Error loading branches",invalidBranch:"Selected branch is invalid",expiryDate:"Expiry Date",inStock:"In Stock",scanBarcode:"Scan Barcode",scannerActive:"Scanner Active",enterManually:"Enter barcode manually...",readyToScan:"Ready to scan...",cart:"Shopping Cart",noItems:"No items added yet",customerPhone:"Customer phone number...",customerName:"Customer Name",search:"Search",searching:"Searching...",customerNotFound:"Customer not found",addNewCustomer:"Add New Customer",guestCustomer:"Guest Customer",errorSearchingCustomer:"Error searching for customer",errorCreatingCustomer:"Error creating customer",discount:"Discount",fixed:"Fixed",percentage:"Percentage",value:"Value...",apply:"Apply",coupon:"Coupon",enterCoupon:"Enter coupon code...",total:"Total",checkout:"Checkout",addNotes:"Add Notes",editNotes:"Edit Notes",removeFromCart:"Remove from Cart",food:"Food",product:"Product",save:"Save",cancel:"Cancel",currency:"OMR",subtotal:"Subtotal",tax:"Tax",discountApplied:"Discount Applied",discountExceedsTotal:"Discount amount exceeds total",invalidPercentage:"Percentage must be between 0 and 100",invalidCoupon:"Invalid coupon",cartNotes:"Order Notes",showNotes:"Show Notes",hideNotes:"Hide Notes",addCartNotes:"Add notes to the order...",paymentMethod:"Payment Method",cashPayment:"Cash",creditPayment:"Credit Card",onlinePayment:"Online Payment",confirmPayment:"Confirm Payment",confirm:"Confirm",processing:"Processing...",confirmCheckout:"Confirm Checkout",customer:"Customer",confirmCashMessage:"Have you received the full cash amount?",confirmCashRequired:"You must confirm cash receipt before proceeding",allBranches:"All Branches",selectBranch:"Select Branch",cashReceived:"Cash Received",changeDue:"Change Due",enterCashAmount:"Enter received amount",insufficientCash:"Received amount is less than required",noBranchSelected:"Please select a branch first",vendorProduct:"Vendor Product",shareToWhatsApp:"Share Receipt via WhatsApp"}};function fS({onSubmit:t,onCancel:e,initialPhone:n}){const{language:s}=Y(),r=Vt[s],i=a=>{a.preventDefault();const l=new FormData(a.currentTarget);t({name:l.get("name"),phone:l.get("phone"),points:0})};return o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-xl font-semibold",children:r.addNewCustomer}),o.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-500",children:"×"})]}),o.jsxs("form",{onSubmit:i,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.customerName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"name",required:!0,autoFocus:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:s==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.customerPhone," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"tel",name:"phone",defaultValue:n,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:r.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:r.save})]})]})]})})}async function mS(t){const{data:e,error:n}=await V.from("customers").select("*").eq("business_code",t).order("customer_name",{ascending:!0});if(n)throw console.error("Error fetching customers:",n),n;return e||[]}async function pS(t,e){const{data:n,error:s}=await V.from("customers").select("*").eq("phone_number",t).eq("business_code",e).single();if(s){if(s.code==="PGRST116")return null;throw console.error("Error fetching customer:",s),s}return n}async function $0(t){const{data:e,error:n}=await V.from("customers").insert([{...t,number_of_orders:0}]).select().single();if(n)throw console.error("Error creating customer:",n),n;return e}async function gS(t,e){const{data:n,error:s}=await V.from("customers").update(e).eq("customer_id",t).select().single();if(s)throw console.error("Error updating customer:",s),s;return n}async function xS(t){const{error:e}=await V.from("customers").delete().eq("customer_id",t);if(e)throw console.error("Error deleting customer:",e),e;return!0}function yS({onCustomerSelect:t}){const{language:e}=Y(),{user:n}=ce(),s=Vt[e],[r,i]=w.useState(""),[a,l]=w.useState(!1),[c,d]=w.useState(!1),[u,h]=w.useState(!1),[f,m]=w.useState(null),x=async()=>{if(r){h(!0),m(null),l(!1);try{const y=await pS(r,n.businessCode);y?(t({id:y.customer_id,name:y.customer_name,phone:y.phone_number,points:0}),i("")):l(!0)}catch(y){console.error("Error searching customer:",y),m(s.errorSearchingCustomer)}finally{h(!1)}}},g=async y=>{try{m(null);const v=await $0({...y,business_code:n.businessCode,number_of_orders:0});t({id:v.customer_id,name:v.customer_name,phone:v.phone_number,points:0}),d(!1),l(!1),i("")}catch(v){console.error("Error creating customer:",v),m(s.errorCreatingCustomer)}};return o.jsxs("div",{className:"p-4 border-b",children:[o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"tel",placeholder:s.customerPhone,value:r,onChange:y=>i(y.target.value),onKeyDown:y=>y.key==="Enter"&&x(),className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:e==="ar"?"rtl":"ltr"})]}),o.jsx("button",{onClick:x,disabled:u||!r,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?s.searching:s.search})]}),f&&o.jsx("div",{className:"mt-2 text-sm text-red-600",children:f}),a&&o.jsxs("div",{className:"mt-2 flex items-center justify-between p-2 bg-yellow-50 rounded-md",children:[o.jsx("span",{className:"text-sm text-yellow-800",children:s.customerNotFound}),o.jsxs("button",{onClick:()=>d(!0),className:"flex items-center text-sm text-indigo-600 hover:text-indigo-800",children:[o.jsx(p1,{className:"w-4 h-4 ml-1"}),s.addNewCustomer]})]}),c&&o.jsx(fS,{onSubmit:g,onCancel:()=>d(!1),initialPhone:r})]})}function vS({onScan:t}){const{language:e}=Y(),n=Vt[e],[s,r]=w.useState(""),[i,a]=w.useState(!1),l=w.useRef(null);w.useEffect(()=>{const d=u=>{i&&(/[\w\d]/.test(u.key)&&u.key.length===1&&r(h=>h+u.key),u.key==="Enter"&&s&&(t(s),r("")))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[i,s,t]);const c=()=>{a(!i),!i&&l.current&&l.current.focus()};return o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("input",{ref:l,type:"text",value:s,onChange:d=>r(d.target.value),placeholder:i?n.readyToScan:n.enterManually,className:"flex-1 pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:e==="ar"?"rtl":"ltr"}),o.jsx("button",{onClick:c,className:`px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${i?"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500":"bg-gray-200 text-gray-700 hover:bg-gray-300 focus:ring-gray-500"}`,children:o.jsx(c1,{className:"w-5 h-5"})})]}),i&&o.jsx("div",{className:"absolute -bottom-6 right-0 text-sm text-green-600",children:n.scannerActive})]})}function bS({item:t,onUpdateQuantity:e,onUpdateNotes:n,onRemove:s}){const{language:r}=Y(),i=Vt[r],[a,l]=w.useState(!!t.notes);return o.jsxs("div",{className:"border-b last:border-b-0 py-2",dir:r==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-medium text-sm",children:t.nameAr}),o.jsxs("p",{className:"text-xs text-gray-500",children:[t.price.toFixed(3)," ",i.currency,t.vendorPrice&&o.jsxs("span",{className:"text-xs text-gray-400 mr-1",children:["(",i.originalPrice,": ",t.vendorPrice.toFixed(3)," ",i.currency,")"]})]}),t.notes&&!a&&o.jsx("div",{className:"mt-1 text-xs text-gray-500 bg-gray-50 p-1 rounded-md",children:o.jsx("p",{className:"line-clamp-2",children:t.notes})})]}),o.jsxs("div",{className:"flex items-start space-x-1 space-x-reverse mr-2",children:[o.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[o.jsx("button",{onClick:()=>e(t.id,Math.max(0,t.quantity-1)),className:"w-5 h-5 flex items-center justify-center border rounded hover:bg-gray-100 text-sm",children:"-"}),o.jsx("span",{className:"w-6 text-center text-sm",children:t.quantity}),o.jsx("button",{onClick:()=>e(t.id,t.quantity+1),className:"w-5 h-5 flex items-center justify-center border rounded hover:bg-gray-100 text-sm",children:"+"})]}),o.jsx("button",{onClick:()=>l(!a),className:`text-gray-500 hover:text-gray-700 ${a||t.notes?"bg-gray-100 rounded-full p-1":""} ${t.notes?"text-indigo-600":""}`,title:t.notes?i.editNotes:i.addNotes,children:o.jsx(n0,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>s(t.id),className:"text-red-500 hover:text-red-700",title:i.removeFromCart,children:o.jsx(f1,{className:"w-4 h-4"})})]})]}),a&&o.jsx("div",{className:"mt-1",children:o.jsx("textarea",{value:t.notes??"",onChange:c=>n(t.id,c.target.value),placeholder:i.addNotes,className:"w-full p-1 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-xs resize-none",rows:1,dir:r==="ar"?"rtl":"ltr"})})]})}function wS({total:t,subtotal:e,discount:n,taxAmount:s,paymentMethod:r,customer:i,settings:a,cart:l,receiptId:c,branchName:d,cashierName:u,couponCode:h,notes:f,onConfirm:m,onCancel:x}){const{language:g}=Y(),y=Vt[g],[v,p]=w.useState(!1),[b,j]=w.useState(t.toFixed(3)),[_,C]=w.useState(0),[S,k]=w.useState(null),A=B=>{j(B),k(null);const E=parseFloat(B);!isNaN(E)&&E>=t?C(E-t):C(0)},P=B=>`968${B.replace(/\D/g,"").slice(-8)}`,D=()=>{var U,K;if(!(i!=null&&i.phone))return;const B=(a==null?void 0:a.business_name)||"",E=((U=a==null?void 0:a.receipt_header)==null?void 0:U.trim().split(`
`).join(`
   `))||"",T=((K=a==null?void 0:a.receipt_footer)==null?void 0:K.trim().split(`
`).join(`
   `))||"",N=[`🏪 *${B||"My Store"}*
`,E?["","   "+E,""].join(`
`):"","🧾 *فاتورة المشتريات / Purchase Receipt*",`📅 ${new Date().toLocaleDateString("ar")}`,`🏷️ #${c}`,`🏬 ${d}`,`👤 ${u}`,"",i?["👥 *العميل / Customer*",`   ${i.name}`,`   📱 ${i.phone}`,""].join(`
`):"","🛍️ *المنتجات / Items*",l.map(G=>`   ${G.nameAr}
   ${G.quantity} x ${G.price.toFixed(3)} = ${(G.quantity*G.price).toFixed(3)} ${y.currency}`).join(`

`),"","💰 *الحساب / Bill*",`   المجموع الفرعي / Subtotal: ${e.toFixed(3)} ${y.currency}`,n>0?`   الخصم / Discount: -${n.toFixed(3)} ${y.currency}`:"",h?`   🎟️ ${h}`:"",a!=null&&a.tax_enabled?`   الضريبة / Tax (${a.tax_rate}%): ${s.toFixed(3)} ${y.currency}`:"","",`💵 *المجموع النهائي / Total:* ${t.toFixed(3)} ${y.currency}`,`💳 *طريقة الدفع / Payment:* ${r==="cash"?"نقدي / Cash":r==="credit"?"بطاقة / Card":"دفع إلكتروني / Online"}`,f?["","📝 *ملاحظات / Notes*",`   ${f}`].join(`
`):"","",T?["",T.split(`
`).map(G=>"   "+G).join(`
`),""].join(`
`):"","","🙏 *شكراً لتسوقكم معنا*","*Thank you for shopping with us*"].join(`
`),R=P(i.phone),O=encodeURIComponent(N),z=`https://web.whatsapp.com/send?phone=${R}&text=${O}`;console.log("WhatsApp Message Preview:",N),window.open(z,"_blank")},M=()=>{if(r==="cash"&&!v){alert(y.confirmCashRequired);return}if(r==="cash"){const B=parseFloat(b);if(isNaN(B)||B<t){k(y.insufficientCash);return}}m()};return o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:y.confirmPayment}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("span",{className:"text-gray-700",children:[y.total,":"]}),o.jsxs("span",{className:"text-xl font-bold",children:[t.toFixed(3)," ",y.currency]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("span",{className:"text-gray-700",children:[y.paymentMethod,":"]}),o.jsx("span",{className:"font-medium",children:r==="cash"?y.cashPayment:r==="credit"?y.creditPayment:y.onlinePayment})]}),(i==null?void 0:i.phone)&&o.jsx("div",{className:"mt-4 border-t pt-4",children:o.jsxs("button",{onClick:D,className:"flex items-center justify-center w-full px-4 py-2 text-sm text-green-600 border border-green-600 rounded-md hover:bg-green-50 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:[o.jsx(d1,{className:"w-4 h-4 ml-2"}),y.shareToWhatsApp]})}),r==="cash"&&o.jsxs("div",{className:"space-y-4 border-t pt-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:y.cashReceived}),o.jsx("input",{type:"number",value:b,onChange:B=>A(B.target.value),min:t,step:"0.001",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),S&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:S})]}),_>0&&o.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[o.jsxs("span",{children:[y.changeDue,":"]}),o.jsxs("span",{className:"text-green-600",children:[_.toFixed(3)," ",y.currency]})]}),o.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("input",{type:"checkbox",checked:v,onChange:B=>p(B.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:y.confirmCashMessage})]})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse pt-4 border-t",children:[o.jsx("button",{onClick:x,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:y.cancel}),o.jsx("button",{onClick:M,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:y.confirm})]})]})]})})}function _S({notes:t,onNotesChange:e}){const{language:n}=Y(),s=Vt[n],[r,i]=w.useState(!!t);return o.jsxs("div",{className:"border-t p-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(n0,{className:"w-4 h-4 text-gray-500"}),o.jsx("span",{className:"font-medium text-sm",children:s.cartNotes})]}),o.jsx("button",{onClick:()=>i(!r),className:`text-xs text-indigo-600 hover:text-indigo-800 ${r?"font-medium":""}`,children:r?s.hideNotes:s.showNotes})]}),r&&o.jsx("textarea",{value:t,onChange:a=>e(a.target.value),placeholder:s.addCartNotes,rows:2,className:"w-full p-1 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-xs resize-none",dir:n==="ar"?"rtl":"ltr"})]})}function jS({subtotal:t,onApplyDiscount:e,onApplyCoupon:n,appliedDiscount:s,appliedCoupon:r,error:i}){const{language:a}=Y(),{settings:l}=_n(),c=Vt[a],[d,u]=w.useState((s==null?void 0:s.type)||"fixed"),[h,f]=w.useState((s==null?void 0:s.value.toString())||""),[m,x]=w.useState(""),g=()=>{if(h){const v=parseFloat(h);if(d==="percentage"&&v>100||d==="fixed"&&v>t)return;e({type:d,value:v})}},y=()=>{if(!s)return null;const v=s.value;return s.type==="fixed"?`${v.toFixed(3)} ${c.currency}`:`${v}%`};return o.jsxs("div",{className:"border-t p-2 space-y-2",dir:a==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(i0,{className:"w-4 h-4 text-gray-500"}),o.jsx("span",{className:"font-medium text-sm",children:c.discount}),s&&o.jsx("span",{className:"text-sm text-green-600",children:y()})]}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsxs("select",{value:d,onChange:v=>u(v.target.value),className:"w-1/3 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm py-1",children:[o.jsx("option",{value:"fixed",children:c.fixed}),o.jsx("option",{value:"percentage",children:c.percentage})]}),o.jsx("input",{type:"number",value:h,onChange:v=>f(v.target.value),placeholder:c.value,min:"0",max:d==="percentage"?"100":void 0,step:d==="percentage"?"1":"0.001",className:"flex-1 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm py-1"}),o.jsx("button",{onClick:g,className:"px-3 py-1 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 text-sm",children:c.apply})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(o0,{className:"w-4 h-4 text-gray-500"}),o.jsx("span",{className:"font-medium text-sm",children:c.coupon}),r&&o.jsx("span",{className:"text-sm text-green-600",children:r})]}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("input",{type:"text",value:m,onChange:v=>x(v.target.value),placeholder:c.enterCoupon,className:"flex-1 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm py-1"}),o.jsx("button",{onClick:()=>n(m),className:"px-3 py-1 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 text-sm",children:c.apply})]}),i&&o.jsx("p",{className:"text-xs text-red-600 mt-1",children:i})]}),(l==null?void 0:l.tax_enabled)&&o.jsx("div",{className:"pt-2 border-t",children:o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[c.tax," (",l.tax_rate,"%)"]}),o.jsxs("span",{children:[(t*l.tax_rate/100).toFixed(3)," ",c.currency]})]})})]})}function NS({selectedMethod:t,onMethodChange:e}){const{language:n}=Y(),s=Vt[n],r=[{id:"cash",icon:q_,label:s.cashPayment},{id:"card",icon:Z_,label:s.creditPayment},{id:"online",icon:e0,label:s.onlinePayment}];return o.jsxs("div",{className:"border-t p-2",children:[o.jsx("h3",{className:"font-medium mb-2 text-sm",children:s.paymentMethod}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.map(({id:i,icon:a,label:l})=>o.jsxs("button",{onClick:()=>e(i),className:`flex flex-col items-center justify-center p-3 rounded-lg border-2 transition-colors ${t===i?"border-indigo-600 bg-indigo-50 text-indigo-600":"border-gray-200 hover:border-indigo-200"}`,children:[o.jsx(a,{className:"w-5 h-5 mb-1"}),o.jsx("span",{className:"text-xs",children:l})]},i))})]})}function SS({onBranchChange:t}){const{language:e}=Y(),{user:n}=ce(),{branches:s,getCurrentBranch:r,setSelectedBranch:i}=Ze(),a=Vt[e],[l,c]=w.useState(""),[d,u]=w.useState(!1);w.useEffect(()=>{(()=>{if(!d&&s.length>0){if((n==null?void 0:n.role)==="cashier"){const m=r();m&&(c(m.branch_id),t(m.branch_id),i(m.branch_id))}else{const m=s.find(x=>x.is_active);m&&(c(m.branch_id),t(m.branch_id),i(m.branch_id))}u(!0)}})()},[s,d,t,n==null?void 0:n.role,r,i]);const h=f=>{c(f),t(f),i(f)};return o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(Be,{className:"w-5 h-5 text-gray-400"}),o.jsxs("select",{value:l,onChange:f=>h(f.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:e==="ar"?"rtl":"ltr",required:!0,children:[!l&&o.jsx("option",{value:"",children:a.selectBranch}),s.filter(f=>f.is_active).map(f=>o.jsx("option",{value:f.branch_id,children:f.branch_name},f.branch_id))]})]})}async function kS(t){const{data:e,error:n}=await V.from("transactions_overall").insert([{...t,details:JSON.stringify(t.details),transaction_date:t.transaction_date||new Date().toISOString()}]).select().single();if(n)throw console.error("Error creating transaction:",n),n;return{...e,details:JSON.parse(e.details)}}function CS(){const{user:t}=ce(),{getCurrentBranch:e}=Ze(),{settings:n}=_n(),[s,r]=w.useState(!1),[i,a]=w.useState(null);return{processTransaction:async(c,d,u,h,f,m)=>{if(!t||!n)return a("Missing user or settings data"),null;const x=e();if(!x)return a("No branch selected"),null;try{r(!0),a(null);const g=c.reduce((k,A)=>k+A.price*A.quantity,0),y=n.tax_enabled?g*n.tax_rate/100:0,v=g+y-h,p=new Map;c.forEach(k=>{if(k.vendorId){const A=p.get(k.vendorId)||[];A.push(k),p.set(k.vendorId,A)}});let b=0;const j=new Map;n.vendor_commission_enabled&&p.forEach((k,A)=>{const P=k.reduce((D,M)=>{const B=M.vendorPrice?(M.price-M.vendorPrice)*M.quantity:0;return D+B},0);if(P>=n.minimum_commission_amount){const D=P*(n.default_commission_rate/100);j.set(A,D),b+=D}});const _={products:c.map(k=>({id:k.id,name:k.nameAr,quantity:k.quantity,price:k.price,total:k.price*k.quantity,vendorPrice:k.vendorPrice,vendorId:k.vendorId})),customer:d?{id:d.id,name:d.name,phone:d.phone}:void 0,notes:m,discount:h,tax:y,vendorCommissions:Object.fromEntries(j),totalCommission:b},C={business_code:t.businessCode,business_name:n.business_name||"",branch_name:x.branch_name,payment_method:u,transaction_type:"sale",transaction_reason:"Regular sale",amount:v,currency:"OMR",transaction_date:new Date().toISOString(),details:_};return await kS(C)}catch(g){return console.error("Error processing transaction:",g),a(g instanceof Error?g.message:"Failed to process transaction"),null}finally{r(!1)}},isProcessing:s,error:i}}function Xe(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Zn(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function PS(t,e){const n=Xe(t);return isNaN(e)?Zn(t,NaN):(n.setDate(n.getDate()+e),n)}const z0=6048e5,ES=864e5;let MS={};function Ll(){return MS}function Xi(t,e){var l,c,d,u;const n=Ll(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,r=Xe(t),i=r.getDay(),a=(i<s?7:0)+i-s;return r.setDate(r.getDate()-a),r.setHours(0,0,0,0),r}function Qa(t){return Xi(t,{weekStartsOn:1})}function U0(t){const e=Xe(t),n=e.getFullYear(),s=Zn(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const r=Qa(s),i=Zn(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const a=Qa(i);return e.getTime()>=r.getTime()?n+1:e.getTime()>=a.getTime()?n:n-1}function Ga(t){const e=Xe(t);return e.setHours(0,0,0,0),e}function nm(t){const e=Xe(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function TS(t,e){const n=Ga(t),s=Ga(e),r=+n-nm(n),i=+s-nm(s);return Math.round((r-i)/ES)}function OS(t){const e=U0(t),n=Zn(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Qa(n)}function AS(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function RS(t){if(!AS(t)&&typeof t!="number")return!1;const e=Xe(t);return!isNaN(Number(e))}function V0(t,e){const n=Xe(t.start),s=Xe(t.end);let r=+n>+s;const i=r?+n:+s,a=r?s:n;a.setHours(0,0,0,0);let l=1;const c=[];for(;+a<=i;)c.push(Xe(a)),a.setDate(a.getDate()+l),a.setHours(0,0,0,0);return r?c.reverse():c}function DS(t){const e=Xe(t),n=Zn(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}const IS={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},LS=(t,e,n)=>{let s;const r=IS[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function cr(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const FS={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},BS={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},$S={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zS={date:cr({formats:FS,defaultWidth:"full"}),time:cr({formats:BS,defaultWidth:"full"}),dateTime:cr({formats:$S,defaultWidth:"full"})},US={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},VS=(t,e,n,s)=>US[t];function Jt(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,l=n!=null&&n.width?String(n.width):a;r=t.formattingValues[l]||t.formattingValues[a]}else{const a=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;r=t.values[l]||t.values[a]}const i=t.argumentCallback?t.argumentCallback(e):e;return r[i]}}const WS={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},HS={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qS={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},YS={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},QS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},GS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},KS=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},JS={ordinalNumber:KS,era:Jt({values:WS,defaultWidth:"wide"}),quarter:Jt({values:HS,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Jt({values:qS,defaultWidth:"wide"}),day:Jt({values:YS,defaultWidth:"wide"}),dayPeriod:Jt({values:QS,defaultWidth:"wide",formattingValues:GS,defaultFormattingWidth:"wide"})};function Xt(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(r);if(!i)return null;const a=i[0],l=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?ZS(l,h=>h.test(a)):XS(l,h=>h.test(a));let d;d=t.valueCallback?t.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const u=e.slice(a.length);return{value:d,rest:u}}}function XS(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function ZS(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function W0(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],i=e.match(t.parsePattern);if(!i)return null;let a=t.valueCallback?t.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const l=e.slice(r.length);return{value:a,rest:l}}}const e2=/^(\d+)(th|st|nd|rd)?/i,t2=/\d+/i,n2={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},s2={any:[/^b/i,/^(a|c)/i]},r2={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},i2={any:[/1/i,/2/i,/3/i,/4/i]},o2={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},a2={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},l2={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},c2={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},d2={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},u2={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},h2={ordinalNumber:W0({matchPattern:e2,parsePattern:t2,valueCallback:t=>parseInt(t,10)}),era:Xt({matchPatterns:n2,defaultMatchWidth:"wide",parsePatterns:s2,defaultParseWidth:"any"}),quarter:Xt({matchPatterns:r2,defaultMatchWidth:"wide",parsePatterns:i2,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Xt({matchPatterns:o2,defaultMatchWidth:"wide",parsePatterns:a2,defaultParseWidth:"any"}),day:Xt({matchPatterns:l2,defaultMatchWidth:"wide",parsePatterns:c2,defaultParseWidth:"any"}),dayPeriod:Xt({matchPatterns:d2,defaultMatchWidth:"any",parsePatterns:u2,defaultParseWidth:"any"})},Fl={code:"en-US",formatDistance:LS,formatLong:zS,formatRelative:VS,localize:JS,match:h2,options:{weekStartsOn:0,firstWeekContainsDate:1}};function f2(t){const e=Xe(t);return TS(e,DS(e))+1}function m2(t){const e=Xe(t),n=+Qa(e)-+OS(e);return Math.round(n/z0)+1}function H0(t,e){var u,h,f,m;const n=Xe(t),s=n.getFullYear(),r=Ll(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(f=r.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,a=Zn(t,0);a.setFullYear(s+1,0,i),a.setHours(0,0,0,0);const l=Xi(a,e),c=Zn(t,0);c.setFullYear(s,0,i),c.setHours(0,0,0,0);const d=Xi(c,e);return n.getTime()>=l.getTime()?s+1:n.getTime()>=d.getTime()?s:s-1}function p2(t,e){var l,c,d,u;const n=Ll(),s=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,r=H0(t,e),i=Zn(t,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),Xi(i,e)}function g2(t,e){const n=Xe(t),s=+Xi(n,e)-+p2(n,e);return Math.round(s/z0)+1}function oe(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const Nn={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return oe(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):oe(n+1,2)},d(t,e){return oe(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return oe(t.getHours()%12||12,e.length)},H(t,e){return oe(t.getHours(),e.length)},m(t,e){return oe(t.getMinutes(),e.length)},s(t,e){return oe(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return oe(r,e.length)}},zs={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},sm={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return Nn.y(t,e)},Y:function(t,e,n,s){const r=H0(t,s),i=r>0?r:1-r;if(e==="YY"){const a=i%100;return oe(a,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):oe(i,e.length)},R:function(t,e){const n=U0(t);return oe(n,e.length)},u:function(t,e){const n=t.getFullYear();return oe(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return oe(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return oe(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return Nn.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return oe(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=g2(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):oe(r,e.length)},I:function(t,e,n){const s=m2(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):oe(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Nn.d(t,e)},D:function(t,e,n){const s=f2(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):oe(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return oe(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return oe(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return oe(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=zs.noon:s===0?r=zs.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=zs.evening:s>=12?r=zs.afternoon:s>=4?r=zs.morning:r=zs.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Nn.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Nn.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):oe(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):oe(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Nn.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Nn.s(t,e)},S:function(t,e){return Nn.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return im(s);case"XXXX":case"XX":return fs(s);case"XXXXX":case"XXX":default:return fs(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return im(s);case"xxxx":case"xx":return fs(s);case"xxxxx":case"xxx":default:return fs(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+rm(s,":");case"OOOO":default:return"GMT"+fs(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+rm(s,":");case"zzzz":default:return"GMT"+fs(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return oe(s,e.length)},T:function(t,e,n){const s=t.getTime();return oe(s,e.length)}};function rm(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+e+oe(i,2)}function im(t,e){return t%60===0?(t>0?"-":"+")+oe(Math.abs(t)/60,2):fs(t,e)}function fs(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=oe(Math.trunc(s/60),2),i=oe(s%60,2);return n+r+e+i}const om=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},q0=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},x2=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return om(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",om(s,e)).replace("{{time}}",q0(r,e))},y2={p:q0,P:x2},v2=/^D+$/,b2=/^Y+$/,w2=["D","DD","YY","YYYY"];function _2(t){return v2.test(t)}function j2(t){return b2.test(t)}function N2(t,e,n){const s=S2(t,e,n);if(console.warn(s),w2.includes(t))throw new RangeError(s)}function S2(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const k2=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,C2=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,P2=/^'([^]*?)'?$/,E2=/''/g,M2=/[a-zA-Z]/;function Fn(t,e,n){var u,h,f,m,x,g,y,v;const s=Ll(),r=(n==null?void 0:n.locale)??s.locale??Fl,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((g=(x=n==null?void 0:n.locale)==null?void 0:x.options)==null?void 0:g.weekStartsOn)??s.weekStartsOn??((v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??0,l=Xe(t);if(!RS(l))throw new RangeError("Invalid time value");let c=e.match(C2).map(p=>{const b=p[0];if(b==="p"||b==="P"){const j=y2[b];return j(p,r.formatLong)}return p}).join("").match(k2).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const b=p[0];if(b==="'")return{isToken:!1,value:T2(p)};if(sm[b])return{isToken:!0,value:p};if(b.match(M2))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:p}});r.localize.preprocessor&&(c=r.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:a,locale:r};return c.map(p=>{if(!p.isToken)return p.value;const b=p.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&j2(b)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&_2(b))&&N2(b,e,String(t));const j=sm[b[0]];return j(l,b,r.localize,d)}).join("")}function T2(t){const e=t.match(P2);return e?e[1].replace(E2,"'"):t}function Y0(t,e){return PS(t,-e)}const O2={lessThanXSeconds:{one:"أقل من ثانية واحدة",two:"أقل من ثانتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية واحدة",two:"ثانتين",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نصف دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقائق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة واحدة",two:"دقيقتين",threeToTen:"{{count}} دقائق",other:"{{count}} دقيقة"},aboutXHours:{one:"ساعة واحدة تقريباً",two:"ساعتين تقريباً",threeToTen:"{{count}} ساعات تقريباً",other:"{{count}} ساعة تقريباً"},xHours:{one:"ساعة واحدة",two:"ساعتين",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم واحد",two:"يومين",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"أسبوع واحد تقريباً",two:"أسبوعين تقريباً",threeToTen:"{{count}} أسابيع تقريباً",other:"{{count}} أسبوع تقريباً"},xWeeks:{one:"أسبوع واحد",two:"أسبوعين",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوع"},aboutXMonths:{one:"شهر واحد تقريباً",two:"شهرين تقريباً",threeToTen:"{{count}} أشهر تقريباً",other:"{{count}} شهر تقريباً"},xMonths:{one:"شهر واحد",two:"شهرين",threeToTen:"{{count}} أشهر",other:"{{count}} شهر"},aboutXYears:{one:"عام واحد تقريباً",two:"عامين تقريباً",threeToTen:"{{count}} أعوام تقريباً",other:"{{count}} عام تقريباً"},xYears:{one:"عام واحد",two:"عامين",threeToTen:"{{count}} أعوام",other:"{{count}} عام"},overXYears:{one:"أكثر من عام",two:"أكثر من عامين",threeToTen:"أكثر من {{count}} أعوام",other:"أكثر من {{count}} عام"},almostXYears:{one:"عام واحد تقريباً",two:"عامين تقريباً",threeToTen:"{{count}} أعوام تقريباً",other:"{{count}} عام تقريباً"}},A2=(t,e,n)=>{let s;const r=O2[t];return typeof r=="string"?s=r:e===1?s=r.one:e===2?s=r.two:e<=10?s=r.threeToTen.replace("{{count}}",String(e)):s=r.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"في خلال "+s:"منذ "+s:s},R2={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},D2={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},I2={full:"{{date}} 'عند' {{time}}",long:"{{date}} 'عند' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},L2={date:cr({formats:R2,defaultWidth:"full"}),time:cr({formats:D2,defaultWidth:"full"}),dateTime:cr({formats:I2,defaultWidth:"full"})},F2={lastWeek:"'أخر' eeee 'عند' p",yesterday:"'أمس عند' p",today:"'اليوم عند' p",tomorrow:"'غداً عند' p",nextWeek:"eeee 'عند' p",other:"P"},B2=(t,e,n,s)=>F2[t],$2={narrow:["ق","ب"],abbreviated:["ق.م.","ب.م."],wide:["قبل الميلاد","بعد الميلاد"]},z2={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},U2={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["ينا","فبر","مارس","أبريل","مايو","يونـ","يولـ","أغسـ","سبتـ","أكتـ","نوفـ","ديسـ"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},V2={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنـ","ثلا","أربـ","خميـ","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},W2={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءاً",night:"ليلاً"}},H2={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"في الصباح",afternoon:"بعد الظـهر",evening:"في المساء",night:"في الليل"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهر",morning:"صباحاً",afternoon:"بعد الظـهر",evening:"في المساء",night:"في الليل"}},q2=t=>String(t),Y2={ordinalNumber:q2,era:Jt({values:$2,defaultWidth:"wide"}),quarter:Jt({values:z2,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Jt({values:U2,defaultWidth:"wide"}),day:Jt({values:V2,defaultWidth:"wide"}),dayPeriod:Jt({values:W2,defaultWidth:"wide",formattingValues:H2,defaultFormattingWidth:"wide"})},Q2=/^(\d+)(th|st|nd|rd)?/i,G2=/\d+/i,K2={narrow:/^(ق|ب)/i,abbreviated:/^(ق\.?\s?م\.?|ق\.?\s?م\.?\s?|a\.?\s?d\.?|c\.?\s?)/i,wide:/^(قبل الميلاد|قبل الميلاد|بعد الميلاد|بعد الميلاد)/i},J2={any:[/^قبل/i,/^بعد/i]},X2={narrow:/^[1234]/i,abbreviated:/^ر[1234]/i,wide:/^الربع [1234]/i},Z2={any:[/1/i,/2/i,/3/i,/4/i]},ek={narrow:/^[يفمأمسند]/i,abbreviated:/^(ين|ف|مار|أب|ماي|يون|يول|أغ|س|أك|ن|د)/i,wide:/^(ين|ف|مار|أب|ماي|يون|يول|أغ|س|أك|ن|د)/i},tk={narrow:[/^ي/i,/^ف/i,/^م/i,/^أ/i,/^م/i,/^ي/i,/^ي/i,/^أ/i,/^س/i,/^أ/i,/^ن/i,/^د/i],any:[/^ين/i,/^ف/i,/^مار/i,/^أب/i,/^ماي/i,/^يون/i,/^يول/i,/^أغ/i,/^س/i,/^أك/i,/^ن/i,/^د/i]},nk={narrow:/^[حنثرخجس]/i,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,abbreviated:/^(أحد|اثن|ثلا|أرب|خمي|جمعة|سبت)/i,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/i},sk={narrow:[/^ح/i,/^ن/i,/^ث/i,/^ر/i,/^خ/i,/^ج/i,/^س/i],wide:[/^الأحد/i,/^الاثنين/i,/^الثلاثاء/i,/^الأربعاء/i,/^الخميس/i,/^الجمعة/i,/^السبت/i],any:[/^أح/i,/^اث/i,/^ث/i,/^أر/i,/^خ/i,/^ج/i,/^س/i]},rk={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ik={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ok={ordinalNumber:W0({matchPattern:Q2,parsePattern:G2,valueCallback:t=>parseInt(t,10)}),era:Xt({matchPatterns:K2,defaultMatchWidth:"wide",parsePatterns:J2,defaultParseWidth:"any"}),quarter:Xt({matchPatterns:X2,defaultMatchWidth:"wide",parsePatterns:Z2,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Xt({matchPatterns:ek,defaultMatchWidth:"wide",parsePatterns:tk,defaultParseWidth:"any"}),day:Xt({matchPatterns:nk,defaultMatchWidth:"wide",parsePatterns:sk,defaultParseWidth:"any"}),dayPeriod:Xt({matchPatterns:rk,defaultMatchWidth:"any",parsePatterns:ik,defaultParseWidth:"any"})},Xu={code:"ar-SA",formatDistance:A2,formatLong:L2,formatRelative:B2,localize:Y2,match:ok,options:{weekStartsOn:0,firstWeekContainsDate:1}};async function ak(t,e,n,s="ar"){const a=Fn(new Date,"PPpp",{locale:s==="ar"?Xu:Fl}),{data:l,error:c}=await V.from("business_settings").select("receipt_header, receipt_footer").eq("business_code_",t.business_code).single();c&&console.error("Error fetching business settings:",c);const d=[`🏪 ${(l==null?void 0:l.business_name)||""}`,(l==null?void 0:l.receipt_header)||"","",`📅 ${a}`,`🏷️ ${e}`,`🏬 ${t.branch_name}`,`👤 ${t.cashier_name}`,""];return(t.customer_name||t.customer_phone)&&(d.push("👥 العميل / Customer"),t.customer_name&&d.push(`   ${t.customer_name}`),t.customer_phone&&d.push(`   📱 ${t.customer_phone}`),d.push("")),d.push("🛍️ المنتجات / Items"),t.cart_items.forEach(u=>{d.push(`   ${u.nameAr}`),d.push(`   ${u.quantity} x ${u.price.toFixed(3)} = ${(u.quantity*u.price).toFixed(3)} ${s==="ar"?"ر.ع":"OMR"}`),u.notes&&d.push(`   📝 ${u.notes}`),d.push("")}),d.push("💰 الحساب / Bill"),d.push(`   المجموع الفرعي / Subtotal: ${t.total_amount.toFixed(3)} ${s==="ar"?"ر.ع":"OMR"}`),t.discount>0&&d.push(`   الخصم / Discount: -${t.discount.toFixed(3)} ${s==="ar"?"ر.ع":"OMR"}`),t.coupon_code&&d.push(`   🎟️ ${t.coupon_code}`),t.tax_amount>0&&d.push(`   الضريبة / Tax: ${t.tax_amount.toFixed(3)} ${s==="ar"?"ر.ع":"OMR"}`),d.push(""),d.push(`💵 المجموع النهائي / Total: ${t.total_amount.toFixed(3)} ${s==="ar"?"ر.ع":"OMR"}`),d.push(`💳 ${t.payment_method==="cash"?"نقدي / Cash":t.payment_method==="card"?"بطاقة / Card":"دفع إلكتروني / Online"}`),t.receipt_note&&(d.push(""),d.push("📝 ملاحظات / Notes"),d.push(`   ${t.receipt_note}`)),d.push(""),d.push("🙏 شكراً لتسوقكم معنا"),d.push("Thank you for shopping with us"),l!=null&&l.receipt_footer&&(d.push(""),d.push(l.receipt_footer)),d.join(`
`)}async function lk(t){const e=`RCP${Math.random().toString(36).substring(2,10).toUpperCase()}`,n=`TRX${Math.random().toString(36).substring(2,10).toUpperCase()}`,s=await ak(t,e),r={receipt_id:e,transaction_id:n,business_code:t.business_code,branch_name:t.branch_name,cashier_name:t.cashier_name,customer_name:t.customer_name,customer_phone:t.customer_phone,total_amount:t.total_amount,payment_method:t.payment_method,discount:t.discount,coupon_code:t.coupon_code,receipt_note:t.receipt_note,tax_amount:t.tax_amount,commission_amount_from_vendors:t.commission_amount_from_vendors,vendor_commission_enabled:t.vendor_commission_enabled,is_return:!1,receipt_date:new Date().toISOString(),long_text_receipt:s},{data:i,error:a}=await V.from("receipts").insert([r]).select().single();if(a)throw console.error("Error creating receipt:",a),a;return i}async function ck(t,e,n,s,r,i,a){const l=e.map(u=>{const f=!!u.vendorId?u.vendorPrice:null,m=u.price;return{sold_product_id:crypto.randomUUID(),receipt_id:t,product_name:u.nameAr,quantity:u.quantity,unit_price_original:f||m,unit_price_by_bussniess:f?m:null,total_price:m*u.quantity,vendor_code_if_by_vendor:u.vendorId||null,business_code:n,business_bracnh_name:s,comission_for_bussnies_from_vendor:dk(u,r,i,a)}}),{data:c,error:d}=await V.from("sold_products").insert(l).select();if(d)throw console.error("Error creating sold products:",d),d;return c||[]}function dk(t,e,n,s){return!e||!t.vendorId||!t.vendorPrice?null:t.vendorPrice*t.quantity<s?0:(t.price-t.vendorPrice)*t.quantity*n/100}function uk(){const{user:t}=ce(),{getCurrentBranch:e}=Ze(),{settings:n}=_n(),{language:s}=Y(),r=Vt[s],{processTransaction:i}=CS(),[a,l]=w.useState(!1),[c,d]=w.useState(null),[u,h]=w.useState(null);return{processReceipt:async(m,x,g,y,v,p)=>{if(!t||!n)return d("Missing user or settings data"),null;const b=e();if(!b)return d(r.noBranchSelected),null;try{l(!0),d(null);const j=await i(m,x,g,y,v,p);if(!j)throw new Error("Failed to process transaction");const _=m.reduce((M,B)=>M+B.price*B.quantity,0),C=n.tax_enabled?_*n.tax_rate/100:0;let S=0;if(n.vendor_commission_enabled){const B=m.filter(E=>E.vendorId).reduce((E,T)=>E+T.price*T.quantity,0);B>=n.minimum_commission_amount&&(S=B*(n.default_commission_rate/100))}const k=_+C-y,A={business_code:t.businessCode,branch_name:b.branch_name,cashier_name:t.name,customer_name:x==null?void 0:x.name,customer_phone:x==null?void 0:x.phone,total_amount:k,payment_method:g,discount:y,coupon_code:v,receipt_note:p,tax_amount:C,commission_amount_from_vendors:S,vendor_commission_enabled:n.vendor_commission_enabled,cart_items:m},P=await lk(A),D=await ck(P.receipt_id,m,t.businessCode,b.branch_name,n.vendor_commission_enabled,n.default_commission_rate,n.minimum_commission_amount);return console.log("Transaction processed:",j),console.log("Receipt created:",P),console.log("Sold products created:",D),P.long_text_receipt&&h(P.long_text_receipt),P}catch(j){return console.error("Error processing receipt:",j),d(j instanceof Error?j.message:"Failed to process receipt"),null}finally{l(!1)}},isProcessing:a,error:c,receiptText:u}}function hk(){return`CSH${Math.random().toString(36).substring(2,10).toUpperCase()}`}async function Q0(t){const n={tracking_id:hk(),business_code:t.business_code,business_branch_name:t.business_branch_name,cashier_name:t.cashier_name||null,previous_total_cash:t.previous_total_cash,new_total_cash:t.new_total_cash,cash_additions:t.cash_additions||0,cash_removals:t.cash_removals||0,cash_change_reason:t.cash_change_reason||null,total_returns:t.total_returns||0,transaction_date:new Date().toISOString().split("T")[0]},{data:s,error:r}=await V.from("cash_tracking").insert([n]).select().single();if(r)throw console.error("Error creating cash tracking record:",r),r;return s}async function fk(t,e){let n=V.from("cash_tracking").select("*").eq("business_code",t);e&&(e.branchName&&(n=n.eq("business_branch_name",e.branchName)),e.startDate&&(n=n.gte("transaction_date",e.startDate)),e.endDate&&(n=n.lte("transaction_date",e.endDate)),e.cashierName&&(n=n.eq("cashier_name",e.cashierName)));const{data:s,error:r}=await n.order("created_at",{ascending:!1});if(r)throw console.error("Error fetching cash tracking records:",r),r;return s||[]}async function G0(t,e){const{data:n,error:s}=await V.from("cash_tracking").select("*").eq("business_code",t).eq("business_branch_name",e).order("created_at",{ascending:!1}).limit(1).single();if(s){if(s.code==="PGRST116")return null;throw console.error("Error fetching latest cash tracking:",s),s}return n}async function mk(t,e,n,s){try{const r=await G0(t,e),i=(r==null?void 0:r.new_total_cash)||0,a=i+s;return Q0({business_code:t,business_branch_name:e,cashier_name:n,previous_total_cash:i,new_total_cash:a,cash_additions:s,cash_change_reason:"sale"})}catch(r){throw console.error("Error updating cash for sale:",r),r}}async function pk(t,e,n,s,r){try{const i=await G0(t,e),a=(i==null?void 0:i.new_total_cash)||0,l=a+s;return Q0({business_code:t,business_branch_name:e,cashier_name:n,previous_total_cash:a,new_total_cash:l,cash_additions:s>0?s:0,cash_removals:s<0?Math.abs(s):0,cash_change_reason:r})}catch(i){throw console.error("Error updating cash manually:",i),i}}function gk(t,e){if(!(e!=null&&e.vendor_commission_enabled)||!t.business_code_if_vendor)return{finalPrice:t.price,vendorPrice:null};if(t.price<(e.minimum_commission_amount||0))return{finalPrice:t.price,vendorPrice:t.price};const n=t.price*e.default_commission_rate/100;return{finalPrice:t.price+n,vendorPrice:t.price}}async function xk(t,e){try{let n=V.from("products").select("*").eq("current_page","products").eq("accepted",!0).gt("quantity",0).or(`business_code_of_owner.eq.${t},business_code_if_vendor.not.is.null`);e&&(n=n.eq("branch_name",e));const{data:s,error:r}=await n;if(r)throw console.error("Error fetching available products:",r),r;const{data:i,error:a}=await V.from("vendor_assignments").select("vendor_business_code, vendor_email_identifier").eq("owner_business_code",t);if(a)throw console.error("Error fetching vendor assignments:",a),a;let l=[];if((i==null?void 0:i.length)>0){const{data:u,error:h}=await V.from("profiles").select('business_code, "vendor_business _name"').in("his_email",i.map(f=>f.vendor_email_identifier));if(h)throw console.error("Error fetching vendor profiles:",h),h;l=u||[]}const c=new Date;return(s==null?void 0:s.filter(u=>u.type==="food"&&u.expiry_date?new Date(u.expiry_date)>c:!0).map(u=>{var x;const h=_n.getState(),{finalPrice:f,vendorPrice:m}=gk(u,h);return{...u,price:f,vendorPrice:m,business_name_of_product:u.business_code_if_vendor?((x=l.find(g=>g.business_code===u.business_code_if_vendor))==null?void 0:x["vendor_business _name"])||"Unknown Vendor":""}}))||[]}catch(n){throw console.error("Error in getAvailableProducts:",n),n}}async function yk(t){const{data:e,error:n}=await V.from("coupons").select("*").eq("business_code",t).order("created_at",{ascending:!1});if(n)throw console.error("Error fetching coupons:",n),n;return e||[]}async function vk(t){const{data:e,error:n}=await V.from("coupons").insert({coupon_id:crypto.randomUUID(),business_code:t.business_code,coupon_code:t.coupon_code,discount_type:t.discount_type,discount_value:t.discount_value,max_uses:t.max_uses||null,expiry_date:t.expiry_date||null,min_purchase_amount:t.min_purchase_amount||0,max_purchase_amount:t.max_purchase_amount||0,is_active:t.is_active??!0,number_of_uses:0}).select().single();if(n)throw console.error("Error creating coupon:",n),n;return e}async function am(t,e){const{data:n,error:s}=await V.from("coupons").update(e).eq("coupon_id",t).select().single();if(s)throw console.error("Error updating coupon:",s),s;return n}async function bk(t){const{error:e}=await V.from("coupons").delete().eq("coupon_id",t);if(e)throw console.error("Error deleting coupon:",e),e;return!0}function wk(t=8){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let s=0;s<t;s++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}async function _k(t,e){const{data:n,error:s}=await V.from("coupons").select("*").eq("business_code",e).eq("coupon_code",t).eq("is_active",!0).single();if(s){if(s.code==="PGRST116")return null;throw s}return!n||n.expiry_date&&new Date(n.expiry_date)<new Date||n.max_uses&&n.number_of_uses>=n.max_uses?null:n}function jk(){const{language:t}=Y(),{user:e}=ce(),{branches:n}=Ze(),{settings:s}=_n(),r=Vt[t],[i,a]=w.useState([]),[l,c]=w.useState(null),[d,u]=w.useState(""),[h,f]=w.useState(""),[m,x]=w.useState("cash"),[g,y]=w.useState([]),[v,p]=w.useState(!0),[b,j]=w.useState(null),[_,C]=w.useState(null),[S,k]=w.useState(!0),{processReceipt:A,isProcessing:P,error:D,receiptText:M}=uk(),[B,E]=w.useState(null),[T,N]=w.useState(null),[R,O]=w.useState(null),[z,U]=w.useState(!1),[K,G]=w.useState(""),[ye,F]=w.useState(0),[J,X]=w.useState(null),[Wt,zl]=w.useState(null),Ot=n.find($=>$.branch_id===_);w.useEffect(()=>{if(z&&m==="cash"){const $=Ur();G($.toFixed(3)),F(0)}},[z,m]),w.useEffect(()=>{(async()=>{if(e!=null&&e.businessCode){p(!0);try{const q=await Il(e.businessCode);Ze.setState(Ie=>({...Ie,branches:q})),k(!1)}catch(q){console.error("Error loading branches:",q),j(r.errorLoadingBranches),k(!1)}finally{p(!1)}}})()},[e==null?void 0:e.businessCode]),w.useEffect(()=>{!S&&(e!=null&&e.businessCode)&&_&&xo()},[e==null?void 0:e.businessCode,_,S]);const xo=async()=>{try{p(!0),j(null);const $=n.find(Ie=>Ie.branch_id===_);if(!$)throw new Error(r.invalidBranch);const q=await xk(e.businessCode,_==="all"?void 0:$.branch_name);y(q)}catch($){console.error("Error loading products:",$),j(r.errorLoadingProducts)}finally{p(!1)}},Br=$=>{if(!s||!s.vendor_commission_enabled||!$.business_code_if_vendor||$.price<(s.minimum_commission_amount||0))return $.price;const q=$.price*s.default_commission_rate/100;return $.price+q},Ul=$=>{const q=g.find(Ie=>Ie.barcode===$);q&&yo({id:q.product_id.toString(),barcode:q.barcode||"",nameAr:q.product_name,type:q.type,price:Br(q),vendorPrice:q.business_code_if_vendor?q.price:void 0,vendorId:q.business_code_if_vendor||void 0,quantity:1,category:"",expiryDate:q.expiry_date||void 0})},yo=$=>{a(q=>q.find(Ue=>Ue.id===$.id)?q.map(Ue=>Ue.id===$.id?{...Ue,quantity:Ue.quantity+1}:Ue):[...q,{...$,quantity:1}])},Vl=($,q)=>{a(Ie=>q===0?Ie.filter(Ue=>Ue.id!==$):Ie.map(Ue=>Ue.id===$?{...Ue,quantity:q}:Ue))},I=($,q)=>{a(Ie=>Ie.map(Ue=>Ue.id===$?{...Ue,notes:q}:Ue))},ee=$=>{a(q=>q.filter(Ie=>Ie.id!==$))},Te=$=>{O(null);const q=is();if($.type==="fixed"&&$.value>q){O(r.discountExceedsTotal);return}if($.type==="percentage"&&$.value>100){O(r.invalidPercentage);return}E($)},$r=async $=>{O(null);try{const q=await _k($,e.businessCode);q&&(N($),E({type:q.discount_type,value:q.discount_value}))}catch(q){O(q instanceof Error?q.message:r.invalidCoupon)}},is=()=>i.reduce(($,q)=>$+q.price*q.quantity,0),zr=()=>{if(!B)return 0;const $=is();return B.type==="fixed"?B.value:$*B.value/100},Wl=()=>{if(!(s!=null&&s.tax_enabled))return 0;const $=is(),q=zr();return($-q)*s.tax_rate/100},Ur=()=>{const $=is(),q=zr(),Ie=Wl();return $-q+Ie},sv=async()=>{i.length!==0&&U(!0)},rv=async()=>{if(m==="cash"){const q=parseFloat(K),Ie=Ur();if(isNaN(q)||q<Ie){X(r.insufficientCash);return}}if(!Ot){j(r.noBranchSelected);return}const $=await A(i,l,m,zr(),T,h);if($){if(zl($),m==="cash")try{await mk(e.businessCode,Ot.branch_name,e.name,Ur())}catch(q){console.error("Error updating cash tracking:",q)}a([]),c(null),f(""),x("cash"),U(!1),E(null),N(null),G(""),F(0),X(null)}};return o.jsxs("div",{className:"h-full flex",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex-1 flex flex-col",children:[o.jsxs("div",{className:"bg-white p-4 shadow-sm space-y-4",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.jsxs("div",{className:"col-span-full",children:[o.jsx(vS,{onScan:Ul}),o.jsx("div",{className:"mt-4",children:o.jsx(SS,{onBranchChange:C})})]})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.jsxs("div",{className:"md:col-span-2 relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:d,onChange:$=>u($.target.value),placeholder:r.searchProduct,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})})]}),o.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:v?o.jsx("p",{className:"col-span-full text-center py-8 text-gray-500",children:r.loading}):b?o.jsxs("div",{className:"col-span-full text-center py-8",children:[o.jsx("p",{className:"text-red-500 mb-2",children:b}),o.jsx("span",{onClick:xo,className:"mt-2 text-indigo-600 hover:text-indigo-800",children:r.retry})]}):g.filter($=>$.product_name.includes(d)||$.barcode&&$.barcode.includes(d)).map($=>o.jsxs("div",{onClick:()=>yo({id:$.product_id.toString(),barcode:$.barcode||"",nameAr:$.product_name,type:$.type,price:Br($),vendorPrice:$.business_code_if_vendor?$.price:void 0,vendorId:$.business_code_if_vendor||void 0,quantity:1,category:"",expiryDate:$.expiry_date||void 0}),className:"bg-white rounded-lg shadow p-4 cursor-pointer hover:shadow-md transition-shadow",children:[o.jsx("div",{className:"aspect-square bg-gray-100 rounded-md mb-3",children:$.image_url&&o.jsx("img",{src:$.image_url,alt:$.product_name,className:"w-full h-full object-cover rounded-md"})}),o.jsx("h3",{className:"font-medium",children:$.product_name}),o.jsxs("p",{className:"text-sm text-gray-500",children:[$.type==="food"?r.food:r.product,$.business_name_of_product&&o.jsxs("span",{className:"mr-1 text-xs text-indigo-600",children:["(",$.business_name_of_product,")",(s==null?void 0:s.vendor_commission_enabled)&&o.jsxs("div",{className:"text-xs text-gray-500",children:[r.originalPrice,": ",$.price.toFixed(3)," ",r.currency]})]})]}),$.type==="food"&&$.expiry_date&&o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.expiryDate,": ",new Date($.expiry_date).toLocaleDateString()]}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[r.inStock,": ",$.quantity]}),$.business_code_if_vendor&&o.jsx("div",{className:"mt-1 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800",children:r.vendorProduct}),o.jsxs("p",{className:"text-indigo-600 font-bold mt-1",children:[Br($).toFixed(3)," ",r.currency,$.business_code_if_vendor&&(s==null?void 0:s.vendor_commission_enabled)&&o.jsxs("span",{className:"text-xs text-green-600 block",children:["+",s.default_commission_rate,"% ",r.commission]})]})]},$.product_id))})})]}),o.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsxs("div",{className:"flex items-center flex-1",children:[o.jsx(r0,{className:"w-5 h-5 text-gray-500"}),o.jsx("h2",{className:"text-lg font-semibold mr-2",children:r.cart})]}),l&&o.jsx("div",{className:"text-sm text-gray-600",children:l.name})]})}),o.jsx(yS,{onCustomerSelect:c}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.length===0?o.jsx("p",{className:"text-gray-500 text-center py-8",children:r.noItems}):o.jsx("div",{className:"space-y-4",children:i.map($=>o.jsx(bS,{item:$,onUpdateQuantity:Vl,onUpdateNotes:I,onRemove:ee},$.id))})}),o.jsx(jS,{subtotal:is(),onApplyDiscount:Te,onApplyCoupon:$r,appliedDiscount:B||void 0,appliedCoupon:T||void 0,error:R}),o.jsx(NS,{selectedMethod:m,onMethodChange:x}),o.jsx(_S,{notes:h,onNotesChange:f}),o.jsxs("div",{className:"border-t p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[r.subtotal,":"]}),o.jsxs("span",{children:[is().toFixed(3)," ",r.currency]})]}),B&&o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[r.discount,":"]}),o.jsxs("span",{className:"text-red-600",children:["-",zr().toFixed(3)," ",r.currency]})]}),(s==null?void 0:s.tax_enabled)&&o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-gray-600",children:[r.tax," (",s.tax_rate,"%):"]}),o.jsxs("span",{children:[Wl().toFixed(3)," ",r.currency]})]}),o.jsxs("div",{className:"flex justify-between text-lg font-semibold pt-2 border-t",children:[o.jsxs("span",{children:[r.total,":"]}),o.jsxs("span",{children:[Ur().toFixed(3)," ",r.currency]})]})]}),o.jsx("button",{disabled:i.length===0,onClick:sv,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:opacity-50",children:P?r.processing:r.checkout})]})]}),z&&o.jsx(wS,{total:Ur(),subtotal:is(),discount:zr(),taxAmount:Wl(),paymentMethod:m,customer:l,settings:s,cart:i,receiptId:(Wt==null?void 0:Wt.receipt_id)||"",branchName:Ot?Ot.branch_name:"",cashierName:(e==null?void 0:e.name)||"",couponCode:T||void 0,notes:h,onConfirm:rv,onCancel:()=>U(!1)})]})}const Lr={ar:{products:"المنتجات",noAssignments:"لم يتم تعيينك لأي متجر بعد",loading:"جاري التحميل...",allBusinesses:"جميع المتاجر",allBranches:"جميع الفروع",selectBusinessFirst:"يجب اختيار متجر قبل إضافة منتج",errorLoadingAssignments:"حدث خطأ أثناء تحميل التعيينات",errorLoadingProducts:"حدث خطأ أثناء تحميل المنتجات",errorSavingProduct:"حدث خطأ أثناء حفظ المنتج",errorDeletingProduct:"حدث خطأ أثناء حذف المنتج",approved:"تمت الموافقة",rejected:"مرفوض",pending:"في انتظار المراجعة",addProduct:"إضافة منتج",updateProduct:"تحديث المنتج",addNewProduct:"إضافة منتج جديد",searchProduct:"ابحث عن منتج...",allProducts:"جميع المنتجات",foodProducts:"منتجات غذائية",nonFoodProducts:"منتجات غير غذائية",allBranches:"جميع الفروع",selectBranchFirst:"يجب اختيار فرع قبل إضافة منتج",allCategories:"جميع الفئات",selectCategory:"اختر الفئة",categories:"الفئات",addCategory:"إضافة فئة",editCategory:"تعديل الفئة",deleteCategory:"حذف الفئة",categoryName:"اسم الفئة",categoryType:"نوع الفئة",foodCategory:"فئة طعام",nonFoodCategory:"فئة منتجات",categoryDeleted:"تم حذف الفئة بنجاح",categoryAdded:"تم إضافة الفئة بنجاح",categoryUpdated:"تم تحديث الفئة بنجاح",confirmDeleteCategory:"هل أنت متأكد من حذف هذه الفئة؟",categoryInUse:"لا يمكن حذف الفئة لأنها مستخدمة في منتجات",productImage:"صورة المنتج",chooseImage:"اختر صورة",uploadInstructions:"PNG, JPG حتى 5MB",productType:"نوع المنتج",food:"منتج غذائي",nonFood:"منتج غير غذائي",vendor:"المورد",business:"المتجر",productName:"اسم المنتج",price:"السعر",quantity:"الكمية",branch:"الفرع",selectBranch:"اختر الفرع",barcode:"الباركود",barcodeGeneratedAutomatically:"يتم توليد الباركود تلقائياً",optional:"اختياري",productionDate:"تاريخ الإنتاج",expiryDate:"تاريخ انتهاء الصلاحية",description:"الوصف",cancel:"إلغاء",expired:"منتهي الصلاحية",expiresInToday:"ينتهي اليوم",expiresIn:"ينتهي خلال {days} يوم",edit:"تعديل",currency:"ر.ع",expiredProductsWarning:"{count} منتج منتهي الصلاحية",printBarcode:"طباعة الباركود",pendingApprovalNotice:"سيتم مراجعة المنتج من قبل صاحب المتجر قبل نشره",uploading:"جاري الرفع...",errorUploadingImage:"حدث خطأ أثناء رفع الصورة",errorGeneratingBarcode:"حدث خطأ أثناء إنشاء الباركود",delete:"حذف",confirmDelete:"تأكيد الحذف",deleteConfirmationMessage:"هل أنت متأكد من حذف المنتج {name}؟",unknownBusiness:"متجر غير معروف",sendingTo:"إرسال إلى",selectBusiness:"اختر متجر",originalPrice:"السعر الأصلي",commission:"عمولة",selectBranch:"اختر الفرع",selectBusinessFirst:"يجب اختيار متجر أولاً",selectBranch:"اختر الفرع",sortAsc:"ترتيب تصاعدي",sortDesc:"ترتيب تنازلي"},en:{products:"Products",noAssignments:"You have not been assigned to any stores yet",loading:"Loading...",allBusinesses:"All Businesses",allBranches:"All Branches",selectBusinessFirst:"Please select a business before adding a product",errorLoadingAssignments:"Error loading assignments",errorLoadingProducts:"Error loading products",errorSavingProduct:"Error saving product",errorDeletingProduct:"Error deleting product",approved:"Approved",rejected:"Rejected",pending:"Pending Review",addProduct:"Add Product",updateProduct:"Update Product",addNewProduct:"Add New Product",searchProduct:"Search for a product...",allProducts:"All Products",foodProducts:"Food Products",nonFoodProducts:"Non-Food Products",allBranches:"All Branches",selectBranchFirst:"Please select a branch before adding a product",allCategories:"All Categories",selectCategory:"Select Category",categories:"Categories",addCategory:"Add Category",editCategory:"Edit Category",deleteCategory:"Delete Category",categoryName:"Category Name",categoryType:"Category Type",foodCategory:"Food Category",nonFoodCategory:"Non-Food Category",categoryDeleted:"Category deleted successfully",categoryAdded:"Category added successfully",categoryUpdated:"Category updated successfully",confirmDeleteCategory:"Are you sure you want to delete this category?",categoryInUse:"Cannot delete category as it is used in products",productImage:"Product Image",chooseImage:"Choose Image",uploadInstructions:"PNG, JPG up to 5MB",productType:"Product Type",food:"Food",nonFood:"Non-Food Product",vendor:"Vendor",business:"Business",productName:"Product Name",price:"Price",quantity:"Quantity",branch:"Branch",selectBranch:"Select Branch",barcode:"Barcode",barcodeGeneratedAutomatically:"Barcode is generated automatically",optional:"Optional",productionDate:"Production Date",expiryDate:"Expiry Date",description:"Description",cancel:"Cancel",expired:"Expired",expiresInToday:"Expires Today",expiresIn:"Expires in {days} days",edit:"Edit",currency:"OMR",expiredProductsWarning:"{count} products are expired",printBarcode:"Print Barcode",pendingApprovalNotice:"Product will be reviewed by the store owner before publishing",uploading:"Uploading...",errorUploadingImage:"Error uploading image",errorGeneratingBarcode:"Error generating barcode",delete:"Delete",confirmDelete:"Confirm Delete",deleteConfirmationMessage:"Are you sure you want to delete product {name}?",unknownBusiness:"Unknown Business",sendingTo:"Sending to",selectBusiness:"Select business",originalPrice:"Original Price",commission:"commission",selectBranch:"Select branch",selectBusinessFirst:"Please select a business first",selectBranch:"Select branch",sortAsc:"Sort ascending",sortDesc:"Sort descending"}};function Nk({branches:t,selectedBranch:e,onBranchChange:n,className:s=""}){const{language:r}=Y(),i=Lr[r],a=t.filter(l=>l.is_active);return o.jsxs("div",{className:`flex items-center space-x-2 space-x-reverse ${s}`,children:[o.jsx(Be,{className:"w-5 h-5 text-gray-400"}),o.jsxs("select",{value:e,onChange:l=>n(l.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:r==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:i.allBranches}),a.map(l=>o.jsx("option",{value:l.branch_name,children:l.branch_name},l.branch_id))]})]})}function K0(t){const e=`${t.productId}-${t.vendorId}`,s=Sk(e).slice(0,12);return s+kk(s)}function Sk(t){let e=0;for(let s=0;s<t.length;s++){const r=t.charCodeAt(s);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString().padStart(12,"0").slice(0,12)}function kk(t){let e=0;for(let s=0;s<12;s++){const r=parseInt(t[s]);e+=s%2===0?r:r*3}return(10-e%10)%10}async function Ck(t){try{const e=K0(t),r=(window!==window.parent?window.parent:window).open("","_blank","width=600,height=600");if(!r)throw console.error("Failed to open print window"),new Error("Could not open print window");const i=Pk(e,t);r.document.write(i),r.document.close(),await new Promise((a,l)=>{let c=0;const d=50,u=()=>{if(c++,c>d){l(new Error("Timeout waiting for document to load"));return}r.document.readyState==="complete"?a():setTimeout(u,100)};r.onload=()=>u(),u()});try{return await r.document.fonts.ready,await new Promise(a=>setTimeout(a,1e3)),r.print(),new Promise(a=>{let l=!1;r.onafterprint=()=>{l||(l=!0,r.close(),a(!0))},setTimeout(()=>{l||(l=!0,r.close(),a(!0))},1e3)})}catch(a){throw console.error("Print error:",a),r.close(),a}}catch(e){throw console.error("Failed to print barcode:",e),e}}function Pk(t,e){return`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Print Barcode</title>
      <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+39&family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
      <style>
        @page {
          size: 58mm 40mm;
          margin: 0;
        }
        
        body {
          margin: 0;
          padding: 0;
          font-family: 'Noto Sans Arabic', sans-serif;
        }
        
        .barcode-container {
          width: 58mm;
          padding: 1mm;
          text-align: center;
        }
        
        .business-name {
          font-size: 10px;
          font-weight: bold;
          margin-bottom: 0.5mm;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        
        .barcode {
          font-family: 'Libre Barcode 39', cursive;
          font-size: 32px;
          line-height: 1;
          margin: 1mm 0;
          white-space: nowrap;
        }
        
        .product-name {
          font-size: 10px;
          font-weight: bold;
          margin: 0.5mm 0;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        
        .price {
          font-size: 12px;
          font-weight: bold;
          margin: 0.5mm 0;
        }

        .expiry-date {
          font-size: 8px;
          color: #dc2626;
          margin: 0.5mm 0;
        }
        
        .barcode-number {
          font-family: monospace;
          font-size: 8px;
          margin: 0.5mm 0;
          letter-spacing: 1px;
        }

        .vendor-info {
          font-size: 8px;
          color: #4b5563;
          margin: 0.5mm 0;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        @media print {
          body {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
        }
      </style>
    </head>
    <body>
      <div class="barcode-container">
        ${e.businessName?`<div class="business-name">${e.businessName.substring(0,30)}</div>`:""}
        ${e.vendorName?`<div class="vendor-info">${e.vendorName.substring(0,30)}</div>`:""}
        <div class="barcode">*${t}*</div>
        <div class="barcode-number">${t}</div>
        <div class="product-name">${e.name.substring(0,30)}</div>
        <div class="price">${e.price.toFixed(3)} OMR</div>
        ${e.expiryDate?`
          <div class="expiry-date">انتهاء: ${new Date(e.expiryDate).toLocaleDateString("ar")}</div>
        `:""}
      </div>
    </body>
    </html>
  `.trim()}function Zu(){const[t,e]=w.useState(!1),[n,s]=w.useState(!1),[r,i]=w.useState(null);return{generateProductBarcode:async c=>{e(!0),i(null);try{return K0(c)}catch(d){throw i("Failed to generate barcode"),d}finally{e(!1)}},printProductBarcode:async c=>{s(!0),i(null);try{if(!await Ck(c))throw new Error("Print failed")}catch(d){throw i("Failed to print barcode"),d}finally{s(!1)}},isGenerating:t,isPrinting:n,error:r}}function J0({product:t,className:e=""}){const{language:n}=Y(),{printProductBarcode:s,isPrinting:r,error:i}=Zu(),a=async()=>{try{if(!await s({productId:t.product_id.toString(),vendorId:t.business_code_if_vendor||t.business_code_of_owner,name:t.product_name,price:t.price,businessName:t.business_name_of_product,expiryDate:t.type==="food"?t.expiry_date:void 0}))throw new Error("Print failed")}catch(l){console.error("Print failed:",l)}};return o.jsxs("button",{onClick:a,disabled:r,className:`inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed ${e}`,title:n==="ar"?"طباعة الباركود":"Print Barcode",children:[o.jsx(o1,{className:"h-4 w-4 ml-2"}),n==="ar"?"طباعة الباركود":"Print Barcode"]})}const Ek={ar:{upcomingProducts:"المنتجات القادمة",searchProducts:"ابحث عن منتج أو مورد...",allStatuses:"جميع الحالات",pending:"في انتظار المراجعة",approved:"تمت الموافقة",rejected:"مرفوض",product:"المنتج",vendor:"المورد",type:"النوع",food:"منتج غذائي",nonFood:"منتج غير غذائي",expiryDate:"تاريخ انتهاء الصلاحية",quantity:"الكمية",price:"السعر",submittedAt:"تاريخ التقديم",status:"الحالة",actions:"إجراءات",review:"مراجعة",reviewProduct:"مراجعة المنتج",reviewNotes:"ملاحظات المراجعة",approve:"موافقة",reject:"رفض",cancel:"إلغاء",currency:"ر.ع",pendingReviewCount:"{count} منتج في انتظار المراجعة"},en:{upcomingProducts:"Upcoming Products",searchProducts:"Search for product or vendor...",allStatuses:"All Statuses",pending:"Pending Review",approved:"Approved",rejected:"Rejected",product:"Product",vendor:"Vendor",type:"Type",food:"Food",nonFood:"Non-Food Product",expiryDate:"Expiry Date",quantity:"Quantity",price:"Price",submittedAt:"Submitted At",status:"Status",actions:"Actions",review:"Review",reviewProduct:"Review Product",reviewNotes:"Review Notes",approve:"Approve",reject:"Reject",cancel:"Cancel",currency:"OMR",pendingReviewCount:"{count} products pending review"}};function Mk(t,e){if(!(e!=null&&e.vendor_commission_enabled)||!t.business_code_if_vendor)return{finalPrice:t.price,vendorPrice:null};if(t.price<(e.minimum_commission_amount||0))return{finalPrice:t.price,vendorPrice:t.price};const n=t.price*e.default_commission_rate/100;return{finalPrice:t.price+n,vendorPrice:t.price}}async function X0(t={}){let e=V.from("products").select("*");t.page&&(e=e.eq("current_page",t.page)),t.type&&(e=e.eq("type",t.type)),t.accepted!==void 0&&(e=e.eq("accepted",t.accepted)),t.searchQuery&&(e=e.ilike("product_name",`%${t.searchQuery}%`)),t.branch_name&&(e=e.eq("branch_name",t.branch_name));const{data:n,error:s}=await e;if(s)return console.error("Error fetching products:",s),[];const{data:r}=await V.from("business_settings").select("*").eq("business_code_",t.business_code).single();return(n==null?void 0:n.map(a=>{const{finalPrice:l,vendorPrice:c}=Mk(a,r);return{...a,price:l,vendorPrice:c}}))||[]}async function Tk(t){let e=V.from("products").select("*");e=e.eq("business_code_if_vendor",t.vendorBusinessCode),t.businessCode&&t.businessCode!=="all"&&(e=e.eq("business_code_of_owner",t.businessCode)),t.branchName&&t.branchName!=="all"&&(e=e.eq("branch_name",t.branchName));const{data:n,error:s}=await e;if(s)throw console.error("Error fetching vendor products:",s),s;return n||[]}async function Z0(t,e){const{data:n,error:s}=await V.from("profiles").select('business_name, role, "vendor_business _name"').eq("business_code",t.business_code_if_vendor||t.business_code_of_owner).eq("role",t.business_code_if_vendor?"vendor":"owner").maybeSingle();if(s)throw console.error("Error fetching business name:",s),s;const r=t.business_code_if_vendor?n==null?void 0:n["vendor_business _name"]:n==null?void 0:n.business_name,{product_name:i,type:a,current_page:l,expiry_date:c,quantity:d,price:u,barcode:h,image_url:f,description:m,trackable:x,business_code_of_owner:g,business_code_if_vendor:y,branch_name:v="main",accepted:p}=t,b={product_name:i,type:a,business_name_of_product:r||"Unknown Business",current_page:l||"upcoming_products",expiry_date:c,quantity:d||0,price:u||0,barcode:h,image_url:f,description:m,trackable:x||!1,business_code_of_owner:g,business_code_if_vendor:y,branch_name:v,accepted:p||!1,date_of_creation:new Date().toISOString()},{data:j,error:_}=await V.from("products").insert([b]).select().single();if(_)throw console.error("Error creating product:",_),_;return j}async function ey(t,e){const{product_name:n,type:s,production_date:r,current_page:i,expiry_date:a,quantity:l,price:c,barcode:d,image_url:u,description:h,trackable:f,business_code_of_owner:m,business_code_if_vendor:x,branch_name:g,accepted:y,rejection_reason:v}=e,p={...n&&{product_name:n},...s&&{type:s},...r&&{production_date:r},...i&&{current_page:i},...a&&{expiry_date:a},...l!==void 0&&{quantity:l},...c!==void 0&&{price:c},...d&&{barcode:d},...u&&{image_url:u},...h&&{description:h},...f!==void 0&&{trackable:f},...m&&{business_code_of_owner:m},...x&&{business_code_if_vendor:x},...g&&{branch_name:g},...y!==void 0&&{accepted:y},...v&&{rejection_reason:v}},{data:b,error:j}=await V.from("products").update(p).eq("product_id",t).select().single();return j?(console.error("Error updating product:",j),null):b}async function lm(t,e,n){const{error:s}=await V.from("products").update({accepted:e,current_page:e?"products":"upcoming_products",date_of_acception_or_rejection:new Date().toISOString(),rejection_reason:n||null}).eq("product_id",t);return s?(console.error("Error approving/rejecting product:",s),!1):!0}async function ty(t){const{error:e}=await V.from("products").delete().eq("product_id",t);return e?(console.error("Error deleting product:",e),!1):!0}const cm=["bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-yellow-100 text-yellow-800","bg-indigo-100 text-indigo-800","bg-red-100 text-red-800","bg-teal-100 text-teal-800"],Ok=t=>{let e=0;for(let s=0;s<t.length;s++)e=t.charCodeAt(s)+((e<<5)-e);const n=Math.abs(e)%cm.length;return cm[n]};function Ak(){const{language:t}=Y(),{user:e}=ce(),{branches:n,setBranches:s}=Ze(),{settings:r}=_n(),{getCurrentBranch:i}=Ze(),a=Ek[t],[l,c]=w.useState(""),[d,u]=w.useState("all"),[h,f]=w.useState(null),[m,x]=w.useState(""),[g,y]=w.useState([]),[v,p]=w.useState(!0),[b,j]=w.useState("all"),_=(e==null?void 0:e.role)==="cashier",C=i(),S=M=>{if(!(r!=null&&r.vendor_commission_enabled)||!M.business_code_if_vendor)return{finalPrice:M.price,vendorPrice:null};if(M.price<(r.minimum_commission_amount||0))return{finalPrice:M.price,vendorPrice:M.price};const B=M.price*r.default_commission_rate/100;return{finalPrice:M.price+B,vendorPrice:M.price}};w.useEffect(()=>{_&&C&&j(C.branch_name)},[_,C]),w.useEffect(()=>{e!=null&&e.businessCode&&k()},[l,d,b]),w.useEffect(()=>{(async()=>{if(e!=null&&e.businessCode)try{const B=await Il(e.businessCode);s(B)}catch(B){console.error("Error loading branches:",B)}})()},[e==null?void 0:e.businessCode,s]);const k=async()=>{p(!0);try{if(!(e!=null&&e.businessCode))throw new Error("No business code found");const M={page:"upcoming_products",branch_name:_?C==null?void 0:C.branch_name:b==="all"?void 0:b,searchQuery:l||void 0,accepted:d==="approved"?!0:d==="rejected"?!1:void 0,business_code:e.businessCode},B=await X0(M);y(B)}catch(M){console.error("Error loading products:",M)}finally{p(!1)}},A=async M=>{try{await lm(M.product_id,!0),await k(),f(null),x("")}catch(B){console.error("Error approving product:",B)}},P=async M=>{try{await lm(M.product_id,!1,m),await k(),f(null),x("")}catch(B){console.error("Error rejecting product:",B)}},D=g.filter(M=>!M.accepted&&!M.rejection_reason).length;return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:a.upcomingProducts}),D>0&&o.jsxs("div",{className:"flex items-center text-yellow-600",children:[o.jsx(xt,{className:"w-5 h-5 ml-2"}),o.jsx("span",{children:a.pendingReviewCount.replace("{count}",D.toString())})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:l,onChange:M=>c(M.target.value),placeholder:a.searchProducts,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),!_&&o.jsx(Nk,{branches:n,selectedBranch:b,onBranchChange:j}),o.jsxs("select",{value:d,onChange:M=>u(M.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:a.allStatuses}),o.jsx("option",{value:"pending",children:a.pending}),o.jsx("option",{value:"approved",children:a.approved}),o.jsx("option",{value:"rejected",children:a.rejected})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:v?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:a.loading})}):g.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:a.noProducts})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.product}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.vendor}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.category}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.expiryDate}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.quantity}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.price}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.submittedAt}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.status}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:a.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(M=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:M.image_url?o.jsx("img",{src:M.image_url,alt:M.product_name,className:"h-10 w-10 rounded-full object-cover"}):o.jsx(tn,{className:"h-6 w-6 text-gray-500"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.product_name}),o.jsx("div",{className:"text-sm text-gray-500",children:M.type==="food"?a.food:a.nonFood})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o.jsx("span",{className:`${M.business_code_if_vendor?"px-2.5 py-0.5 rounded-full text-xs "+Ok(M.business_name_of_product||""):"text-gray-900"}`,children:M.business_name_of_product||"-"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:M.type==="food"?a.food:a.nonFood})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:M.type==="food"&&M.expiry_date?o.jsxs("div",{className:`text-sm ${new Date(M.expiry_date)<new Date?"text-red-600 font-medium":"text-gray-900"}`,children:[new Date(M.expiry_date).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}),new Date(M.expiry_date)<new Date&&o.jsxs("div",{className:"flex items-center text-red-600 text-xs mt-1",children:[o.jsx(xt,{className:"w-4 h-4 ml-1"}),a.expired]})]}):o.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:M.quantity}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(()=>{const{finalPrice:B,vendorPrice:E}=S(M);return o.jsxs("div",{children:[B.toFixed(3)," ",a.currency,E&&(r==null?void 0:r.vendor_commission_enabled)&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-xs text-gray-500",children:[a.originalPrice,": ",E.toFixed(3)," ",a.currency]}),B>E&&o.jsxs("div",{className:"text-xs text-green-600",children:["+",r.default_commission_rate,"% ",a.commission]})]})]})})()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(M.date_of_creation).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M.accepted?"bg-green-100 text-green-800":M.rejection_reason?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:M.accepted?a.approved:M.rejection_reason?a.rejected:a.pending})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:!M.accepted&&!M.rejection_reason&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>f(M),className:"text-indigo-600 hover:text-indigo-900 ml-4",children:a.review}),o.jsx(J0,{product:M})]})})]},M.product_id))})]})})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:a.reviewProduct}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a.product}),o.jsx("p",{className:"mt-1",children:h.product_name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a.vendor}),o.jsx("p",{className:"mt-1",children:h.business_name_of_product||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a.quantity}),o.jsx("p",{className:"mt-1",children:h.quantity})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a.price}),o.jsxs("p",{className:"mt-1",children:[h.price.toFixed(3)," ",a.currency]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a.description}),o.jsx("p",{className:"mt-1 text-sm text-gray-600 bg-gray-50 p-3 rounded-md min-h-[4rem]",children:h.description||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a.reviewNotes}),o.jsx("textarea",{value:m,onChange:M=>x(M.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>{f(null),x("")},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:a.cancel}),o.jsx("button",{onClick:()=>P(h),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:a.reject}),o.jsx("button",{onClick:()=>A(h),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:a.approve})]})]})]})})]})}const Rk={ar:{loading:"جاري التحميل...",error:"حدث خطأ",success:"تم بنجاح",save:"حفظ",cancel:"إلغاء",edit:"تعديل",delete:"حذف",add:"إضافة",search:"بحث",filter:"تصفية",noData:"لا توجد بيانات",actions:"إجراءات",status:"الحالة",date:"التاريخ",name:"الاسم",phone:"الهاتف",email:"البريد الإلكتروني",address:"العنوان",description:"الوصف",price:"السعر",quantity:"الكمية",total:"المجموع",currency:"ر.ع",invalidImageType:"نوع الملف غير صالح. يرجى اختيار صورة.",imageTooLarge:"حجم الصورة كبير جداً. الحد الأقصى هو 5 ميجابايت.",imageUploadFailed:"فشل رفع الصورة. يرجى المحاولة مرة أخرى."},en:{loading:"Loading...",error:"Error occurred",success:"Success",save:"Save",cancel:"Cancel",edit:"Edit",delete:"Delete",add:"Add",search:"Search",filter:"Filter",noData:"No data available",actions:"Actions",status:"Status",date:"Date",name:"Name",phone:"Phone",email:"Email",address:"Address",description:"Description",price:"Price",quantity:"Quantity",total:"Total",currency:"OMR",invalidImageType:"Invalid file type. Please select an image.",imageTooLarge:"Image is too large. Maximum size is 5MB.",imageUploadFailed:"Failed to upload image. Please try again."}},Dk="245f27a93a29e9ceb49f878bb043d8cf",Ik="https://api.imgbb.com/1/upload";async function Lk(t,e){const n=Rk[e];if(!t.type.startsWith("image/"))throw new Error(n.invalidImageType);if(t.size>5*1024*1024)throw new Error(n.imageTooLarge);try{const s=new FormData;s.append("image",t);const r=await fetch(`${Ik}?key=${Dk}`,{method:"POST",body:s});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();if(!i.success)throw new Error("Upload failed");return i.data.display_url}catch(s){throw console.error("Image upload failed:",s),new Error(n.imageUploadFailed)}}function eh(){const{language:t}=Y(),[e,n]=w.useState(!1),[s,r]=w.useState(null);return{upload:async a=>{n(!0),r(null);try{return await Lk(a,t)}catch(l){return r(l instanceof Error?l.message:"Upload failed"),null}finally{n(!1)}},isUploading:e,error:s}}function Fk({onSubmit:t,initialData:e}){const{language:n}=Y(),{user:s}=ce(),{branches:r}=Ze(),i=Lr[n],[a,l]=Ke.useState(null),{generateProductBarcode:c}=Zu(),{upload:d,isUploading:u}=eh(),h=T=>{if(!T)return"";try{const N=new Date(T);if(isNaN(N.getTime()))return"";const R=N.getFullYear(),O=String(N.getMonth()+1).padStart(2,"0"),z=String(N.getDate()).padStart(2,"0");return`${R}-${O}-${z}`}catch(N){return console.error("Error formatting date:",N),""}},[f,m]=Ke.useState((e==null?void 0:e.type)||"non-food"),[x,g]=Ke.useState(h(e==null?void 0:e.expiry_date)),[y,v]=Ke.useState(h(e==null?void 0:e.production_date)),[p,b]=Ke.useState((e==null?void 0:e.image_url)||null),[j,_]=Ke.useState((e==null?void 0:e.image_url)||null),[C,S]=Ke.useState((e==null?void 0:e.barcode)||""),[k,A]=w.useState((e==null?void 0:e.branch_name)||a||""),P=Ke.useRef(null);w.useEffect(()=>{(async()=>{if(s!=null&&s.id&&!e)try{const N=await I0(s.id);l(N),N&&A(N)}catch(N){console.error("Error loading main branch:",N)}})()},[s==null?void 0:s.id,e]);const D=async T=>{var R;const N=(R=T.target.files)==null?void 0:R[0];if(N){const O=URL.createObjectURL(N);_(O);const z=await d(N);z&&b(z)}},M=async()=>{var z;if(!P.current)return;const T=new FormData(P.current),N=T.get("product_name");if(!N)return;const R=Math.random().toString(36).substring(7),O=Math.random().toString(36).substring(7);try{const U=await c({productId:((z=e==null?void 0:e.product_id)==null?void 0:z.toString())||R,vendorId:(e==null?void 0:e.vendorId)||O,name:N,price:parseFloat(T.get("price"))||0});S(U)}catch(U){console.error("Failed to generate barcode:",U)}},B=T=>{T.target.value?M():S("")},E=T=>{T.preventDefault();const N=new FormData(T.target),R=N.get("product_name"),O=parseFloat(N.get("price")),z=parseInt(N.get("quantity"),10),U={product_name:R,type:f,production_date:y||null,expiry_date:x||null,branch_name:k,price:O,quantity:z,barcode:C,description:N.get("description"),image_url:p||void 0,trackable:f==="food",business_code_of_owner:(s==null?void 0:s.businessCode)||"",current_page:"products",accepted:!0};t(U)};return o.jsxs("form",{ref:P,onSubmit:E,className:"space-y-8",dir:n==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900 mb-2",children:[i.productImage," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"flex items-center space-x-4 space-x-reverse",children:o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors duration-200",children:j?o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:j,alt:"Product preview",className:"h-48 w-48 object-cover rounded-lg shadow-sm"}),o.jsx("button",{type:"button",onClick:()=>{_(null),b("")},className:"absolute top-2 right-2 bg-red-100 text-red-600 rounded-full p-1.5 hover:bg-red-200 shadow-sm transition-colors duration-200",children:"×"})]}):o.jsxs("div",{className:"space-y-1 text-center",children:[o.jsx(qu,{className:"mx-auto h-12 w-12 text-gray-400 animate-pulse"}),o.jsx("div",{className:"flex text-sm text-gray-600",children:o.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500",children:[o.jsx("span",{children:i.chooseImage}),o.jsx("input",{type:"file",accept:"image/*",required:!(e!=null&&e.image_url),onChange:D,className:"sr-only"})]})}),o.jsx("p",{className:"text-xs text-gray-500",children:i.uploadInstructions})]})})})})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.branch," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:k,onChange:T=>A(T.target.value),required:!0,className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base",dir:n==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:i.selectBranch}),r.filter(T=>T.is_active).map(T=>o.jsx("option",{value:T.branch_name,children:T.branch_name},T.branch_id))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.productType," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:f,onChange:T=>m(T.target.value),className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base",children:[o.jsx("option",{value:"food",children:i.food}),o.jsx("option",{value:"non-food",children:i.nonFood})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.productName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"product_name",defaultValue:e==null?void 0:e.product_name,onChange:B,required:!0,className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base",dir:n==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:i.barcode}),o.jsx("div",{className:"mt-1 flex items-center space-x-2 space-x-reverse",children:o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Q_,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:C,readOnly:!0,className:"block w-full pr-10 rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:"ltr"})]})}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i.barcodeGeneratedAutomatically})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.price," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"price",defaultValue:e==null?void 0:e.price,step:"0.01",required:!0,className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.quantity," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"quantity",defaultValue:e==null?void 0:e.quantity,required:!0,className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base"})]}),f==="food"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.productionDate," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"date",value:y||"",onChange:T=>v(T.target.value),required:f==="food",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.expiryDate," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"date",value:x||"",onChange:T=>g(T.target.value),required:f==="food",className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base"})]})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{className:"block text-base font-semibold text-gray-900",children:[i.description,o.jsxs("span",{className:"text-gray-500 text-xs mr-1",children:["(",i.optional,")"]})]}),o.jsx("textarea",{name:"description",defaultValue:e==null?void 0:e.description,rows:3,className:"mt-2 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base",dir:n==="ar"?"rtl":"ltr"})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{type:"submit",className:"px-6 py-3 bg-indigo-600 text-white text-lg font-medium rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 shadow-sm transition-colors duration-200",children:e?i.updateProduct:i.addNewProduct})})]})}function Bk({branches:t,selectedBranch:e,onBranchChange:n,mainBranch:s,className:r=""}){const{language:i}=Y(),a=Lr[i],l=c=>{console.log("Branch selection changed to:",c),n(c)};return o.jsxs("div",{className:`flex items-center space-x-2 space-x-reverse ${r}`,children:[o.jsx(Be,{className:"w-5 h-5 text-gray-400"}),o.jsxs("select",{value:e,onChange:c=>l(c.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:i==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:a.allBranches}),t.filter(c=>c.is_active).map(c=>o.jsx("option",{value:c.branch_name,children:c.branch_name},c.branch_id))]})]})}const dm=["bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-yellow-100 text-yellow-800","bg-indigo-100 text-indigo-800","bg-red-100 text-red-800","bg-teal-100 text-teal-800"],$k=t=>{let e=0;for(let s=0;s<t.length;s++)e=t.charCodeAt(s)+((e<<5)-e);const n=Math.abs(e)%dm.length;return dm[n]};function zk(){const{language:t}=Y(),{user:e}=ce(),{branches:n,setBranches:s}=Ze(),{settings:r}=_n();Ze();const i=Lr[t],[a,l]=w.useState(!1),[c,d]=w.useState(null),[u,h]=w.useState(""),[f,m]=w.useState("all"),[x,g]=w.useState("all"),[y,v]=w.useState(null),[p,b]=w.useState(!0),[j,_]=w.useState([]),[C,S]=w.useState(!0),[k,A]=w.useState(null),[P,D]=w.useState("product_name"),[M,B]=w.useState("asc"),[E,T]=w.useState(!1),N=F=>{P===F?B(J=>J==="asc"?"desc":"asc"):(D(F),B("asc"))},R=Ke.useMemo(()=>[...j].sort((F,J)=>{let X=0;switch(P){case"product_name":X=F.product_name.localeCompare(J.product_name);break;case"business_name_of_product":X=(F.business_name_of_product||"").localeCompare(J.business_name_of_product||"");break;case"type":X=F.type.localeCompare(J.type);break;case"price":X=F.price-J.price;break;case"quantity":X=F.quantity-J.quantity;break;case"expiry_date":!F.expiry_date&&!J.expiry_date?X=0:F.expiry_date?J.expiry_date?X=new Date(F.expiry_date).getTime()-new Date(J.expiry_date).getTime():X=-1:X=1;break}return M==="asc"?X:-X}),[j,P,M]),O=({field:F,children:J})=>o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer group",onClick:()=>N(F),title:P===F&&M==="asc"?i.sortDesc:i.sortAsc,children:o.jsxs("div",{className:"flex items-center justify-end space-x-1 space-x-reverse",children:[o.jsx("span",{children:J}),o.jsx(Wu,{className:`w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity ${P===F?"opacity-100 text-indigo-500":"text-gray-400"}`})]})});w.useEffect(()=>{E&&e!=null&&e.businessCode&&z()},[u,x,f,E,e==null?void 0:e.businessCode]),w.useEffect(()=>{(async()=>{if(e!=null&&e.businessCode)try{S(!0);const J=await Il(e.businessCode);s(J);const X=await I0(e.id);X&&(console.log("Setting main branch:",X),v(X),p&&(e==null?void 0:e.role)==="cashier"&&(m(X),b(!1))),T(!0)}catch(J){console.error("Error loading branches:",J)}finally{S(!1)}})()},[e==null?void 0:e.businessCode,s]);const z=async()=>{S(!0);try{console.log("Loading products with branch:",f),console.log("User role:",e==null?void 0:e.role),console.log("Main branch:",y);const F={page:"products",searchQuery:u||void 0,type:x==="all"?void 0:x,branch_name:f==="all"?void 0:f,business_code:e.businessCode};console.log("Fetching products with filters:",F);const J=await X0(F);_(J)}catch(F){console.error("Error loading products:",F)}finally{S(!1)}},U=async F=>{try{c?await ey(c.product_id,F):await Z0({...F,business_code_of_owner:(e==null?void 0:e.businessCode)||"",current_page:"products",accepted:!0}),await z()}catch(J){console.error("Error saving product:",J)}l(!1),d(null)},K=async F=>{try{await ty(F.product_id)&&await z()}catch(J){console.error("Error deleting product:",J)}A(null)},G=F=>{console.log("Branch change requested:",F),b(!1),m(F)},ye=j.filter(F=>F.type==="food"&&F.expiry_date&&new Date(F.expiry_date)<new Date);return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:i.products}),o.jsxs("button",{onClick:()=>{d(null),l(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),i.addProduct]})]}),ye.length>0&&o.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"ml-3",children:o.jsx("p",{className:"text-sm text-red-700",children:i.expiredProductsWarning.replace("{count}",ye.length.toString())})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow",children:o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:u,onChange:F=>h(F.target.value),placeholder:i.searchProduct,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsx(Bk,{branches:n,selectedBranch:f,onBranchChange:G,mainBranch:y}),o.jsxs("select",{value:x,onChange:F=>{g(F.target.value)},className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:i.allProducts}),o.jsx("option",{value:"food",children:i.foodProducts}),o.jsx("option",{value:"non-food",children:i.nonFoodProducts})]})]})})}),a&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:c?i.updateProduct:i.addNewProduct}),o.jsx(Fk,{onSubmit:U,initialData:c||void 0}),o.jsx("button",{onClick:()=>{l(!1),d(null)},className:"mt-4 px-4 py-2 text-gray-600 hover:text-gray-800",children:i.cancel})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:C?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:i.loading})}):j.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:i.noProducts})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx(O,{field:"product_name",children:i.productName}),o.jsx(O,{field:"business_name_of_product",children:i.vendor}),o.jsx(O,{field:"type",children:i.productType}),o.jsx(O,{field:"price",children:i.price}),o.jsx(O,{field:"quantity",children:i.quantity}),o.jsx(O,{field:"expiry_date",children:i.expiryDate}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:i.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map(F=>{const J=F.type==="food"&&F.expiry_date&&new Date(F.expiry_date)<new Date;return o.jsxs("tr",{className:J?"bg-red-50":void 0,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:F.image_url?o.jsx("img",{src:F.image_url,alt:F.product_name,className:"h-10 w-10 rounded-full object-cover"}):o.jsx(tn,{className:"h-6 w-6 text-gray-500"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.product_name}),F.business_code_if_vendor&&(r==null?void 0:r.vendor_commission_enabled)&&o.jsxs("div",{className:"text-xs text-gray-500",children:[i.originalPrice,": ",F.price.toFixed(3)," ",i.currency]})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:o.jsx("span",{className:`inline-flex items-center text-sm font-medium ${F.business_code_if_vendor?"px-2.5 py-0.5 rounded-full text-xs "+$k(F.business_name_of_product||""):"text-gray-900"}`,children:F.business_name_of_product||i.unknownBusiness})})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${F.type==="food"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:F.type==="food"?i.food:i.nonFood})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[F.price.toFixed(3)," ",i.currency,F.business_code_if_vendor&&(r==null?void 0:r.vendor_commission_enabled)&&o.jsxs(o.Fragment,{children:[F.vendorPrice&&F.price>F.vendorPrice&&o.jsxs("div",{className:"text-xs text-gray-500",children:[i.originalPrice,": ",F.vendorPrice.toFixed(3)," ",i.currency]}),F.price>F.vendorPrice&&o.jsxs("div",{className:"text-xs text-green-600",children:["+",r.default_commission_rate,"% ",i.commission]})]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.quantity}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F.type==="food"&&F.expiry_date?o.jsxs("div",{className:`text-sm ${J?"text-red-600":"text-gray-900"}`,children:[new Date(F.expiry_date).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}),J&&o.jsxs("div",{className:"flex items-center text-red-600 text-xs mt-1",children:[o.jsx(xt,{className:"w-4 h-4 ml-1"}),i.expired]})]}):o.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>{d(F),l(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:i.edit}),o.jsx("button",{onClick:()=>A(F),className:"text-red-600 hover:text-red-900 ml-4",children:i.delete}),o.jsx(J0,{product:F})]})]},F.product_id)})})]})})}),k&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:i.confirmDelete}),o.jsx("p",{className:"text-gray-600 mb-6",children:i.deleteConfirmationMessage.replace("{name}",k.product_name)}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>A(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:i.cancel}),o.jsx("button",{onClick:()=>K(k),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:i.confirmDelete})]})]})})]})}const ny={ar:{returns:"المرتجعات",totalReturns:"إجمالي المرتجعات",pendingReturns:"مرتجعات معلقة",totalAmount:"إجمالي المبلغ",searchReturns:"بحث في المرتجعات...",allStatuses:"جميع الحالات",pending:"معلق",approved:"مقبول",rejected:"مرفوض",receiptNumber:"رقم الفاتورة",date:"التاريخ",item:"المنتج",quantity:"الكمية",amount:"المبلغ",reason:"السبب",status:"الحالة",returnsOverTime:"المرتجعات عبر الزمن",returnsAmount:"قيمة المرتجعات",currency:"ر.ع"},en:{returns:"Returns",totalReturns:"Total Returns",pendingReturns:"Pending Returns",totalAmount:"Total Amount",searchReturns:"Search returns...",allStatuses:"All Statuses",pending:"Pending",approved:"Approved",rejected:"Rejected",receiptNumber:"Receipt Number",date:"Date",item:"Item",quantity:"Quantity",amount:"Amount",reason:"Reason",status:"Status",returnsOverTime:"Returns Over Time",returnsAmount:"Returns Amount",currency:"OMR"}};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function po(t){return t+.5|0}const Bn=(t,e,n)=>Math.max(Math.min(t,n),e);function ci(t){return Bn(po(t*2.55),0,255)}function Kn(t){return Bn(po(t*255),0,255)}function un(t){return Bn(po(t/2.55)/100,0,1)}function um(t){return Bn(po(t*100),0,100)}const bt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Bd=[..."0123456789ABCDEF"],Uk=t=>Bd[t&15],Vk=t=>Bd[(t&240)>>4]+Bd[t&15],zo=t=>(t&240)>>4===(t&15),Wk=t=>zo(t.r)&&zo(t.g)&&zo(t.b)&&zo(t.a);function Hk(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&bt[t[1]]*17,g:255&bt[t[2]]*17,b:255&bt[t[3]]*17,a:e===5?bt[t[4]]*17:255}:(e===7||e===9)&&(n={r:bt[t[1]]<<4|bt[t[2]],g:bt[t[3]]<<4|bt[t[4]],b:bt[t[5]]<<4|bt[t[6]],a:e===9?bt[t[7]]<<4|bt[t[8]]:255})),n}const qk=(t,e)=>t<255?e(t):"";function Yk(t){var e=Wk(t)?Uk:Vk;return t?"#"+e(t.r)+e(t.g)+e(t.b)+qk(t.a,e):void 0}const Qk=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function sy(t,e,n){const s=e*Math.min(n,1-n),r=(i,a=(i+t/30)%12)=>n-s*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function Gk(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function Kk(t,e,n){const s=sy(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function Jk(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function th(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),a=Math.min(n,s,r),l=(i+a)/2;let c,d,u;return i!==a&&(u=i-a,d=l>.5?u/(2-i-a):u/(i+a),c=Jk(n,s,r,u,i),c=c*60+.5),[c|0,d||0,l]}function nh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(Kn)}function sh(t,e,n){return nh(sy,t,e,n)}function Xk(t,e,n){return nh(Kk,t,e,n)}function Zk(t,e,n){return nh(Gk,t,e,n)}function ry(t){return(t%360+360)%360}function eC(t){const e=Qk.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?ci(+e[5]):Kn(+e[5]));const r=ry(+e[2]),i=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?s=Xk(r,i,a):e[1]==="hsv"?s=Zk(r,i,a):s=sh(r,i,a),{r:s[0],g:s[1],b:s[2],a:n}}function tC(t,e){var n=th(t);n[0]=ry(n[0]+e),n=sh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function nC(t){if(!t)return;const e=th(t),n=e[0],s=um(e[1]),r=um(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${un(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const hm={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},fm={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function sC(){const t={},e=Object.keys(fm),n=Object.keys(hm);let s,r,i,a,l;for(s=0;s<e.length;s++){for(a=l=e[s],r=0;r<n.length;r++)i=n[r],l=l.replace(i,hm[i]);i=parseInt(fm[a],16),t[l]=[i>>16&255,i>>8&255,i&255]}return t}let Uo;function rC(t){Uo||(Uo=sC(),Uo.transparent=[0,0,0,0]);const e=Uo[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const iC=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function oC(t){const e=iC.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const a=+e[7];n=e[8]?ci(a):Bn(a*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?ci(s):Bn(s,0,255)),r=255&(e[4]?ci(r):Bn(r,0,255)),i=255&(e[6]?ci(i):Bn(i,0,255)),{r:s,g:r,b:i,a:n}}}function aC(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${un(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Nc=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Us=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function lC(t,e,n){const s=Us(un(t.r)),r=Us(un(t.g)),i=Us(un(t.b));return{r:Kn(Nc(s+n*(Us(un(e.r))-s))),g:Kn(Nc(r+n*(Us(un(e.g))-r))),b:Kn(Nc(i+n*(Us(un(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Vo(t,e,n){if(t){let s=th(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=sh(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function iy(t,e){return t&&Object.assign(e||{},t)}function mm(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Kn(t[3]))):(e=iy(t,{r:0,g:0,b:0,a:1}),e.a=Kn(e.a)),e}function cC(t){return t.charAt(0)==="r"?oC(t):eC(t)}class Zi{constructor(e){if(e instanceof Zi)return e;const n=typeof e;let s;n==="object"?s=mm(e):n==="string"&&(s=Hk(e)||rC(e)||cC(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=iy(this._rgb);return e&&(e.a=un(e.a)),e}set rgb(e){this._rgb=mm(e)}rgbString(){return this._valid?aC(this._rgb):void 0}hexString(){return this._valid?Yk(this._rgb):void 0}hslString(){return this._valid?nC(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const a=n===i?.5:n,l=2*a-1,c=s.a-r.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;i=1-d,s.r=255&d*s.r+i*r.r+.5,s.g=255&d*s.g+i*r.g+.5,s.b=255&d*s.b+i*r.b+.5,s.a=a*s.a+(1-a)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=lC(this._rgb,e._rgb,n)),this}clone(){return new Zi(this.rgb)}alpha(e){return this._rgb.a=Kn(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=po(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Vo(this._rgb,2,e),this}darken(e){return Vo(this._rgb,2,-e),this}saturate(e){return Vo(this._rgb,1,e),this}desaturate(e){return Vo(this._rgb,1,-e),this}rotate(e){return tC(this._rgb,e),this}}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function on(){}const dC=(()=>{let t=0;return()=>t++})();function fe(t){return t==null}function Ee(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function ie(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Et(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function qt(t,e){return Et(t)?t:e}function se(t,e){return typeof t>"u"?e:t}const uC=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function pe(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function ae(t,e,n,s){let r,i,a;if(Ee(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(ie(t))for(a=Object.keys(t),i=a.length,r=0;r<i;r++)e.call(n,t[a[r]],a[r])}function Ka(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Ja(t){if(Ee(t))return t.map(Ja);if(ie(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=Ja(t[n[r]]);return e}return t}function oy(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function hC(t,e,n,s){if(!oy(t))return;const r=e[t],i=n[t];ie(r)&&ie(i)?eo(r,i,s):e[t]=Ja(i)}function eo(t,e,n){const s=Ee(e)?e:[e],r=s.length;if(!ie(t))return t;n=n||{};const i=n.merger||hC;let a;for(let l=0;l<r;++l){if(a=s[l],!ie(a))continue;const c=Object.keys(a);for(let d=0,u=c.length;d<u;++d)i(c[d],t,a,n)}return t}function Si(t,e){return eo(t,e,{merger:fC})}function fC(t,e,n){if(!oy(t))return;const s=e[t],r=n[t];ie(s)&&ie(r)?Si(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Ja(r))}const pm={"":t=>t,x:t=>t.x,y:t=>t.y};function mC(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function pC(t){const e=mC(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function kr(t,e){return(pm[e]||(pm[e]=pC(e)))(t)}function rh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const to=t=>typeof t<"u",es=t=>typeof t=="function",gm=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function gC(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const De=Math.PI,nn=2*De,xC=nn+De,Xa=Number.POSITIVE_INFINITY,yC=De/180,Bt=De/2,as=De/4,xm=De*2/3,$d=Math.log10,sn=Math.sign;function ki(t,e,n){return Math.abs(t-e)<n}function ym(t){const e=Math.round(t);t=ki(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor($d(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function vC(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function no(t){return!isNaN(parseFloat(t))&&isFinite(t)}function bC(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function wC(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function bs(t){return t*(De/180)}function _C(t){return t*(180/De)}function vm(t){if(!Et(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function jC(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*De&&(i+=nn),{angle:i,distance:r}}function zd(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function NC(t,e){return(t-e+xC)%nn-De}function Pn(t){return(t%nn+nn)%nn}function ay(t,e,n,s){const r=Pn(t),i=Pn(e),a=Pn(n),l=Pn(i-r),c=Pn(a-r),d=Pn(r-i),u=Pn(r-a);return r===i||r===a||s&&i===a||l>c&&d<u}function mt(t,e,n){return Math.max(e,Math.min(n,t))}function SC(t){return mt(t,-32768,32767)}function ws(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function ih(t,e,n){n=n||(a=>t[a]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const _s=(t,e,n,s)=>ih(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),kC=(t,e,n)=>ih(t,n,s=>t[s][e]>=n);function CC(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const ly=["push","pop","shift","splice","unshift"];function PC(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ly.forEach(n=>{const s="_onData"+rh(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const a=r.apply(this,i);return t._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...i)}),a}})})}function bm(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(ly.forEach(i=>{delete t[i]}),delete t._chartjs)}function cy(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const dy=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function uy(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,dy.call(window,()=>{s=!1,t.apply(e,n)}))}}function EC(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const oh=t=>t==="start"?"left":t==="end"?"right":"center",He=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,MC=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function TC(t,e,n){const s=e.length;let r=0,i=s;if(t._sorted){const{iScale:a,_parsed:l}=t,c=a.axis,{min:d,max:u,minDefined:h,maxDefined:f}=a.getUserBounds();h&&(r=mt(Math.min(_s(l,c,d).lo,n?s:_s(e,c,a.getPixelForValue(d)).lo),0,s-1)),f?i=mt(Math.max(_s(l,a.axis,u,!0).hi+1,n?0:_s(e,c,a.getPixelForValue(u),!0).hi+1),r,s)-r:i=s-r}return{start:r,count:i}}function OC(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const i=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const Wo=t=>t===0||t===1,wm=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*nn/n)),_m=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*nn/n)+1,Ci={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Bt)+1,easeOutSine:t=>Math.sin(t*Bt),easeInOutSine:t=>-.5*(Math.cos(De*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Wo(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Wo(t)?t:wm(t,.075,.3),easeOutElastic:t=>Wo(t)?t:_m(t,.075,.3),easeInOutElastic(t){return Wo(t)?t:t<.5?.5*wm(t*2,.1125,.45):.5+.5*_m(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Ci.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Ci.easeInBounce(t*2)*.5:Ci.easeOutBounce(t*2-1)*.5+.5};function ah(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function jm(t){return ah(t)?t:new Zi(t)}function Sc(t){return ah(t)?t:new Zi(t).saturate(.5).darken(.1).hexString()}const AC=["x","y","borderWidth","radius","tension"],RC=["color","borderColor","backgroundColor"];function DC(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:RC},numbers:{type:"number",properties:AC}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function IC(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Nm=new Map;function LC(t,e){e=e||{};const n=t+JSON.stringify(e);let s=Nm.get(n);return s||(s=new Intl.NumberFormat(t,e),Nm.set(n,s)),s}function hy(t,e,n){return LC(e,n).format(t)}const fy={values(t){return Ee(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const d=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(d<1e-4||d>1e15)&&(r="scientific"),i=FC(t,n)}const a=$d(Math.abs(i)),l=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),hy(t,s,c)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor($d(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?fy.numeric.call(this,t,e,n):""}};function FC(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var my={formatters:fy};function BC(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:my.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ts=Object.create(null),Ud=Object.create(null);function Pi(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function kc(t,e,n){return typeof e=="string"?eo(Pi(t,e),n):eo(Pi(t,""),e)}class $C{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Sc(r.backgroundColor),this.hoverBorderColor=(s,r)=>Sc(r.borderColor),this.hoverColor=(s,r)=>Sc(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return kc(this,e,n)}get(e){return Pi(this,e)}describe(e,n){return kc(Ud,e,n)}override(e,n){return kc(Ts,e,n)}route(e,n,s,r){const i=Pi(this,e),a=Pi(this,s),l="_"+n;Object.defineProperties(i,{[l]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const c=this[l],d=a[r];return ie(c)?Object.assign({},d,c):se(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(n=>n(this))}}var ke=new $C({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[DC,IC,BC]);function zC(t){return!t||fe(t.size)||fe(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Sm(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function ls(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function km(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Vd(t,e,n,s){py(t,e,n,s,null)}function py(t,e,n,s,r){let i,a,l,c,d,u,h,f;const m=e.pointStyle,x=e.rotation,g=e.radius;let y=(x||0)*yC;if(m&&typeof m=="object"&&(i=m.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(y),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),m){default:r?t.ellipse(n,s,r/2,g,0,0,nn):t.arc(n,s,g,0,nn),t.closePath();break;case"triangle":u=r?r/2:g,t.moveTo(n+Math.sin(y)*u,s-Math.cos(y)*g),y+=xm,t.lineTo(n+Math.sin(y)*u,s-Math.cos(y)*g),y+=xm,t.lineTo(n+Math.sin(y)*u,s-Math.cos(y)*g),t.closePath();break;case"rectRounded":d=g*.516,c=g-d,a=Math.cos(y+as)*c,h=Math.cos(y+as)*(r?r/2-d:c),l=Math.sin(y+as)*c,f=Math.sin(y+as)*(r?r/2-d:c),t.arc(n-h,s-l,d,y-De,y-Bt),t.arc(n+f,s-a,d,y-Bt,y),t.arc(n+h,s+l,d,y,y+Bt),t.arc(n-f,s+a,d,y+Bt,y+De),t.closePath();break;case"rect":if(!x){c=Math.SQRT1_2*g,u=r?r/2:c,t.rect(n-u,s-c,2*u,2*c);break}y+=as;case"rectRot":h=Math.cos(y)*(r?r/2:g),a=Math.cos(y)*g,l=Math.sin(y)*g,f=Math.sin(y)*(r?r/2:g),t.moveTo(n-h,s-l),t.lineTo(n+f,s-a),t.lineTo(n+h,s+l),t.lineTo(n-f,s+a),t.closePath();break;case"crossRot":y+=as;case"cross":h=Math.cos(y)*(r?r/2:g),a=Math.cos(y)*g,l=Math.sin(y)*g,f=Math.sin(y)*(r?r/2:g),t.moveTo(n-h,s-l),t.lineTo(n+h,s+l),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a);break;case"star":h=Math.cos(y)*(r?r/2:g),a=Math.cos(y)*g,l=Math.sin(y)*g,f=Math.sin(y)*(r?r/2:g),t.moveTo(n-h,s-l),t.lineTo(n+h,s+l),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a),y+=as,h=Math.cos(y)*(r?r/2:g),a=Math.cos(y)*g,l=Math.sin(y)*g,f=Math.sin(y)*(r?r/2:g),t.moveTo(n-h,s-l),t.lineTo(n+h,s+l),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a);break;case"line":a=r?r/2:Math.cos(y)*g,l=Math.sin(y)*g,t.moveTo(n-a,s-l),t.lineTo(n+a,s+l);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(y)*(r?r/2:g),s+Math.sin(y)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function so(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function lh(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function ch(t){t.restore()}function UC(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function VC(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function WC(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),fe(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function HC(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),a=e-i.actualBoundingBoxLeft,l=e+i.actualBoundingBoxRight,c=n-i.actualBoundingBoxAscent,d=n+i.actualBoundingBoxDescent,u=r.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(a,u),t.lineTo(l,u),t.stroke()}}function qC(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function ro(t,e,n,s,r,i={}){const a=Ee(e)?e:[e],l=i.strokeWidth>0&&i.strokeColor!=="";let c,d;for(t.save(),t.font=r.string,WC(t,i),c=0;c<a.length;++c)d=a[c],i.backdrop&&qC(t,i.backdrop),l&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),fe(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(d,n,s,i.maxWidth)),t.fillText(d,n,s,i.maxWidth),HC(t,n,s,d,i),s+=Number(r.lineHeight);t.restore()}function Za(t,e){const{x:n,y:s,w:r,h:i,radius:a}=e;t.arc(n+a.topLeft,s+a.topLeft,a.topLeft,1.5*De,De,!0),t.lineTo(n,s+i-a.bottomLeft),t.arc(n+a.bottomLeft,s+i-a.bottomLeft,a.bottomLeft,De,Bt,!0),t.lineTo(n+r-a.bottomRight,s+i),t.arc(n+r-a.bottomRight,s+i-a.bottomRight,a.bottomRight,Bt,0,!0),t.lineTo(n+r,s+a.topRight),t.arc(n+r-a.topRight,s+a.topRight,a.topRight,0,-Bt,!0),t.lineTo(n+a.topLeft,s)}const YC=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,QC=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function GC(t,e){const n=(""+t).match(YC);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const KC=t=>+t||0;function gy(t,e){const n={},s=ie(e),r=s?Object.keys(e):e,i=ie(t)?s?a=>se(t[a],t[e[a]]):a=>t[a]:()=>t;for(const a of r)n[a]=KC(i(a));return n}function xy(t){return gy(t,{top:"y",right:"x",bottom:"y",left:"x"})}function dr(t){return gy(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Mt(t){const e=xy(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ye(t,e){t=t||{},e=e||ke.font;let n=se(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=se(t.style,e.style);s&&!(""+s).match(QC)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:se(t.family,e.family),lineHeight:GC(se(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:se(t.weight,e.weight),string:""};return r.string=zC(r),r}function Ho(t,e,n,s){let r,i,a;for(r=0,i=t.length;r<i;++r)if(a=t[r],a!==void 0&&a!==void 0)return a}function JC(t,e,n){const{min:s,max:r}=t,i=uC(e,(r-s)/2),a=(l,c)=>n&&l===0?0:l+c;return{min:a(s,-Math.abs(i)),max:a(r,i)}}function Is(t,e){return Object.assign(Object.create(t),e)}function dh(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=wy("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:l=>dh([l,...t],e,i,s)};return new Proxy(a,{deleteProperty(l,c){return delete l[c],delete l._keys,delete t[0][c],!0},get(l,c){return vy(l,c,()=>iP(c,e,t,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(l,c){return Pm(l).includes(c)},ownKeys(l){return Pm(l)},set(l,c,d){const u=l._storage||(l._storage=r());return l[c]=u[c]=d,delete l._keys,!0}})}function Cr(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:yy(t,s),setContext:i=>Cr(t,i,n,s),override:i=>Cr(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,a){return delete i[a],delete t[a],!0},get(i,a,l){return vy(i,a,()=>ZC(i,a,l))},getOwnPropertyDescriptor(i,a){return i._descriptors.allKeys?Reflect.has(t,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,a)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,a){return Reflect.has(t,a)},ownKeys(){return Reflect.ownKeys(t)},set(i,a,l){return t[a]=l,delete i[a],!0}})}function yy(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:es(n)?n:()=>n,isIndexable:es(s)?s:()=>s}}const XC=(t,e)=>t?t+rh(e):e,uh=(t,e)=>ie(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function vy(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function ZC(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:a}=t;let l=s[e];return es(l)&&a.isScriptable(e)&&(l=eP(e,l,t,n)),Ee(l)&&l.length&&(l=tP(e,l,t,a.isIndexable)),uh(e,l)&&(l=Cr(l,r,i&&i[e],a)),l}function eP(t,e,n,s){const{_proxy:r,_context:i,_subProxy:a,_stack:l}=n;if(l.has(t))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+t);l.add(t);let c=e(i,a||s);return l.delete(t),uh(t,c)&&(c=hh(r._scopes,r,t,c)),c}function tP(t,e,n,s){const{_proxy:r,_context:i,_subProxy:a,_descriptors:l}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(ie(e[0])){const c=e,d=r._scopes.filter(u=>u!==c);e=[];for(const u of c){const h=hh(d,r,t,u);e.push(Cr(h,i,a&&a[t],l))}}return e}function by(t,e,n){return es(t)?t(e,n):t}const nP=(t,e)=>t===!0?e:typeof t=="string"?kr(e,t):void 0;function sP(t,e,n,s,r){for(const i of e){const a=nP(n,i);if(a){t.add(a);const l=by(a._fallback,n,r);if(typeof l<"u"&&l!==n&&l!==s)return l}else if(a===!1&&typeof s<"u"&&n!==s)return null}return!1}function hh(t,e,n,s){const r=e._rootScopes,i=by(e._fallback,n,s),a=[...t,...r],l=new Set;l.add(s);let c=Cm(l,a,n,i||n,s);return c===null||typeof i<"u"&&i!==n&&(c=Cm(l,a,i,c,s),c===null)?!1:dh(Array.from(l),[""],r,i,()=>rP(e,n,s))}function Cm(t,e,n,s,r){for(;n;)n=sP(t,e,n,s,r);return n}function rP(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Ee(r)&&ie(n)?n:r||{}}function iP(t,e,n,s){let r;for(const i of e)if(r=wy(XC(i,t),n),typeof r<"u")return uh(t,r)?hh(n,s,t,r):r}function wy(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function Pm(t){let e=t._keys;return e||(e=t._keys=oP(t._scopes)),e}function oP(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const aP=Number.EPSILON||1e-14,Pr=(t,e)=>e<t.length&&!t[e].skip&&t[e],_y=t=>t==="x"?"y":"x";function lP(t,e,n,s){const r=t.skip?e:t,i=e,a=n.skip?e:n,l=zd(i,r),c=zd(a,i);let d=l/(l+c),u=c/(l+c);d=isNaN(d)?0:d,u=isNaN(u)?0:u;const h=s*d,f=s*u;return{previous:{x:i.x-h*(a.x-r.x),y:i.y-h*(a.y-r.y)},next:{x:i.x+f*(a.x-r.x),y:i.y+f*(a.y-r.y)}}}function cP(t,e,n){const s=t.length;let r,i,a,l,c,d=Pr(t,0);for(let u=0;u<s-1;++u)if(c=d,d=Pr(t,u+1),!(!c||!d)){if(ki(e[u],0,aP)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],i=n[u+1]/e[u],l=Math.pow(r,2)+Math.pow(i,2),!(l<=9)&&(a=3/Math.sqrt(l),n[u]=r*a*e[u],n[u+1]=i*a*e[u])}}function dP(t,e,n="x"){const s=_y(n),r=t.length;let i,a,l,c=Pr(t,0);for(let d=0;d<r;++d){if(a=l,l=c,c=Pr(t,d+1),!l)continue;const u=l[n],h=l[s];a&&(i=(u-a[n])/3,l[`cp1${n}`]=u-i,l[`cp1${s}`]=h-i*e[d]),c&&(i=(c[n]-u)/3,l[`cp2${n}`]=u+i,l[`cp2${s}`]=h+i*e[d])}}function uP(t,e="x"){const n=_y(e),s=t.length,r=Array(s).fill(0),i=Array(s);let a,l,c,d=Pr(t,0);for(a=0;a<s;++a)if(l=c,c=d,d=Pr(t,a+1),!!c){if(d){const u=d[e]-c[e];r[a]=u!==0?(d[n]-c[n])/u:0}i[a]=l?d?sn(r[a-1])!==sn(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}cP(t,r,i),dP(t,i,e)}function qo(t,e,n){return Math.max(Math.min(t,n),e)}function hP(t,e){let n,s,r,i,a,l=so(t[0],e);for(n=0,s=t.length;n<s;++n)a=i,i=l,l=n<s-1&&so(t[n+1],e),i&&(r=t[n],a&&(r.cp1x=qo(r.cp1x,e.left,e.right),r.cp1y=qo(r.cp1y,e.top,e.bottom)),l&&(r.cp2x=qo(r.cp2x,e.left,e.right),r.cp2y=qo(r.cp2y,e.top,e.bottom)))}function fP(t,e,n,s,r){let i,a,l,c;if(e.spanGaps&&(t=t.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")uP(t,r);else{let d=s?t[t.length-1]:t[0];for(i=0,a=t.length;i<a;++i)l=t[i],c=lP(d,l,t[Math.min(i+1,a-(s?0:1))%a],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&hP(t,n)}function fh(){return typeof window<"u"&&typeof document<"u"}function mh(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function el(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Bl=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function mP(t,e){return Bl(t).getPropertyValue(e)}const pP=["top","right","bottom","left"];function Ss(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=pP[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const gP=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function xP(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let a=!1,l,c;if(gP(r,i,t.target))l=r,c=i;else{const d=e.getBoundingClientRect();l=s.clientX-d.left,c=s.clientY-d.top,a=!0}return{x:l,y:c,box:a}}function ms(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Bl(n),i=r.boxSizing==="border-box",a=Ss(r,"padding"),l=Ss(r,"border","width"),{x:c,y:d,box:u}=xP(t,n),h=a.left+(u&&l.left),f=a.top+(u&&l.top);let{width:m,height:x}=e;return i&&(m-=a.width+l.width,x-=a.height+l.height),{x:Math.round((c-h)/m*n.width/s),y:Math.round((d-f)/x*n.height/s)}}function yP(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&mh(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const a=i.getBoundingClientRect(),l=Bl(i),c=Ss(l,"border","width"),d=Ss(l,"padding");e=a.width-d.width-c.width,n=a.height-d.height-c.height,s=el(l.maxWidth,i,"clientWidth"),r=el(l.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||Xa,maxHeight:r||Xa}}const Yo=t=>Math.round(t*10)/10;function vP(t,e,n,s){const r=Bl(t),i=Ss(r,"margin"),a=el(r.maxWidth,t,"clientWidth")||Xa,l=el(r.maxHeight,t,"clientHeight")||Xa,c=yP(t,e,n);let{width:d,height:u}=c;if(r.boxSizing==="content-box"){const f=Ss(r,"border","width"),m=Ss(r,"padding");d-=m.width+f.width,u-=m.height+f.height}return d=Math.max(0,d-i.width),u=Math.max(0,s?d/s:u-i.height),d=Yo(Math.min(d,a,c.maxWidth)),u=Yo(Math.min(u,l,c.maxHeight)),d&&!u&&(u=Yo(d/2)),(e!==void 0||n!==void 0)&&s&&c.height&&u>c.height&&(u=c.height,d=Yo(Math.floor(u*s))),{width:d,height:u}}function Em(t,e,n){const s=e||1,r=Math.floor(t.height*s),i=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const a=t.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||a.height!==r||a.width!==i?(t.currentDevicePixelRatio=s,a.height=r,a.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const bP=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};fh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Mm(t,e){const n=mP(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function ps(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function wP(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function _P(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},a=ps(t,r,n),l=ps(r,i,n),c=ps(i,e,n),d=ps(a,l,n),u=ps(l,c,n);return ps(d,u,n)}const jP=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},NP=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function ur(t,e,n){return t?jP(e,n):NP()}function jy(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function Ny(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Sy(t){return t==="angle"?{between:ay,compare:NC,normalize:Pn}:{between:ws,compare:(e,n)=>e-n,normalize:e=>e}}function Tm({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function SP(t,e,n){const{property:s,start:r,end:i}=n,{between:a,normalize:l}=Sy(s),c=e.length;let{start:d,end:u,loop:h}=t,f,m;if(h){for(d+=c,u+=c,f=0,m=c;f<m&&a(l(e[d%c][s]),r,i);++f)d--,u--;d%=c,u%=c}return u<d&&(u+=c),{start:d,end:u,loop:h,style:t.style}}function kP(t,e,n){if(!n)return[t];const{property:s,start:r,end:i}=n,a=e.length,{compare:l,between:c,normalize:d}=Sy(s),{start:u,end:h,loop:f,style:m}=SP(t,e,n),x=[];let g=!1,y=null,v,p,b;const j=()=>c(r,b,v)&&l(r,b)!==0,_=()=>l(i,v)===0||c(i,b,v),C=()=>g||j(),S=()=>!g||_();for(let k=u,A=u;k<=h;++k)p=e[k%a],!p.skip&&(v=d(p[s]),v!==b&&(g=c(v,r,i),y===null&&C()&&(y=l(v,r)===0?k:A),y!==null&&S()&&(x.push(Tm({start:y,end:k,loop:f,count:a,style:m})),y=null),A=k,b=v));return y!==null&&x.push(Tm({start:y,end:h,loop:f,count:a,style:m})),x}function CP(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const i=kP(s[r],t.points,e);i.length&&n.push(...i)}return n}function PP(t,e,n,s){let r=0,i=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(i+=r);i>r&&t[i%e].skip;)i--;return i%=e,{start:r,end:i}}function EP(t,e,n,s){const r=t.length,i=[];let a=e,l=t[e],c;for(c=e+1;c<=n;++c){const d=t[c%r];d.skip||d.stop?l.skip||(s=!1,i.push({start:e%r,end:(c-1)%r,loop:s}),e=a=d.stop?c:null):(a=c,l.skip&&(e=c)),l=d}return a!==null&&i.push({start:e%r,end:a%r,loop:s}),i}function MP(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const i=!!t._loop,{start:a,end:l}=PP(n,r,i,s);if(s===!0)return Om(t,[{start:a,end:l,loop:i}],n,e);const c=l<a?l+r:l,d=!!t._fullLoop&&a===0&&l===r-1;return Om(t,EP(n,a,c,d),n,e)}function Om(t,e,n,s){return!s||!s.setContext||!n?e:TP(t,e,n,s)}function TP(t,e,n,s){const r=t._chart.getContext(),i=Am(t.options),{_datasetIndex:a,options:{spanGaps:l}}=t,c=n.length,d=[];let u=i,h=e[0].start,f=h;function m(x,g,y,v){const p=l?-1:1;if(x!==g){for(x+=c;n[x%c].skip;)x-=p;for(;n[g%c].skip;)g+=p;x%c!==g%c&&(d.push({start:x%c,end:g%c,loop:y,style:v}),u=v,h=g%c)}}for(const x of e){h=l?h:x.start;let g=n[h%c],y;for(f=h+1;f<=x.end;f++){const v=n[f%c];y=Am(s.setContext(Is(r,{type:"segment",p0:g,p1:v,p0DataIndex:(f-1)%c,p1DataIndex:f%c,datasetIndex:a}))),OP(y,u)&&m(h,f-1,x.loop,u),g=v,u=y}h<f-1&&m(h,f-1,x.loop,u)}return d}function Am(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function OP(t,e){if(!e)return!1;const n=[],s=function(r,i){return ah(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,s)!==JSON.stringify(e,s)}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class AP{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],a=n.duration;i.forEach(l=>l({chart:e,initial:n.initial,numSteps:a,currentStep:Math.min(s-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=dy.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let a=i.length-1,l=!1,c;for(;a>=0;--a)c=i[a],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(i[a]=i[i.length-1],i.pop());l&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var an=new AP;const Rm="transparent",RP={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=jm(t||Rm),r=s.valid&&jm(e||Rm);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class DP{constructor(e,n,s,r){const i=n[s];r=Ho([e.to,r,i,e.from]);const a=Ho([e.from,i,r]);this._active=!0,this._fn=e.fn||RP[e.type||typeof a],this._easing=Ci[e.easing]||Ci.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,a=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Ho([e.to,n,r,e.from]),this._from=Ho([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,a=this._loop,l=this._to;let c;if(this._active=i!==l&&(a||n<s),!this._active){this._target[r]=l,this._notify(!0);return}if(n<0){this._target[r]=i;return}c=n/s%2,c=a&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(i,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class ky{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!ie(e))return;const n=Object.keys(ke.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!ie(i))return;const a={};for(const l of n)a[l]=i[l];(Ee(i.properties)&&i.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,a)})})}_animateOptions(e,n){const s=n.options,r=LP(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&IP(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),a=Object.keys(n),l=Date.now();let c;for(c=a.length-1;c>=0;--c){const d=a[c];if(d.charAt(0)==="$")continue;if(d==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[d];let h=i[d];const f=s.get(d);if(h)if(f&&h.active()){h.update(f,u,l);continue}else h.cancel();if(!f||!f.duration){e[d]=u;continue}i[d]=h=new DP(f,e,d,u),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return an.add(this._chart,s),!0}}function IP(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function LP(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Dm(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function FP(t,e,n){if(n===!1)return!1;const s=Dm(t,n),r=Dm(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function BP(t){let e,n,s,r;return ie(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function Cy(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function Im(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let a,l,c,d;if(e===null)return;let u=!1;for(a=0,l=r.length;a<l;++a){if(c=+r[a],c===n){if(u=!0,s.all)continue;break}d=t.values[c],Et(d)&&(i||e===0||sn(e)===sn(d))&&(e+=d)}return!u&&!s.all?0:e}function $P(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",a=Object.keys(t),l=new Array(a.length);let c,d,u;for(c=0,d=a.length;c<d;++c)u=a[c],l[c]={[r]:u,[i]:t[u]};return l}function Cc(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function zP(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function UP(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function VP(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function Lm(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function Fm(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:a,index:l}=s,c=i.axis,d=a.axis,u=zP(i,a,s),h=e.length;let f;for(let m=0;m<h;++m){const x=e[m],{[c]:g,[d]:y}=x,v=x._stacks||(x._stacks={});f=v[d]=VP(r,u,g),f[l]=y,f._top=Lm(f,a,!0,s.type),f._bottom=Lm(f,a,!1,s.type);const p=f._visualValues||(f._visualValues={});p[l]=y}}function Pc(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function WP(t,e){return Is(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function HP(t,e,n){return Is(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Zr(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const Ec=t=>t==="reset"||t==="none",Bm=(t,e)=>e?t:Object.assign({},t),qP=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Cy(n,!0),values:null};class hr{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Cc(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Zr(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,m,x)=>h==="x"?f:h==="r"?x:m,i=n.xAxisID=se(s.xAxisID,Pc(e,"x")),a=n.yAxisID=se(s.yAxisID,Pc(e,"y")),l=n.rAxisID=se(s.rAxisID,Pc(e,"r")),c=n.indexAxis,d=n.iAxisID=r(c,i,a,l),u=n.vAxisID=r(c,a,i,l);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(d),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&bm(this._data,this),e._stacked&&Zr(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(ie(n)){const r=this._cachedMeta;this._data=$P(n,r)}else if(s!==n){if(s){bm(s,this);const r=this._cachedMeta;Zr(r),r._parsed=[]}n&&Object.isExtensible(n)&&PC(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=Cc(n.vScale,n),n.stack!==s.stack&&(r=!0,Zr(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(Fm(this,n._parsed),n._stacked=Cc(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:a}=s,l=i.axis;let c=e===0&&n===r.length?!0:s._sorted,d=e>0&&s._parsed[e-1],u,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{Ee(r[e])?f=this.parseArrayData(s,r,e,n):ie(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const m=()=>h[l]===null||d&&h[l]<d[l];for(u=0;u<n;++u)s._parsed[u+e]=h=f[u],c&&(m()&&(c=!1),d=h);s._sorted=c}a&&Fm(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:a}=e,l=i.axis,c=a.axis,d=i.getLabels(),u=i===a,h=new Array(r);let f,m,x;for(f=0,m=r;f<m;++f)x=f+s,h[f]={[l]:u||i.parse(d[x],x),[c]:a.parse(n[x],x)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:a}=e,l=new Array(r);let c,d,u,h;for(c=0,d=r;c<d;++c)u=c+s,h=n[u],l[c]={x:i.parse(h[0],u),y:a.parse(h[1],u)};return l}parseObjectData(e,n,s,r){const{xScale:i,yScale:a}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(r);let u,h,f,m;for(u=0,h=r;u<h;++u)f=u+s,m=n[f],d[u]={x:i.parse(kr(m,l),f),y:a.parse(kr(m,c),f)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,a=n[e.axis],l={keys:Cy(r,!0),values:n._stacks[e.axis]._visualValues};return Im(l,a,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let a=i===null?NaN:i;const l=r&&s._stacks[n.axis];r&&l&&(r.values=l,a=Im(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,a=r.length,l=this._getOtherScale(e),c=qP(n,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=UP(l);let f,m;function x(){m=r[f];const g=m[l.axis];return!Et(m[e.axis])||u>g||h<g}for(f=0;f<a&&!(!x()&&(this.updateRangeFromParsed(d,e,m,c),i));++f);if(i){for(f=a-1;f>=0;--f)if(!x()){this.updateRangeFromParsed(d,e,m,c);break}}return d}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,a;for(r=0,i=n.length;r<i;++r)a=n[r][e.axis],Et(a)&&s.push(a);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=BP(se(this.options.clip,FP(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,a=[],l=this._drawStart||0,c=this._drawCount||r.length-l,d=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,i,l,c),u=l;u<l+c;++u){const h=r[u];h.hidden||(h.active&&d?a.push(h):h.draw(e,i))}for(u=0;u<a.length;++u)a[u].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];i=a.$context||(a.$context=HP(this.getContext(),e,a)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=WP(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,a=e+"-"+n,l=i[a],c=this.enableOptionSharing&&to(s);if(l)return Bm(l,c);const d=this.chart.config,u=d.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=d.getOptionScopes(this.getDataset(),u),m=Object.keys(ke.elements[e]),x=()=>this.getContext(s,r,n),g=d.resolveNamedOptions(f,m,x,h);return g.$shared&&(g.$shared=c,i[a]=Object.freeze(Bm(g,c))),g}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,a=`animation-${n}`,l=i[a];if(l)return l;let c;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),f=u.getOptionScopes(this.getDataset(),h);c=u.createResolver(f,this.getContext(e,s,n))}const d=new ky(r,c&&c.animations);return c&&c._cacheable&&(i[a]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Ec(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),a=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:a}}updateElement(e,n,s,r){Ec(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Ec(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const r=s.length,i=n.length,a=Math.min(i,r);a&&this.parse(0,a),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,a=e+n;let l;const c=d=>{for(d.length+=n,l=d.length-1;l>=a;l--)d[l]=d[l-n]};for(c(i),l=e;l<a;++l)i[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Zr(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Q(hr,"defaults",{}),Q(hr,"datasetElementType",null),Q(hr,"dataElementType",null);function YP(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=cy(s.sort((r,i)=>r-i))}return t._cache.$bar}function QP(t){const e=t.iScale,n=YP(e,t.type);let s=e._length,r,i,a,l;const c=()=>{a===32767||a===-32768||(to(l)&&(s=Math.min(s,Math.abs(a-l)||s)),l=a)};for(r=0,i=n.length;r<i;++r)a=e.getPixelForValue(n[r]),c();for(l=void 0,r=0,i=e.ticks.length;r<i;++r)a=e.getPixelForTick(r),c();return s}function GP(t,e,n,s){const r=n.barThickness;let i,a;return fe(r)?(i=e.min*n.categoryPercentage,a=n.barPercentage):(i=r*s,a=1),{chunk:i/s,ratio:a,start:e.pixels[t]-i/2}}function KP(t,e,n,s){const r=e.pixels,i=r[t];let a=t>0?r[t-1]:null,l=t<r.length-1?r[t+1]:null;const c=n.categoryPercentage;a===null&&(a=i-(l===null?e.end-e.start:l-i)),l===null&&(l=i+i-a);const d=i-(i-Math.min(a,l))/2*c;return{chunk:Math.abs(l-a)/2*c/s,ratio:n.barPercentage,start:d}}function JP(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),a=Math.min(r,i),l=Math.max(r,i);let c=a,d=l;Math.abs(a)>Math.abs(l)&&(c=l,d=a),e[n.axis]=d,e._custom={barStart:c,barEnd:d,start:r,end:i,min:a,max:l}}function Py(t,e,n,s){return Ee(t)?JP(t,e,n,s):e[n.axis]=n.parse(t,s),e}function $m(t,e,n,s){const r=t.iScale,i=t.vScale,a=r.getLabels(),l=r===i,c=[];let d,u,h,f;for(d=n,u=n+s;d<u;++d)f=e[d],h={},h[r.axis]=l||r.parse(a[d],d),c.push(Py(f,h,i,d));return c}function Mc(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function XP(t,e,n){return t!==0?sn(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function ZP(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function eE(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:l,reverse:c,top:d,bottom:u}=ZP(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=d:(n._bottom||0)===s?r=u:(i[zm(u,a,l,c)]=!0,r=d)),i[zm(r,a,l,c)]=!0,t.borderSkipped=i}function zm(t,e,n,s){return s?(t=tE(t,e,n),t=Um(t,n,e)):t=Um(t,e,n),t}function tE(t,e,n){return t===e?n:t===n?e:t}function Um(t,e,n){return t==="start"?e:t==="end"?n:t}function nE(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class fa extends hr{parsePrimitiveData(e,n,s,r){return $m(e,n,s,r)}parseArrayData(e,n,s,r){return $m(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:a}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=i.axis==="x"?l:c,u=a.axis==="x"?l:c,h=[];let f,m,x,g;for(f=s,m=s+r;f<m;++f)g=n[f],x={},x[i.axis]=i.parse(kr(g,d),f),h.push(Py(kr(g,u),x,a,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),a=i._custom,l=Mc(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:a,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let m=n;m<n+s;m++){const x=this.getParsed(m),g=i||fe(x[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),y=this._calculateBarIndexPixels(m,u),v=(x._stacks||{})[l.axis],p={horizontal:d,base:g.base,enableBorderRadius:!v||Mc(x._custom)||a===v._top||a===v._bottom,x:d?g.head:y.center,y:d?y.center:g.head,height:d?y.size:Math.abs(g.size),width:d?Math.abs(g.size):y.size};f&&(p.options=h||this.resolveDataElementOptions(m,e[m].active?"active":r));const b=p.options||e[m].options;eE(p,b,v,a),nE(p,b,u.ratio),this.updateElement(e[m],m,p,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),i=s.options.stacked,a=[],l=this._cachedMeta.controller.getParsed(n),c=l&&l[s.axis],d=u=>{const h=u._parsed.find(m=>m[s.axis]===c),f=h&&h[u.vScale.axis];if(fe(f)||isNaN(f))return!0};for(const u of r)if(!(n!==void 0&&d(u))&&((i===!1||a.indexOf(u.stack)===-1||i===void 0&&u.stack===void 0)&&a.push(u.stack),u.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,a;for(i=0,a=n.data.length;i<a;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const l=e.barThickness;return{min:l||QP(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:a}}=this,l=i||0,c=this.getParsed(e),d=c._custom,u=Mc(d);let h=c[n.axis],f=0,m=s?this.applyStack(n,c,s):h,x,g;m!==h&&(f=m-h,m=h),u&&(h=d.barStart,m=d.barEnd-d.barStart,h!==0&&sn(h)!==sn(d.barEnd)&&(f=0),f+=h);const y=!fe(i)&&!u?i:f;let v=n.getPixelForValue(y);if(this.chart.getDataVisibility(e)?x=n.getPixelForValue(f+m):x=v,g=x-v,Math.abs(g)<a){g=XP(g,n,l)*a,h===l&&(v-=g/2);const p=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),j=Math.min(p,b),_=Math.max(p,b);v=Math.max(Math.min(v,_),j),x=v+g,s&&!u&&(c._stacks[n.axis]._visualValues[r]=n.getValueForPixel(x)-n.getValueForPixel(v))}if(v===n.getPixelForValue(l)){const p=sn(g)*n.getLineWidthForValue(l)/2;v+=p,g-=p}return{size:g,base:v,head:x,center:x+g/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,a=se(r.maxBarThickness,1/0);let l,c;if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,u=r.barThickness==="flex"?KP(e,n,r,d):GP(e,n,r,d),h=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0);l=u.start+u.chunk*h+u.chunk/2,c=Math.min(a,u.chunk*u.ratio)}else l=s.getPixelForValue(this.getParsed(e)[s.axis],e),c=Math.min(a,n.min*n.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}Q(fa,"id","bar"),Q(fa,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Q(fa,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class ma extends hr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,a=this.chart._animationsDisabled;let{start:l,count:c}=TC(n,r,a);this._drawStart=l,this._drawCount=c,OC(n)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(s,void 0,{animated:!a,options:d},e),this.updateElements(r,l,c,e)}updateElements(e,n,s,r){const i=r==="reset",{iScale:a,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),f=a.axis,m=l.axis,{spanGaps:x,segment:g}=this.options,y=no(x)?x:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||i||r==="none",p=n+s,b=e.length;let j=n>0&&this.getParsed(n-1);for(let _=0;_<b;++_){const C=e[_],S=v?C:{};if(_<n||_>=p){S.skip=!0;continue}const k=this.getParsed(_),A=fe(k[m]),P=S[f]=a.getPixelForValue(k[f],_),D=S[m]=i||A?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,k,c):k[m],_);S.skip=isNaN(P)||isNaN(D)||A,S.stop=_>0&&Math.abs(k[f]-j[f])>y,g&&(S.parsed=k,S.raw=d.data[_]),h&&(S.options=u||this.resolveDataElementOptions(_,C.active?"active":r)),v||this.updateElement(C,_,S,r),j=k}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Q(ma,"id","line"),Q(ma,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Q(ma,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function cs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ph{constructor(e){Q(this,"options");this.options=e||{}}static override(e){Object.assign(ph.prototype,e)}init(){}formats(){return cs()}parse(){return cs()}format(){return cs()}add(){return cs()}diff(){return cs()}startOf(){return cs()}endOf(){return cs()}}var sE={_date:ph};function rE(t,e,n,s){const{controller:r,data:i,_sorted:a}=t,l=r._cachedMeta.iScale;if(l&&e===l.axis&&e!=="r"&&a&&i.length){const c=l._reversePixels?kC:_s;if(s){if(r._sharedOptions){const d=i[0],u=typeof d.getRange=="function"&&d.getRange(e);if(u){const h=c(i,e,n-u),f=c(i,e,n+u);return{lo:h.lo,hi:f.hi}}}}else return c(i,e,n)}return{lo:0,hi:i.length-1}}function go(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),a=n[e];for(let l=0,c=i.length;l<c;++l){const{index:d,data:u}=i[l],{lo:h,hi:f}=rE(i[l],e,a,r);for(let m=h;m<=f;++m){const x=u[m];x.skip||s(x,d,m)}}}function iE(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,a=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(a,2))}}function Tc(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||go(t,n,e,function(l,c,d){!r&&!so(l,t.chartArea,0)||l.inRange(e.x,e.y,s)&&i.push({element:l,datasetIndex:c,index:d})},!0),i}function oE(t,e,n,s){let r=[];function i(a,l,c){const{startAngle:d,endAngle:u}=a.getProps(["startAngle","endAngle"],s),{angle:h}=jC(a,{x:e.x,y:e.y});ay(h,d,u)&&r.push({element:a,datasetIndex:l,index:c})}return go(t,n,e,i),r}function aE(t,e,n,s,r,i){let a=[];const l=iE(n);let c=Number.POSITIVE_INFINITY;function d(u,h,f){const m=u.inRange(e.x,e.y,r);if(s&&!m)return;const x=u.getCenterPoint(r);if(!(!!i||t.isPointInArea(x))&&!m)return;const y=l(e,x);y<c?(a=[{element:u,datasetIndex:h,index:f}],c=y):y===c&&a.push({element:u,datasetIndex:h,index:f})}return go(t,n,e,d),a}function Oc(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?oE(t,e,n,r):aE(t,e,n,s,r,i)}function Vm(t,e,n,s,r){const i=[],a=n==="x"?"inXRange":"inYRange";let l=!1;return go(t,n,e,(c,d,u)=>{c[a]&&c[a](e[n],r)&&(i.push({element:c,datasetIndex:d,index:u}),l=l||c.inRange(e.x,e.y,r))}),s&&!l?[]:i}var lE={evaluateInteractionItems:go,modes:{index(t,e,n,s){const r=ms(e,t),i=n.axis||"x",a=n.includeInvisible||!1,l=n.intersect?Tc(t,r,i,s,a):Oc(t,r,i,!1,s,a),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const u=l[0].index,h=d.data[u];h&&!h.skip&&c.push({element:h,datasetIndex:d.index,index:u})}),c):[]},dataset(t,e,n,s){const r=ms(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;let l=n.intersect?Tc(t,r,i,s,a):Oc(t,r,i,!1,s,a);if(l.length>0){const c=l[0].datasetIndex,d=t.getDatasetMeta(c).data;l=[];for(let u=0;u<d.length;++u)l.push({element:d[u],datasetIndex:c,index:u})}return l},point(t,e,n,s){const r=ms(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;return Tc(t,r,i,s,a)},nearest(t,e,n,s){const r=ms(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;return Oc(t,r,i,n.intersect,s,a)},x(t,e,n,s){const r=ms(e,t);return Vm(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=ms(e,t);return Vm(t,r,"y",n.intersect,s)}}};const Ey=["left","top","right","bottom"];function ei(t,e){return t.filter(n=>n.pos===e)}function Wm(t,e){return t.filter(n=>Ey.indexOf(n.pos)===-1&&n.box.axis===e)}function ti(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function cE(t){const e=[];let n,s,r,i,a,l;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:a,stackWeight:l=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&i+a,stackWeight:l});return e}function dE(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!Ey.includes(r))continue;const a=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=i}return e}function uE(t,e){const n=dE(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,a,l;for(i=0,a=t.length;i<a;++i){l=t[i];const{fullSize:c}=l.box,d=n[l.stack],u=d&&l.stackWeight/d.weight;l.horizontal?(l.width=u?u*s:c&&e.availableWidth,l.height=r):(l.width=s,l.height=u?u*r:c&&e.availableHeight)}return n}function hE(t){const e=cE(t),n=ti(e.filter(d=>d.box.fullSize),!0),s=ti(ei(e,"left"),!0),r=ti(ei(e,"right")),i=ti(ei(e,"top"),!0),a=ti(ei(e,"bottom")),l=Wm(e,"x"),c=Wm(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(c).concat(a).concat(l),chartArea:ei(e,"chartArea"),vertical:s.concat(r).concat(c),horizontal:i.concat(a).concat(l)}}function Hm(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function My(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function fE(t,e,n,s){const{pos:r,box:i}=n,a=t.maxPadding;if(!ie(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&My(a,i.getPadding());const l=Math.max(0,e.outerWidth-Hm(a,t,"left","right")),c=Math.max(0,e.outerHeight-Hm(a,t,"top","bottom")),d=l!==t.w,u=c!==t.h;return t.w=l,t.h=c,n.horizontal?{same:d,other:u}:{same:u,other:d}}function mE(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function pE(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{i[a]=Math.max(e[a],n[a])}),i}return s(t?["left","right"]:["top","bottom"])}function di(t,e,n,s){const r=[];let i,a,l,c,d,u;for(i=0,a=t.length,d=0;i<a;++i){l=t[i],c=l.box,c.update(l.width||e.w,l.height||e.h,pE(l.horizontal,e));const{same:h,other:f}=fE(e,n,l,s);d|=h&&r.length,u=u||f,c.fullSize||r.push(l)}return d&&di(r,e,n,s)||u}function Qo(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function qm(t,e,n,s){const r=n.padding;let{x:i,y:a}=e;for(const l of t){const c=l.box,d=s[l.stack]||{count:1,placed:0,weight:1},u=l.stackWeight/d.weight||1;if(l.horizontal){const h=e.w*u,f=d.size||c.height;to(d.start)&&(a=d.start),c.fullSize?Qo(c,r.left,a,n.outerWidth-r.right-r.left,f):Qo(c,e.left+d.placed,a,h,f),d.start=a,d.placed+=h,a=c.bottom}else{const h=e.h*u,f=d.size||c.width;to(d.start)&&(i=d.start),c.fullSize?Qo(c,i,r.top,f,n.outerHeight-r.bottom-r.top):Qo(c,i,e.top+d.placed,f,h),d.start=i,d.placed+=h,i=c.right}}e.x=i,e.y=a}var Nt={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=Mt(t.options.layout.padding),i=Math.max(e-r.width,0),a=Math.max(n-r.height,0),l=hE(t.boxes),c=l.vertical,d=l.horizontal;ae(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const u=c.reduce((g,y)=>y.box.options&&y.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:a,vBoxMaxWidth:i/2/u,hBoxMaxHeight:a/2}),f=Object.assign({},r);My(f,Mt(s));const m=Object.assign({maxPadding:f,w:i,h:a,x:r.left,y:r.top},r),x=uE(c.concat(d),h);di(l.fullSize,m,h,x),di(c,m,h,x),di(d,m,h,x)&&di(c,m,h,x),mE(m),qm(l.leftAndTop,m,h,x),m.x+=m.w,m.y+=m.h,qm(l.rightAndBottom,m,h,x),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},ae(l.chartArea,g=>{const y=g.box;Object.assign(y,t.chartArea),y.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Ty{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class gE extends Ty{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const pa="$chartjs",xE={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ym=t=>t===null||t==="";function yE(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[pa]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ym(r)){const i=Mm(t,"width");i!==void 0&&(t.width=i)}if(Ym(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=Mm(t,"height");i!==void 0&&(t.height=i)}return t}const Oy=bP?{passive:!0}:!1;function vE(t,e,n){t&&t.addEventListener(e,n,Oy)}function bE(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Oy)}function wE(t,e){const n=xE[t.type]||t.type,{x:s,y:r}=ms(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function tl(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function _E(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let a=!1;for(const l of i)a=a||tl(l.addedNodes,s),a=a&&!tl(l.removedNodes,s);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function jE(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let a=!1;for(const l of i)a=a||tl(l.removedNodes,s),a=a&&!tl(l.addedNodes,s);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const io=new Map;let Qm=0;function Ay(){const t=window.devicePixelRatio;t!==Qm&&(Qm=t,io.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function NE(t,e){io.size||window.addEventListener("resize",Ay),io.set(t,e)}function SE(t){io.delete(t),io.size||window.removeEventListener("resize",Ay)}function kE(t,e,n){const s=t.canvas,r=s&&mh(s);if(!r)return;const i=uy((l,c)=>{const d=r.clientWidth;n(l,c),d<r.clientWidth&&n()},window),a=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,u=c.contentRect.height;d===0&&u===0||i(d,u)});return a.observe(r),NE(t,i),a}function Ac(t,e,n){n&&n.disconnect(),e==="resize"&&SE(t)}function CE(t,e,n){const s=t.canvas,r=uy(i=>{t.ctx!==null&&n(wE(i,t))},t);return vE(s,e,r),r}class PE extends Ty{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(yE(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[pa])return!1;const s=n[pa].initial;["height","width"].forEach(i=>{const a=s[i];fe(a)?n.removeAttribute(i):n.setAttribute(i,a)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[pa],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),a={attach:_E,detach:jE,resize:kE}[n]||CE;r[n]=a(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Ac,detach:Ac,resize:Ac}[n]||bE)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return vP(e,n,s,r)}isAttached(e){const n=e&&mh(e);return!!(n&&n.isConnected)}}function EE(t){return!fh()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?gE:PE}class rn{constructor(){Q(this,"x");Q(this,"y");Q(this,"active",!1);Q(this,"options");Q(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return no(this.x)&&no(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}}Q(rn,"defaults",{}),Q(rn,"defaultRoutes");function ME(t,e){const n=t.options.ticks,s=TE(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?AE(e):[],a=i.length,l=i[0],c=i[a-1],d=[];if(a>r)return RE(e,d,i,a/r),d;const u=OE(i,e,r);if(a>0){let h,f;const m=a>1?Math.round((c-l)/(a-1)):null;for(Go(e,d,u,fe(m)?0:l-m,l),h=0,f=a-1;h<f;h++)Go(e,d,u,i[h],i[h+1]);return Go(e,d,u,c,fe(m)?e.length:c+m),d}return Go(e,d,u),d}function TE(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function OE(t,e,n){const s=DE(t),r=e.length/n;if(!s)return Math.max(r,1);const i=vC(s);for(let a=0,l=i.length-1;a<l;a++){const c=i[a];if(c>r)return c}return Math.max(r,1)}function AE(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function RE(t,e,n,s){let r=0,i=n[0],a;for(s=Math.ceil(s),a=0;a<t.length;a++)a===i&&(e.push(t[a]),r++,i=n[r*s])}function Go(t,e,n,s,r){const i=se(s,0),a=Math.min(se(r,t.length),t.length);let l=0,c,d,u;for(n=Math.ceil(n),r&&(c=r-s,n=c/Math.floor(c/n)),u=i;u<0;)l++,u=Math.round(i+l*n);for(d=Math.max(i,0);d<a;d++)d===u&&(e.push(t[d]),l++,u=Math.round(i+l*n))}function DE(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const IE=t=>t==="left"?"right":t==="right"?"left":t,Gm=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Km=(t,e)=>Math.min(e||t,t);function Jm(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function LE(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,a=t._endPixel,l=1e-6;let c=t.getPixelForTick(r),d;if(!(n&&(s===1?d=Math.max(c-i,a-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(r-1))/2,c+=r<e?d:-d,c<i-l||c>a+l)))return c}function FE(t,e){ae(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function ni(t){return t.drawTicks?t.tickLength:0}function Xm(t,e){if(!t.display)return 0;const n=Ye(t.font,e),s=Mt(t.padding);return(Ee(t.text)?t.text.length:1)*n.lineHeight+s.height}function BE(t,e){return Is(t,{scale:e,type:"scale"})}function $E(t,e,n){return Is(t,{tick:n,index:e,type:"tick"})}function zE(t,e,n){let s=oh(t);return(n&&e!=="right"||!n&&e==="right")&&(s=IE(s)),s}function UE(t,e,n,s){const{top:r,left:i,bottom:a,right:l,chart:c}=t,{chartArea:d,scales:u}=c;let h=0,f,m,x;const g=a-r,y=l-i;if(t.isHorizontal()){if(m=He(s,i,l),ie(n)){const v=Object.keys(n)[0],p=n[v];x=u[v].getPixelForValue(p)+g-e}else n==="center"?x=(d.bottom+d.top)/2+g-e:x=Gm(t,n,e);f=l-i}else{if(ie(n)){const v=Object.keys(n)[0],p=n[v];m=u[v].getPixelForValue(p)-y+e}else n==="center"?m=(d.left+d.right)/2-y+e:m=Gm(t,n,e);x=He(s,a,r),h=n==="left"?-Bt:Bt}return{titleX:m,titleY:x,maxWidth:f,rotation:h}}class Fr extends rn{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=qt(e,Number.POSITIVE_INFINITY),n=qt(n,Number.NEGATIVE_INFINITY),s=qt(s,Number.POSITIVE_INFINITY),r=qt(r,Number.NEGATIVE_INFINITY),{min:qt(e,s),max:qt(n,r),minDefined:Et(e),maxDefined:Et(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),a;if(r&&i)return{min:n,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)a=l[c].controller.getMinMax(this,e),r||(n=Math.min(n,a.min)),i||(s=Math.max(s,a.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:qt(n,qt(s,n)),max:qt(s,qt(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){pe(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:a}=this.options,l=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=JC(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?Jm(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=ME(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){pe(this.options.afterUpdate,[this])}beforeSetDimensions(){pe(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){pe(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),pe(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){pe(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=pe(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){pe(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){pe(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Km(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let a=r,l,c,d;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,m=mt(this.chart.width-h,0,this.maxWidth);l=e.offset?this.maxWidth/s:m/(s-1),h+6>l&&(l=m/(s-(e.offset?.5:1)),c=this.maxHeight-ni(e.grid)-n.padding-Xm(e.title,this.chart.options.font),d=Math.sqrt(h*h+f*f),a=_C(Math.min(Math.asin(mt((u.highest.height+6)/l,-1,1)),Math.asin(mt(c/d,-1,1))-Math.asin(mt(f/d,-1,1)))),a=Math.max(r,Math.min(i,a))),this.labelRotation=a}afterCalculateLabelRotation(){pe(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){pe(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,a=this._isVisible(),l=this.isHorizontal();if(a){const c=Xm(r,n.options.font);if(l?(e.width=this.maxWidth,e.height=ni(i)+c):(e.height=this.maxHeight,e.width=ni(i)+c),s.display&&this.ticks.length){const{first:d,last:u,widest:h,highest:f}=this._getLabelSizes(),m=s.padding*2,x=bs(this.labelRotation),g=Math.cos(x),y=Math.sin(x);if(l){const v=s.mirror?0:y*h.width+g*f.height;e.height=Math.min(this.maxHeight,e.height+v+m)}else{const v=s.mirror?0:g*h.width+y*f.height;e.width=Math.min(this.maxWidth,e.width+v+m)}this._calculatePadding(d,u,y,g)}}this._handleMargins(),l?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:a},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,m=0;c?d?(f=r*e.width,m=s*n.height):(f=s*e.height,m=r*n.width):i==="start"?m=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,m=n.width/2),this.paddingLeft=Math.max((f-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((m-h+a)*this.width/(this.width-h),0)}else{let u=n.height/2,h=e.height/2;i==="start"?(u=0,h=e.height):i==="end"&&(u=n.height,h=0),this.paddingTop=u+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){pe(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)fe(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Jm(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,a=[],l=[],c=Math.floor(n/Km(n,s));let d=0,u=0,h,f,m,x,g,y,v,p,b,j,_;for(h=0;h<n;h+=c){if(x=e[h].label,g=this._resolveTickFontOptions(h),r.font=y=g.string,v=i[y]=i[y]||{data:{},gc:[]},p=g.lineHeight,b=j=0,!fe(x)&&!Ee(x))b=Sm(r,v.data,v.gc,b,x),j=p;else if(Ee(x))for(f=0,m=x.length;f<m;++f)_=x[f],!fe(_)&&!Ee(_)&&(b=Sm(r,v.data,v.gc,b,_),j+=p);a.push(b),l.push(j),d=Math.max(b,d),u=Math.max(j,u)}FE(i,n);const C=a.indexOf(d),S=l.indexOf(u),k=A=>({width:a[A]||0,height:l[A]||0});return{first:k(0),last:k(n-1),widest:k(C),highest:k(S),widths:a,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return SC(this._alignToPixels?ls(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=$E(this.getContext(),e,s))}return this.$context||(this.$context=BE(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=bs(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),a=e.autoSkipPadding||0,l=i?i.widest.width+a:0,c=i?i.highest.height+a:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:a,border:l}=r,c=i.offset,d=this.isHorizontal(),h=this.ticks.length+(c?1:0),f=ni(i),m=[],x=l.setContext(this.getContext()),g=x.display?x.width:0,y=g/2,v=function(N){return ls(s,N,g)};let p,b,j,_,C,S,k,A,P,D,M,B;if(a==="top")p=v(this.bottom),S=this.bottom-f,A=p-y,D=v(e.top)+y,B=e.bottom;else if(a==="bottom")p=v(this.top),D=e.top,B=v(e.bottom)-y,S=p+y,A=this.top+f;else if(a==="left")p=v(this.right),C=this.right-f,k=p-y,P=v(e.left)+y,M=e.right;else if(a==="right")p=v(this.left),P=e.left,M=v(e.right)-y,C=p+y,k=this.left+f;else if(n==="x"){if(a==="center")p=v((e.top+e.bottom)/2+.5);else if(ie(a)){const N=Object.keys(a)[0],R=a[N];p=v(this.chart.scales[N].getPixelForValue(R))}D=e.top,B=e.bottom,S=p+y,A=S+f}else if(n==="y"){if(a==="center")p=v((e.left+e.right)/2);else if(ie(a)){const N=Object.keys(a)[0],R=a[N];p=v(this.chart.scales[N].getPixelForValue(R))}C=p-y,k=C-f,P=e.left,M=e.right}const E=se(r.ticks.maxTicksLimit,h),T=Math.max(1,Math.ceil(h/E));for(b=0;b<h;b+=T){const N=this.getContext(b),R=i.setContext(N),O=l.setContext(N),z=R.lineWidth,U=R.color,K=O.dash||[],G=O.dashOffset,ye=R.tickWidth,F=R.tickColor,J=R.tickBorderDash||[],X=R.tickBorderDashOffset;j=LE(this,b,c),j!==void 0&&(_=ls(s,j,z),d?C=k=P=M=_:S=A=D=B=_,m.push({tx1:C,ty1:S,tx2:k,ty2:A,x1:P,y1:D,x2:M,y2:B,width:z,color:U,borderDash:K,borderDashOffset:G,tickWidth:ye,tickColor:F,tickBorderDash:J,tickBorderDashOffset:X}))}return this._ticksLength=h,this._borderValue=p,m}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,a=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=i,f=ni(s.grid),m=f+u,x=h?-u:m,g=-bs(this.labelRotation),y=[];let v,p,b,j,_,C,S,k,A,P,D,M,B="middle";if(r==="top")C=this.bottom-x,S=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+x,S=this._getXAxisLabelAlignment();else if(r==="left"){const T=this._getYAxisLabelAlignment(f);S=T.textAlign,_=T.x}else if(r==="right"){const T=this._getYAxisLabelAlignment(f);S=T.textAlign,_=T.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+m;else if(ie(r)){const T=Object.keys(r)[0],N=r[T];C=this.chart.scales[T].getPixelForValue(N)+m}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(e.left+e.right)/2-m;else if(ie(r)){const T=Object.keys(r)[0],N=r[T];_=this.chart.scales[T].getPixelForValue(N)}S=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(c==="start"?B="top":c==="end"&&(B="bottom"));const E=this._getLabelSizes();for(v=0,p=l.length;v<p;++v){b=l[v],j=b.label;const T=i.setContext(this.getContext(v));k=this.getPixelForTick(v)+i.labelOffset,A=this._resolveTickFontOptions(v),P=A.lineHeight,D=Ee(j)?j.length:1;const N=D/2,R=T.color,O=T.textStrokeColor,z=T.textStrokeWidth;let U=S;a?(_=k,S==="inner"&&(v===p-1?U=this.options.reverse?"left":"right":v===0?U=this.options.reverse?"right":"left":U="center"),r==="top"?d==="near"||g!==0?M=-D*P+P/2:d==="center"?M=-E.highest.height/2-N*P+P:M=-E.highest.height+P/2:d==="near"||g!==0?M=P/2:d==="center"?M=E.highest.height/2-N*P:M=E.highest.height-D*P,h&&(M*=-1),g!==0&&!T.showLabelBackdrop&&(_+=P/2*Math.sin(g))):(C=k,M=(1-D)*P/2);let K;if(T.showLabelBackdrop){const G=Mt(T.backdropPadding),ye=E.heights[v],F=E.widths[v];let J=M-G.top,X=0-G.left;switch(B){case"middle":J-=ye/2;break;case"bottom":J-=ye;break}switch(S){case"center":X-=F/2;break;case"right":X-=F;break;case"inner":v===p-1?X-=F:v>0&&(X-=F/2);break}K={left:X,top:J,width:F+G.width,height:ye+G.height,color:T.backdropColor}}y.push({label:j,font:A,textOffset:M,options:{rotation:g,color:R,strokeColor:O,strokeWidth:z,textAlign:U,textBaseline:B,translation:[_,C],backdrop:K}})}return y}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-bs(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,a=this._getLabelSizes(),l=e+i,c=a.widest.width;let d,u;return n==="left"?r?(u=this.right+i,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u+=c)):(u=this.right-l,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u-=c)):(u=this.left+l,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:a}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,a),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,a;const l=(c,d,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(n.display)for(i=0,a=r.length;i<a;++i){const c=r[i];n.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),n.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),a=s.display?i.width:0;if(!a)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,u,h,f;this.isHorizontal()?(d=ls(e,this.left,a)-a/2,u=ls(e,this.right,l)+l/2,h=f=c):(h=ls(e,this.top,a)-a/2,f=ls(e,this.bottom,l)+l/2,d=u=c),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(d,h),n.lineTo(u,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&lh(s,r);const i=this.getLabelItems(e);for(const a of i){const l=a.options,c=a.font,d=a.label,u=a.textOffset;ro(s,d,0,u,c,l)}r&&ch(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=Ye(s.font),a=Mt(s.padding),l=s.align;let c=i.lineHeight/2;n==="bottom"||n==="center"||ie(n)?(c+=a.bottom,Ee(s.text)&&(c+=i.lineHeight*(s.text.length-1))):c+=a.top;const{titleX:d,titleY:u,maxWidth:h,rotation:f}=UE(this,c,n,l);ro(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:zE(l,n,r),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=se(e.grid&&e.grid.z,-1),r=se(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Fr.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,a;for(i=0,a=n.length;i<a;++i){const l=n[i];l[s]===this.id&&(!e||l.type===e)&&r.push(l)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Ye(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ko{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;HE(n)&&(s=this.register(n));const r=this.items,i=e.id,a=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,VE(e,a,s),this.override&&ke.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in ke[r]&&(delete ke[r][s],this.override&&delete Ts[s])}}function VE(t,e,n){const s=eo(Object.create(null),[n?ke.get(n):{},ke.get(e),t.defaults]);ke.set(e,s),t.defaultRoutes&&WE(e,t.defaultRoutes),t.descriptors&&ke.describe(e,t.descriptors)}function WE(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),a=e[n].split("."),l=a.pop(),c=a.join(".");ke.route(i,r,c,l)})}function HE(t){return"id"in t&&"defaults"in t}class qE{constructor(){this.controllers=new Ko(hr,"datasets",!0),this.elements=new Ko(rn,"elements"),this.plugins=new Ko(Object,"plugins"),this.scales=new Ko(Fr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):ae(r,a=>{const l=s||this._getRegistryForType(a);this._exec(e,l,a)})})}_exec(e,n,s){const r=rh(e);pe(s["before"+r],[],s),n[e](s),pe(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var Gt=new qE;class YE{constructor(){this._init=[]}notify(e,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=r?this._descriptors(e).filter(r):this._descriptors(e),a=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,n,s,r){r=r||{};for(const i of e){const a=i.plugin,l=a[s],c=[n,r,i.options];if(pe(l,c,a)===!1&&r.cancelable)return!1}return!0}invalidate(){fe(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=se(s.options&&s.options.plugins,{}),i=QE(s);return r===!1&&!n?[]:KE(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,a)=>i.filter(l=>!a.some(c=>l.plugin.id===c.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function QE(t){const e={},n=[],s=Object.keys(Gt.plugins.items);for(let i=0;i<s.length;i++)n.push(Gt.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const a=r[i];n.indexOf(a)===-1&&(n.push(a),e[a.id]=!0)}return{plugins:n,localIds:e}}function GE(t,e){return!e&&t===!1?null:t===!0?{}:t}function KE(t,{plugins:e,localIds:n},s,r){const i=[],a=t.getContext();for(const l of e){const c=l.id,d=GE(s[c],r);d!==null&&i.push({plugin:l,options:JE(t.config,{plugin:l,local:n[c]},d,a)})}return i}function JE(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),a=t.getOptionScopes(s,i);return n&&e.defaults&&a.push(e.defaults),t.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Wd(t,e){const n=ke.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function XE(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function ZE(t,e){return t===e?"_index_":"_value_"}function Zm(t){if(t==="x"||t==="y"||t==="r")return t}function e5(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Hd(t,...e){if(Zm(t))return t;for(const n of e){const s=n.axis||e5(n.position)||t.length>1&&Zm(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function ep(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function t5(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return ep(t,"x",n[0])||ep(t,"y",n[0])}return{}}function n5(t,e){const n=Ts[t.type]||{scales:{}},s=e.scales||{},r=Wd(t.type,e),i=Object.create(null);return Object.keys(s).forEach(a=>{const l=s[a];if(!ie(l))return console.error(`Invalid scale configuration for scale: ${a}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const c=Hd(a,l,t5(a,t),ke.scales[l.type]),d=ZE(c,r),u=n.scales||{};i[a]=Si(Object.create(null),[{axis:c},l,u[c],u[d]])}),t.data.datasets.forEach(a=>{const l=a.type||t.type,c=a.indexAxis||Wd(l,e),u=(Ts[l]||{}).scales||{};Object.keys(u).forEach(h=>{const f=XE(h,c),m=a[f+"AxisID"]||f;i[m]=i[m]||Object.create(null),Si(i[m],[{axis:f},s[m],u[h]])})}),Object.keys(i).forEach(a=>{const l=i[a];Si(l,[ke.scales[l.type],ke.scale])}),i}function Ry(t){const e=t.options||(t.options={});e.plugins=se(e.plugins,{}),e.scales=n5(t,e)}function Dy(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function s5(t){return t=t||{},t.data=Dy(t.data),Ry(t),t}const tp=new Map,Iy=new Set;function Jo(t,e){let n=tp.get(t);return n||(n=e(),tp.set(t,n),Iy.add(n)),n}const si=(t,e,n)=>{const s=kr(e,n);s!==void 0&&t.add(s)};class r5{constructor(e){this._config=s5(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Dy(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Ry(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Jo(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Jo(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Jo(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Jo(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,a=this._cachedScopes(e,s),l=a.get(n);if(l)return l;const c=new Set;n.forEach(u=>{e&&(c.add(e),u.forEach(h=>si(c,e,h))),u.forEach(h=>si(c,r,h)),u.forEach(h=>si(c,Ts[i]||{},h)),u.forEach(h=>si(c,ke,h)),u.forEach(h=>si(c,Ud,h))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),Iy.has(n)&&a.set(n,d),d}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ts[n]||{},ke.datasets[n]||{},{type:n},ke,Ud]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:a,subPrefixes:l}=np(this._resolverCache,e,r);let c=a;if(o5(a,n)){i.$shared=!1,s=es(s)?s():s;const d=this.createResolver(e,s,l);c=Cr(a,s,d)}for(const d of n)i[d]=c[d];return i}createResolver(e,n,s=[""],r){const{resolver:i}=np(this._resolverCache,e,s);return ie(n)?Cr(i,n,void 0,r):i}}function np(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:dh(e,n),subPrefixes:n.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,i)),i}const i5=t=>ie(t)&&Object.getOwnPropertyNames(t).some(e=>es(t[e]));function o5(t,e){const{isScriptable:n,isIndexable:s}=yy(t);for(const r of e){const i=n(r),a=s(r),l=(a||i)&&t[r];if(i&&(es(l)||i5(l))||a&&Ee(l))return!0}return!1}var a5="4.4.7";const l5=["top","bottom","left","right","chartArea"];function sp(t,e){return t==="top"||t==="bottom"||l5.indexOf(t)===-1&&e==="x"}function rp(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function ip(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),pe(n&&n.onComplete,[t],e)}function c5(t){const e=t.chart,n=e.options.animation;pe(n&&n.onProgress,[t],e)}function Ly(t){return fh()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const ga={},op=t=>{const e=Ly(t);return Object.values(ga).filter(n=>n.canvas===e).pop()};function d5(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const a=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=a)}}}function u5(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}function Xo(t,e,n){return t.options.clip?t[n]:e[n]}function h5(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Xo(n,e,"left"),right:Xo(n,e,"right"),top:Xo(s,e,"top"),bottom:Xo(s,e,"bottom")}:e}var Sn;let Er=(Sn=class{static register(...e){Gt.add(...e),ap()}static unregister(...e){Gt.remove(...e),ap()}constructor(e,n){const s=this.config=new r5(n),r=Ly(e),i=op(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||EE(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,a.aspectRatio),c=l&&l.canvas,d=c&&c.height,u=c&&c.width;if(this.id=dC(),this.ctx=l,this.canvas=c,this.width=u,this.height=d,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new YE,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=EC(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],ga[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}an.listen(this,"complete",ip),an.listen(this,"progress",c5),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return fe(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Gt}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Em(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return km(this.canvas,this.ctx),this}stop(){return an.stop(this),this}resize(e,n){an.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,e,n,i),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Em(this,l,!0)&&(this.notifyPlugins("resize",{size:a}),pe(s.onResize,[this,a],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};ae(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((a,l)=>(a[l]=!1,a),{});let i=[];n&&(i=i.concat(Object.keys(n).map(a=>{const l=n[a],c=Hd(a,l),d=c==="r",u=c==="x";return{options:l,dposition:d?"chartArea":u?"bottom":"left",dtype:d?"radialLinear":u?"category":"linear"}}))),ae(i,a=>{const l=a.options,c=l.id,d=Hd(c,l),u=se(l.type,a.dtype);(l.position===void 0||sp(l.position,d)!==sp(a.dposition))&&(l.position=a.dposition),r[c]=!0;let h=null;if(c in s&&s[c].type===u)h=s[c];else{const f=Gt.getScale(u);h=new f({id:c,type:u,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(l,e)}),ae(r,(a,l)=>{a||delete s[l]}),ae(s,a=>{Nt.configure(this,a,a.options),Nt.addBox(this,a)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(rp("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let a=this.getDatasetMeta(s);const l=i.type||this.config.type;if(a.type&&a.type!==l&&(this._destroyDatasetMeta(s),a=this.getDatasetMeta(s)),a.type=l,a.indexAxis=i.indexAxis||Wd(l,this.options),a.order=i.order||0,a.index=s,a.label=""+i.label,a.visible=this.isDatasetVisible(s),a.controller)a.controller.updateIndex(s),a.controller.linkScales();else{const c=Gt.getController(l),{datasetElementType:d,dataElementType:u}=ke.datasets[l];Object.assign(c,{dataElementType:Gt.getElement(u),datasetElementType:d&&Gt.getElement(d)}),a.controller=new c(this,s),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){ae(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let d=0,u=this.data.datasets.length;d<u;d++){const{controller:h}=this.getDatasetMeta(d),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=s.layout.autoPadding?a:0,this._updateLayout(a),r||ae(i,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(rp("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){ae(this.scales,e=>{Nt.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!gm(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const a=s==="_removeElements"?-i:i;d5(e,r,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(a=>a[0]===i).map((a,l)=>l+","+a.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!gm(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Nt.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],ae(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,es(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(an.has(this)?this.attached&&!an.running(this)&&an.start(this):(this.draw(),ip({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const a=n[r];(!e||a.visible)&&s.push(a)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s=e._clip,r=!s.disabled,i=h5(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&lh(n,{left:s.left===!1?0:i.left-s.left,right:s.right===!1?this.width:i.right+s.right,top:s.top===!1?0:i.top-s.top,bottom:s.bottom===!1?this.height:i.bottom+s.bottom}),e.controller.draw(),r&&ch(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return so(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=lE.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Is(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),a=i.controller._resolveAnimations(void 0,r);to(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),a.update(i,{visible:s}),this.update(l=>l.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),an.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),km(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete ga[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,a)=>{n.addEventListener(this,i,a),e[i]=a},r=(i,a,l)=>{i.offsetX=a,i.offsetY=l,this._eventHandler(i)};ae(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(c,d)=>{n.addEventListener(this,c,d),e[c]=d},r=(c,d)=>{e[c]&&(n.removeEventListener(this,c,d),delete e[c])},i=(c,d)=>{this.canvas&&this.resize(c,d)};let a;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",i),s("detach",a)};a=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",l)},n.isAttached(this.canvas)?l():a()}unbindEvents(){ae(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},ae(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,a,l,c;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){a=e[l];const d=a&&this.getDatasetMeta(a.datasetIndex).controller;d&&d[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:a})=>{const l=this.getDatasetMeta(i);if(!l)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:l.data[a],index:a}});!Ka(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(c,d)=>c.filter(u=>!d.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),a=i(n,e),l=s?e:i(e,n);a.length&&this.updateHoverStyle(a,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,a=n,l=this._getActiveElements(e,r,s,a),c=gC(e),d=u5(e,this._lastEvent,s,c);s&&(this._lastEvent=null,pe(i.onHover,[e,l,this],this),c&&pe(i.onClick,[e,l,this],this));const u=!Ka(l,r);return(u||n)&&(this._active=l,this._updateHoverStyles(l,r,n)),this._lastEvent=d,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}},Q(Sn,"defaults",ke),Q(Sn,"instances",ga),Q(Sn,"overrides",Ts),Q(Sn,"registry",Gt),Q(Sn,"version",a5),Q(Sn,"getChart",op),Sn);function ap(){return ae(Er.instances,t=>t._plugins.invalidate())}function Fy(t,e,n=e){t.lineCap=se(n.borderCapStyle,e.borderCapStyle),t.setLineDash(se(n.borderDash,e.borderDash)),t.lineDashOffset=se(n.borderDashOffset,e.borderDashOffset),t.lineJoin=se(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=se(n.borderWidth,e.borderWidth),t.strokeStyle=se(n.borderColor,e.borderColor)}function f5(t,e,n){t.lineTo(n.x,n.y)}function m5(t){return t.stepped?UC:t.tension||t.cubicInterpolationMode==="monotone"?VC:f5}function By(t,e,n={}){const s=t.length,{start:r=0,end:i=s-1}=n,{start:a,end:l}=e,c=Math.max(r,a),d=Math.min(i,l),u=r<a&&i<a||r>l&&i>l;return{count:s,start:c,loop:e.loop,ilen:d<c&&!u?s+d-c:d-c}}function p5(t,e,n,s){const{points:r,options:i}=e,{count:a,start:l,loop:c,ilen:d}=By(r,n,s),u=m5(i);let{move:h=!0,reverse:f}=s||{},m,x,g;for(m=0;m<=d;++m)x=r[(l+(f?d-m:m))%a],!x.skip&&(h?(t.moveTo(x.x,x.y),h=!1):u(t,g,x,f,i.stepped),g=x);return c&&(x=r[(l+(f?d:0))%a],u(t,g,x,f,i.stepped)),!!c}function g5(t,e,n,s){const r=e.points,{count:i,start:a,ilen:l}=By(r,n,s),{move:c=!0,reverse:d}=s||{};let u=0,h=0,f,m,x,g,y,v;const p=j=>(a+(d?l-j:j))%i,b=()=>{g!==y&&(t.lineTo(u,y),t.lineTo(u,g),t.lineTo(u,v))};for(c&&(m=r[p(0)],t.moveTo(m.x,m.y)),f=0;f<=l;++f){if(m=r[p(f)],m.skip)continue;const j=m.x,_=m.y,C=j|0;C===x?(_<g?g=_:_>y&&(y=_),u=(h*u+j)/++h):(b(),t.lineTo(j,_),x=C,h=0,g=y=_),v=_}b()}function qd(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?g5:p5}function x5(t){return t.stepped?wP:t.tension||t.cubicInterpolationMode==="monotone"?_P:ps}function y5(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),Fy(t,e.options),t.stroke(r)}function v5(t,e,n,s){const{segments:r,options:i}=e,a=qd(e);for(const l of r)Fy(t,i,l.style),t.beginPath(),a(t,e,l,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const b5=typeof Path2D=="function";function w5(t,e,n,s){b5&&!e.options.segment?y5(t,e,n,s):v5(t,e,n,s)}class tr extends rn{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;fP(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=MP(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],i=this.points,a=CP(this,{property:n,start:r,end:r});if(!a.length)return;const l=[],c=x5(s);let d,u;for(d=0,u=a.length;d<u;++d){const{start:h,end:f}=a[d],m=i[h],x=i[f];if(m===x){l.push(m);continue}const g=Math.abs((r-m[n])/(x[n]-m[n])),y=c(m,x,g,s.stepped);y[n]=e[n],l.push(y)}return l.length===1?l[0]:l}pathSegment(e,n,s){return qd(this)(e,this,n,s)}path(e,n,s){const r=this.segments,i=qd(this);let a=this._loop;n=n||0,s=s||this.points.length-n;for(const l of r)a&=i(e,this,l,{start:n,end:n+s-1});return!!a}draw(e,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),w5(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Q(tr,"id","line"),Q(tr,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Q(tr,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Q(tr,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function lp(t,e,n,s){const r=t.options,{[n]:i}=t.getProps([n],s);return Math.abs(e-i)<r.radius+r.hitRadius}class Ei extends rn{constructor(n){super();Q(this,"parsed");Q(this,"skip");Q(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.options,{x:a,y:l}=this.getProps(["x","y"],r);return Math.pow(n-a,2)+Math.pow(s-l,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,s){return lp(this,n,"x",s)}inYRange(n,s){return lp(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!so(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,Vd(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Q(Ei,"id","point"),Q(Ei,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Q(Ei,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function $y(t,e){const{x:n,y:s,base:r,width:i,height:a}=t.getProps(["x","y","base","width","height"],e);let l,c,d,u,h;return t.horizontal?(h=a/2,l=Math.min(n,r),c=Math.max(n,r),d=s-h,u=s+h):(h=i/2,l=n-h,c=n+h,d=Math.min(s,r),u=Math.max(s,r)),{left:l,top:d,right:c,bottom:u}}function $n(t,e,n,s){return t?0:mt(e,n,s)}function _5(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=xy(s);return{t:$n(r.top,i.top,0,n),r:$n(r.right,i.right,0,e),b:$n(r.bottom,i.bottom,0,n),l:$n(r.left,i.left,0,e)}}function j5(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=dr(r),a=Math.min(e,n),l=t.borderSkipped,c=s||ie(r);return{topLeft:$n(!c||l.top||l.left,i.topLeft,0,a),topRight:$n(!c||l.top||l.right,i.topRight,0,a),bottomLeft:$n(!c||l.bottom||l.left,i.bottomLeft,0,a),bottomRight:$n(!c||l.bottom||l.right,i.bottomRight,0,a)}}function N5(t){const e=$y(t),n=e.right-e.left,s=e.bottom-e.top,r=_5(t,n/2,s/2),i=j5(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Rc(t,e,n,s){const r=e===null,i=n===null,l=t&&!(r&&i)&&$y(t,s);return l&&(r||ws(e,l.left,l.right))&&(i||ws(n,l.top,l.bottom))}function S5(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function k5(t,e){t.rect(e.x,e.y,e.w,e.h)}function Dc(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,a=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+a,radius:t.radius}}class xa extends rn{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:a}=N5(this),l=S5(a.radius)?Za:k5;e.save(),(a.w!==i.w||a.h!==i.h)&&(e.beginPath(),l(e,Dc(a,n,i)),e.clip(),l(e,Dc(i,-n,a)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),l(e,Dc(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Rc(this,e,n,s)}inXRange(e,n){return Rc(this,e,null,n)}inYRange(e,n){return Rc(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Q(xa,"id","bar"),Q(xa,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Q(xa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const cp=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},C5=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class dp extends rn{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=pe(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Ye(s.font),i=r.size,a=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=cp(s,i);let d,u;n.font=r.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(a,i,l,c)+10):(u=this.maxHeight,d=this._fitCols(a,r,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:a,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],u=r+l;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,m=-u;return this.legendItems.forEach((x,g)=>{const y=s+n/2+i.measureText(x.text).width;(g===0||d[d.length-1]+y+2*l>a)&&(h+=u,d[d.length-(g>0?0:1)]=0,m+=u,f++),c[g]={left:0,top:m,row:f,width:y,height:r},d[d.length-1]+=y+l}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:a,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],u=a-e;let h=l,f=0,m=0,x=0,g=0;return this.legendItems.forEach((y,v)=>{const{itemWidth:p,itemHeight:b}=P5(s,n,i,y,r);v>0&&m+b+2*l>u&&(h+=f+l,d.push({width:f,height:m}),x+=f+l,g++,f=m=0),c[v]={left:x,top:m,col:g,width:p,height:b},f=Math.max(f,p),m+=b+l}),h+=f,d.push({width:f,height:m}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,a=ur(i,this.left,this.width);if(this.isHorizontal()){let l=0,c=He(s,this.left+r,this.right-this.lineWidths[l]);for(const d of n)l!==d.row&&(l=d.row,c=He(s,this.left+r,this.right-this.lineWidths[l])),d.top+=this.top+e+r,d.left=a.leftForLtr(a.x(c),d.width),c+=d.width+r}else{let l=0,c=He(s,this.top+e+r,this.bottom-this.columnSizes[l].height);for(const d of n)d.col!==l&&(l=d.col,c=He(s,this.top+e+r,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+r,d.left=a.leftForLtr(a.x(d.left),d.width),c+=d.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;lh(e,this),this._draw(),ch(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:a}=e,l=ke.color,c=ur(e.rtl,this.left,this.width),d=Ye(a.font),{padding:u}=a,h=d.size,f=h/2;let m;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=d.string;const{boxWidth:x,boxHeight:g,itemHeight:y}=cp(a,h),v=function(C,S,k){if(isNaN(x)||x<=0||isNaN(g)||g<0)return;r.save();const A=se(k.lineWidth,1);if(r.fillStyle=se(k.fillStyle,l),r.lineCap=se(k.lineCap,"butt"),r.lineDashOffset=se(k.lineDashOffset,0),r.lineJoin=se(k.lineJoin,"miter"),r.lineWidth=A,r.strokeStyle=se(k.strokeStyle,l),r.setLineDash(se(k.lineDash,[])),a.usePointStyle){const P={radius:g*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:A},D=c.xPlus(C,x/2),M=S+f;py(r,P,D,M,a.pointStyleWidth&&x)}else{const P=S+Math.max((h-g)/2,0),D=c.leftForLtr(C,x),M=dr(k.borderRadius);r.beginPath(),Object.values(M).some(B=>B!==0)?Za(r,{x:D,y:P,w:x,h:g,radius:M}):r.rect(D,P,x,g),r.fill(),A!==0&&r.stroke()}r.restore()},p=function(C,S,k){ro(r,k.text,C,S+y/2,d,{strikethrough:k.hidden,textAlign:c.textAlign(k.textAlign)})},b=this.isHorizontal(),j=this._computeTitleHeight();b?m={x:He(i,this.left+u,this.right-s[0]),y:this.top+u+j,line:0}:m={x:this.left+u,y:He(i,this.top+j+u,this.bottom-n[0].height),line:0},jy(this.ctx,e.textDirection);const _=y+u;this.legendItems.forEach((C,S)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const k=r.measureText(C.text).width,A=c.textAlign(C.textAlign||(C.textAlign=a.textAlign)),P=x+f+k;let D=m.x,M=m.y;c.setWidth(this.width),b?S>0&&D+P+u>this.right&&(M=m.y+=_,m.line++,D=m.x=He(i,this.left+u,this.right-s[m.line])):S>0&&M+_>this.bottom&&(D=m.x=D+n[m.line].width+u,m.line++,M=m.y=He(i,this.top+j+u,this.bottom-n[m.line].height));const B=c.x(D);if(v(B,M,C),D=MC(A,D+x+f,b?D+P:this.right,e.rtl),p(c.x(D),M,C),b)m.x+=P+u;else if(typeof C.text!="string"){const E=d.lineHeight;m.y+=zy(C,E)+u}else m.y+=_}),Ny(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Ye(n.font),r=Mt(n.padding);if(!n.display)return;const i=ur(e.rtl,this.left,this.width),a=this.ctx,l=n.position,c=s.size/2,d=r.top+c;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+d,h=He(e.align,h,this.right-f);else{const x=this.columnSizes.reduce((g,y)=>Math.max(g,y.height),0);u=d+He(e.align,this.top,this.bottom-x-e.labels.padding-this._computeTitleHeight())}const m=He(l,h,h+f);a.textAlign=i.textAlign(oh(l)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=s.string,ro(a,n.text,m,u,s)}_computeTitleHeight(){const e=this.options.title,n=Ye(e.font),s=Mt(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(ws(e,this.left,this.right)&&ws(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],ws(e,r.left,r.left+r.width)&&ws(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!T5(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=C5(r,s);r&&!i&&pe(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&pe(n.onHover,[e,s,this],this)}else s&&pe(n.onClick,[e,s,this],this)}}function P5(t,e,n,s,r){const i=E5(s,t,e,n),a=M5(r,s,e.lineHeight);return{itemWidth:i,itemHeight:a}}function E5(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,a)=>i.length>a.length?i:a)),e+n.size/2+s.measureText(r).width}function M5(t,e,n){let s=t;return typeof e.text!="string"&&(s=zy(e,n)),s}function zy(t,e){const n=t.text?t.text.length:0;return e*n}function T5(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Uy={id:"legend",_element:dp,start(t,e,n){const s=t.legend=new dp({ctx:t.ctx,options:n,chart:t});Nt.configure(t,s,n),Nt.addBox(t,s)},stop(t){Nt.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Nt.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:a,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(n?0:void 0),u=Mt(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:i,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:r||d.textAlign,borderRadius:a&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Vy extends rn{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=Ee(s.text)?s.text.length:1;this._padding=Mt(s.padding);const i=r*Ye(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:i,options:a}=this,l=a.align;let c=0,d,u,h;return this.isHorizontal()?(u=He(l,s,i),h=n+e,d=i-s):(a.position==="left"?(u=s+e,h=He(l,r,n),c=De*-.5):(u=i-e,h=He(l,n,r),c=De*.5),d=r-n),{titleX:u,titleY:h,maxWidth:d,rotation:c}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=Ye(n.font),i=s.lineHeight/2+this._padding.top,{titleX:a,titleY:l,maxWidth:c,rotation:d}=this._drawArgs(i);ro(e,n.text,0,0,s,{color:n.color,maxWidth:c,rotation:d,textAlign:oh(n.align),textBaseline:"middle",translation:[a,l]})}}function O5(t,e){const n=new Vy({ctx:t.ctx,options:e,chart:t});Nt.configure(t,n,e),Nt.addBox(t,n),t.titleBlock=n}var Wy={id:"title",_element:Vy,start(t,e,n){O5(t,n)},stop(t){const e=t.titleBlock;Nt.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;Nt.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ui={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const l=t[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,a,l;for(i=0,a=t.length;i<a;++i){const c=t[i].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),u=zd(e,d);u<r&&(r=u,l=c)}}if(l){const c=l.tooltipPosition();n=c.x,s=c.y}return{x:n,y:s}}};function Yt(t,e){return e&&(Ee(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function ln(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function A5(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:a,value:l}=i.getLabelAndValue(r);return{chart:t,label:a,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:l,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function up(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:a,boxHeight:l}=e,c=Ye(e.bodyFont),d=Ye(e.titleFont),u=Ye(e.footerFont),h=i.length,f=r.length,m=s.length,x=Mt(e.padding);let g=x.height,y=0,v=s.reduce((j,_)=>j+_.before.length+_.lines.length+_.after.length,0);if(v+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*d.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),v){const j=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;g+=m*j+(v-m)*c.lineHeight+(v-1)*e.bodySpacing}f&&(g+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let p=0;const b=function(j){y=Math.max(y,n.measureText(j).width+p)};return n.save(),n.font=d.string,ae(t.title,b),n.font=c.string,ae(t.beforeBody.concat(t.afterBody),b),p=e.displayColors?a+2+e.boxPadding:0,ae(s,j=>{ae(j.before,b),ae(j.lines,b),ae(j.after,b)}),p=0,n.font=u.string,ae(t.footer,b),n.restore(),y+=x.width,{width:y,height:g}}function R5(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function D5(t,e,n,s){const{x:r,width:i}=s,a=n.caretSize+n.caretPadding;if(t==="left"&&r+i+a>e.width||t==="right"&&r-i-a<0)return!0}function I5(t,e,n,s){const{x:r,width:i}=n,{width:a,chartArea:{left:l,right:c}}=t;let d="center";return s==="center"?d=r<=(l+c)/2?"left":"right":r<=i/2?d="left":r>=a-i/2&&(d="right"),D5(d,t,e,n)&&(d="center"),d}function hp(t,e,n){const s=n.yAlign||e.yAlign||R5(t,n);return{xAlign:n.xAlign||e.xAlign||I5(t,e,n,s),yAlign:s}}function L5(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function F5(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function fp(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:a}=t,{xAlign:l,yAlign:c}=n,d=r+i,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:m}=dr(a);let x=L5(e,l);const g=F5(e,c,d);return c==="center"?l==="left"?x+=d:l==="right"&&(x-=d):l==="left"?x-=Math.max(u,f)+r:l==="right"&&(x+=Math.max(h,m)+r),{x:mt(x,0,s.width-e.width),y:mt(g,0,s.height-e.height)}}function Zo(t,e,n){const s=Mt(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function mp(t){return Yt([],ln(t))}function B5(t,e,n){return Is(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function pp(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Hy={beforeTitle:on,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:on,beforeBody:on,beforeLabel:on,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return fe(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:on,afterBody:on,beforeFooter:on,footer:on,afterFooter:on};function st(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?Hy[e].call(n,s):r}class Yd extends rn{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new ky(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=B5(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=st(s,"beforeTitle",this,e),i=st(s,"title",this,e),a=st(s,"afterTitle",this,e);let l=[];return l=Yt(l,ln(r)),l=Yt(l,ln(i)),l=Yt(l,ln(a)),l}getBeforeBody(e,n){return mp(st(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return ae(e,i=>{const a={before:[],lines:[],after:[]},l=pp(s,i);Yt(a.before,ln(st(l,"beforeLabel",this,i))),Yt(a.lines,st(l,"label",this,i)),Yt(a.after,ln(st(l,"afterLabel",this,i))),r.push(a)}),r}getAfterBody(e,n){return mp(st(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=st(s,"beforeFooter",this,e),i=st(s,"footer",this,e),a=st(s,"afterFooter",this,e);let l=[];return l=Yt(l,ln(r)),l=Yt(l,ln(i)),l=Yt(l,ln(a)),l}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],a=[];let l=[],c,d;for(c=0,d=n.length;c<d;++c)l.push(A5(this.chart,n[c]));return e.filter&&(l=l.filter((u,h,f)=>e.filter(u,h,f,s))),e.itemSort&&(l=l.sort((u,h)=>e.itemSort(u,h,s))),ae(l,u=>{const h=pp(e.callbacks,u);r.push(st(h,"labelColor",this,u)),i.push(st(h,"labelPointStyle",this,u)),a.push(st(h,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=a,this.dataPoints=l,l}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,a=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const l=ui[s.position].call(this,r,this._eventPosition);a=this._createItems(s),this.title=this.getTitle(a,s),this.beforeBody=this.getBeforeBody(a,s),this.body=this.getBody(a,s),this.afterBody=this.getAfterBody(a,s),this.footer=this.getFooter(a,s);const c=this._size=up(this,s),d=Object.assign({},l,c),u=hp(this.chart,s,d),h=fp(s,d,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=a,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:a,cornerRadius:l}=s,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:h}=dr(l),{x:f,y:m}=e,{width:x,height:g}=n;let y,v,p,b,j,_;return i==="center"?(j=m+g/2,r==="left"?(y=f,v=y-a,b=j+a,_=j-a):(y=f+x,v=y+a,b=j-a,_=j+a),p=y):(r==="left"?v=f+Math.max(c,u)+a:r==="right"?v=f+x-Math.max(d,h)-a:v=this.caretX,i==="top"?(b=m,j=b-a,y=v-a,p=v+a):(b=m+g,j=b+a,y=v+a,p=v-a),_=b),{x1:y,x2:v,x3:p,y1:b,y2:j,y3:_}}drawTitle(e,n,s){const r=this.title,i=r.length;let a,l,c;if(i){const d=ur(s.rtl,this.x,this.width);for(e.x=Zo(this,s.titleAlign,s),n.textAlign=d.textAlign(s.titleAlign),n.textBaseline="middle",a=Ye(s.titleFont),l=s.titleSpacing,n.fillStyle=s.titleColor,n.font=a.string,c=0;c<i;++c)n.fillText(r[c],d.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+l,c+1===i&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,n,s,r,i){const a=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:d}=i,u=Ye(i.bodyFont),h=Zo(this,"left",i),f=r.x(h),m=c<u.lineHeight?(u.lineHeight-c)/2:0,x=n.y+m;if(i.usePointStyle){const g={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=r.leftForLtr(f,d)+d/2,v=x+c/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Vd(e,g,y,v),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Vd(e,g,y,v)}else{e.lineWidth=ie(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const g=r.leftForLtr(f,d),y=r.leftForLtr(r.xPlus(f,1),d-2),v=dr(a.borderRadius);Object.values(v).some(p=>p!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Za(e,{x:g,y:x,w:d,h:c,radius:v}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Za(e,{x:y,y:x+1,w:d-2,h:c-2,radius:v}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(g,x,d,c),e.strokeRect(g,x,d,c),e.fillStyle=a.backgroundColor,e.fillRect(y,x+1,d-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:a,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:u}=s,h=Ye(s.bodyFont);let f=h.lineHeight,m=0;const x=ur(s.rtl,this.x,this.width),g=function(k){n.fillText(k,x.x(e.x+m),e.y+f/2),e.y+=f+i},y=x.textAlign(a);let v,p,b,j,_,C,S;for(n.textAlign=a,n.textBaseline="middle",n.font=h.string,e.x=Zo(this,y,s),n.fillStyle=s.bodyColor,ae(this.beforeBody,g),m=l&&y!=="right"?a==="center"?d/2+u:d+2+u:0,j=0,C=r.length;j<C;++j){for(v=r[j],p=this.labelTextColors[j],n.fillStyle=p,ae(v.before,g),b=v.lines,l&&b.length&&(this._drawColorBox(n,e,j,x,s),f=Math.max(h.lineHeight,c)),_=0,S=b.length;_<S;++_)g(b[_]),f=h.lineHeight;ae(v.after,g)}m=0,f=h.lineHeight,ae(this.afterBody,g),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let a,l;if(i){const c=ur(s.rtl,this.x,this.width);for(e.x=Zo(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=c.textAlign(s.footerAlign),n.textBaseline="middle",a=Ye(s.footerFont),n.fillStyle=s.footerColor,n.font=a.string,l=0;l<i;++l)n.fillText(r[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:a}=this,{x:l,y:c}=e,{width:d,height:u}=s,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:x}=dr(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(l+h,c),a==="top"&&this.drawCaret(e,n,s,r),n.lineTo(l+d-f,c),n.quadraticCurveTo(l+d,c,l+d,c+f),a==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(l+d,c+u-x),n.quadraticCurveTo(l+d,c+u,l+d-x,c+u),a==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(l+m,c+u),n.quadraticCurveTo(l,c+u,l,c+u-m),a==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(l,c+h),n.quadraticCurveTo(l,c,l+h,c),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const a=ui[e.position].call(this,this._active,this._eventPosition);if(!a)return;const l=this._size=up(this,e),c=Object.assign({},a,this._size),d=hp(n,e,c),u=fp(e,c,d,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const a=Mt(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),jy(e,n.textDirection),i.y+=a.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),Ny(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),i=!Ka(s,r),a=this._positionChanged(r,n);(i||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],a=this._getActiveElements(e,i,n,s),l=this._positionChanged(a,e),c=n||!Ka(a,i)||l;return c&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),c}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&a.reverse(),a}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,a=ui[i.position].call(this,e,n);return a!==!1&&(s!==a.x||r!==a.y)}}Q(Yd,"positioners",ui);var qy={id:"tooltip",_element:Yd,positioners:ui,afterInit(t,e,n){n&&(t.tooltip=new Yd({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Hy},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const $5=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function z5(t,e,n,s){const r=t.indexOf(e);if(r===-1)return $5(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const U5=(t,e)=>t===null?null:mt(Math.round(t),0,e);function gp(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class nl extends Fr{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(fe(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:z5(s,e,se(n,e),this._addedLabels),U5(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let a=e;a<=n;a++)r.push({value:a});return r}getLabelForValue(e){return gp.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Q(nl,"id","category"),Q(nl,"defaults",{ticks:{callback:gp}});function V5(t,e){const n=[],{bounds:r,step:i,min:a,max:l,precision:c,count:d,maxTicks:u,maxDigits:h,includeBounds:f}=t,m=i||1,x=u-1,{min:g,max:y}=e,v=!fe(a),p=!fe(l),b=!fe(d),j=(y-g)/(h+1);let _=ym((y-g)/x/m)*m,C,S,k,A;if(_<1e-14&&!v&&!p)return[{value:g},{value:y}];A=Math.ceil(y/_)-Math.floor(g/_),A>x&&(_=ym(A*_/x/m)*m),fe(c)||(C=Math.pow(10,c),_=Math.ceil(_*C)/C),r==="ticks"?(S=Math.floor(g/_)*_,k=Math.ceil(y/_)*_):(S=g,k=y),v&&p&&i&&bC((l-a)/i,_/1e3)?(A=Math.round(Math.min((l-a)/_,u)),_=(l-a)/A,S=a,k=l):b?(S=v?a:S,k=p?l:k,A=d-1,_=(k-S)/A):(A=(k-S)/_,ki(A,Math.round(A),_/1e3)?A=Math.round(A):A=Math.ceil(A));const P=Math.max(vm(_),vm(S));C=Math.pow(10,fe(c)?P:c),S=Math.round(S*C)/C,k=Math.round(k*C)/C;let D=0;for(v&&(f&&S!==a?(n.push({value:a}),S<a&&D++,ki(Math.round((S+D*_)*C)/C,a,xp(a,j,t))&&D++):S<a&&D++);D<A;++D){const M=Math.round((S+D*_)*C)/C;if(p&&M>l)break;n.push({value:M})}return p&&f&&k!==l?n.length&&ki(n[n.length-1].value,l,xp(l,j,t))?n[n.length-1].value=l:n.push({value:l}):(!p||k===l)&&n.push({value:k}),n}function xp(t,e,{horizontal:n,minRotation:s}){const r=bs(s),i=(n?Math.sin(r):Math.cos(r))||.001,a=.75*e*(""+t).length;return Math.min(e/i,a)}class W5 extends Fr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return fe(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const a=c=>r=n?r:c,l=c=>i=s?i:c;if(e){const c=sn(r),d=sn(i);c<0&&d<0?l(0):c>0&&d>0&&a(0)}if(r===i){let c=i===0?1:Math.abs(i*.05);l(i+c),e||a(r-c)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,a=V5(r,i);return e.bounds==="ticks"&&wC(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return hy(e,this.chart.options.locale,this.options.ticks.format)}}class sl extends W5{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Et(e)?e:0,this.max=Et(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=bs(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Q(sl,"id","linear"),Q(sl,"defaults",{ticks:{callback:my.formatters.numeric}});const $l={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ot=Object.keys($l);function yp(t,e){return t-e}function vp(t,e){if(fe(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let a=e;return typeof s=="function"&&(a=s(a)),Et(a)||(a=typeof s=="string"?n.parse(a,s):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(no(i)||i===!0)?n.startOf(a,"isoWeek",i):n.startOf(a,r)),+a)}function bp(t,e,n,s){const r=ot.length;for(let i=ot.indexOf(t);i<r-1;++i){const a=$l[ot[i]],l=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-e)/(l*a.size))<=s)return ot[i]}return ot[r-1]}function H5(t,e,n,s,r){for(let i=ot.length-1;i>=ot.indexOf(n);i--){const a=ot[i];if($l[a].common&&t._adapter.diff(r,s,a)>=e-1)return a}return ot[n?ot.indexOf(n):0]}function q5(t){for(let e=ot.indexOf(t)+1,n=ot.length;e<n;++e)if($l[ot[e]].common)return ot[e]}function wp(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=ih(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function Y5(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),a=e[e.length-1].value;let l,c;for(l=i;l<=a;l=+r.add(l,1,s))c=n[l],c>=0&&(e[c].major=!0);return e}function _p(t,e,n){const s=[],r={},i=e.length;let a,l;for(a=0;a<i;++a)l=e[a],r[l]=a,s.push({value:l,major:!1});return i===0||!n?s:Y5(t,s,r,n)}class rl extends Fr{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new sE._date(e.adapters.date);r.init(n),Si(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:vp(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:a,maxDefined:l}=this.getUserBounds();function c(d){!a&&!isNaN(d.min)&&(r=Math.min(r,d.min)),!l&&!isNaN(d.max)&&(i=Math.max(i,d.max))}(!a||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=Et(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Et(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,a=this.max,l=CC(r,i,a);return this._unit=n.unit||(s.autoSkip?bp(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):H5(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:q5(this._unit),this.initOffsets(r),e.reverse&&l.reverse(),_p(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;n=mt(n,0,a),s=mt(s,0,a),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,a=i.unit||bp(i.minUnit,n,s,this._getLabelCapacity(n)),l=se(r.ticks.stepSize,1),c=a==="week"?i.isoWeekday:!1,d=no(c)||c===!0,u={};let h=n,f,m;if(d&&(h=+e.startOf(h,"isoWeek",c)),h=+e.startOf(h,d?"day":a),e.diff(s,n,a)>1e5*l)throw new Error(n+" and "+s+" are too far apart with stepSize of "+l+" "+a);const x=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,m=0;f<s;f=+e.add(f,l,a),m++)wp(u,f,x);return(f===s||r.bounds==="ticks"||m===1)&&wp(u,f,x),Object.keys(u).sort(yp).map(g=>+g)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,a=n||r[i];return this._adapter.format(e,a)}_tickFormatFunction(e,n,s,r){const i=this.options,a=i.ticks.callback;if(a)return pe(a,[e,n,s],this);const l=i.time.displayFormats,c=this._unit,d=this._majorUnit,u=c&&l[c],h=d&&l[d],f=s[n],m=d&&h&&f&&f.major;return this._adapter.format(e,r||(m?h:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=bs(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),a=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*i+l*a,h:s*a+l*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,_p(this,[e],this._majorUnit),r),a=this._getLabelSize(i),l=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(vp(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return cy(e.sort(yp))}}Q(rl,"id","time"),Q(rl,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function ea(t,e,n){let s=0,r=t.length-1,i,a,l,c;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=_s(t,"pos",e)),{pos:i,time:l}=t[s],{pos:a,time:c}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=_s(t,"time",e)),{time:i,pos:l}=t[s],{time:a,pos:c}=t[r]);const d=a-i;return d?l+(c-l)*(e-i)/d:l}class jp extends rl{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=ea(n,this.min),this._tableRange=ea(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let a,l,c,d,u;for(a=0,l=e.length;a<l;++a)d=e[a],d>=n&&d<=s&&r.push(d);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(a=0,l=r.length;a<l;++a)u=r[a+1],c=r[a-1],d=r[a],Math.round((u+c)/2)!==d&&i.push({time:d,pos:a/(l-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(ea(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return ea(this._table,s*this._tableRange+this._minPos,!0)}}Q(jp,"id","timeseries"),Q(jp,"defaults",rl.defaults);const Yy="label";function Np(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Q5(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function Qy(t,e){t.labels=e}function Gy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yy;const s=[];t.datasets=e.map(r=>{const i=t.datasets.find(a=>a[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function G5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yy;const n={labels:[],datasets:[]};return Qy(n,t.labels),Gy(n,t.datasets,e),n}function K5(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:a,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...f}=t,m=w.useRef(null),x=w.useRef(),g=()=>{m.current&&(x.current=new Er(m.current,{type:a,data:G5(l,i),options:c&&{...c},plugins:d}),Np(e,x.current))},y=()=>{Np(e,null),x.current&&(x.current.destroy(),x.current=null)};return w.useEffect(()=>{!r&&x.current&&c&&Q5(x.current,c)},[r,c]),w.useEffect(()=>{!r&&x.current&&Qy(x.current.config.data,l.labels)},[r,l.labels]),w.useEffect(()=>{!r&&x.current&&l.datasets&&Gy(x.current.config.data,l.datasets,i)},[r,l.datasets]),w.useEffect(()=>{x.current&&(r?(y(),setTimeout(g)):x.current.update(h))},[r,c,l.labels,l.datasets,h]),w.useEffect(()=>{x.current&&(y(),setTimeout(g))},[a]),w.useEffect(()=>(g(),()=>y()),[]),Ke.createElement("canvas",Object.assign({ref:m,role:"img",height:n,width:s},f),u)}const J5=w.forwardRef(K5);function Ky(t,e){return Er.register(e),w.forwardRef((n,s)=>Ke.createElement(J5,Object.assign({},n,{ref:s,type:t})))}const Jy=Ky("line",ma),X5=Ky("bar",fa);Er.register(nl,sl,Ei,tr,Wy,qy,Uy);function Z5({returns:t}){const{language:e}=Y(),n=ny[e],s=e==="ar"?Xu:Fl,r=w.useMemo(()=>{const c=Ga(new Date),d=Y0(c,29);return V0({start:d,end:c})},[]),i=w.useMemo(()=>{const c=new Map;return r.forEach(d=>{c.set(Fn(d,"yyyy-MM-dd"),0)}),t.forEach(d=>{const u=Fn(new Date(d.date),"yyyy-MM-dd");c.has(u)&&c.set(u,(c.get(u)||0)+d.amount)}),{labels:r.map(d=>Fn(d,"MMM d",{locale:s})),data:Array.from(c.values())}},[t,r,s]),a={responsive:!0,plugins:{legend:{position:"top",align:"end",rtl:e==="ar",labels:{boxWidth:10,usePointStyle:!0}},title:{display:!0,text:n.returnsOverTime}},scales:{y:{beginAtZero:!0,ticks:{callback:c=>`${c} ${n.currency}`}}}},l={labels:i.labels,datasets:[{label:n.returnsAmount,data:i.data,borderColor:"rgb(234, 88, 12)",backgroundColor:"rgba(234, 88, 12, 0.5)",tension:.4}]};return o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsx(Jy,{options:a,data:l})})}const eM=[{id:"1",receiptId:"RCP1001",date:"2024-03-15T10:30:00",itemName:"تفاح أحمر",quantity:2,amount:5.98,reason:"منتج تالف",status:"approved"},{id:"2",receiptId:"RCP1002",date:"2024-03-14T15:45:00",itemName:"عصير برتقال",quantity:1,amount:1.99,reason:"خطأ في الطلب",status:"pending"}];function tM(){const{language:t}=Y(),e=ny[t],[n,s]=w.useState(""),[r,i]=w.useState({from:"",to:""}),[a,l]=w.useState("all"),c=eM.filter(h=>{const f=h.receiptId.toLowerCase().includes(n.toLowerCase())||h.itemName.toLowerCase().includes(n.toLowerCase()),m=a==="all"||h.status===a,x=new Date(h.date),g=(!r.from||x>=new Date(r.from))&&(!r.to||x<=new Date(r.to));return f&&m&&g}),d=c.reduce((h,f)=>h+f.amount,0),u=c.filter(h=>h.status==="pending").length;return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h1",{className:"text-2xl font-bold",children:e.returns})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:o.jsx(Xx,{className:"w-6 h-6 text-indigo-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.totalReturns}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:c.length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:o.jsx(_r,{className:"w-6 h-6 text-yellow-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.pendingReturns}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:u})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx(ho,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.totalAmount}),o.jsxs("p",{className:"text-3xl font-bold mt-1",children:[d.toFixed(3)," ",e.currency]})]})]})})]}),o.jsx(Z5,{returns:c}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:n,onChange:h=>s(h.target.value),placeholder:e.searchReturns,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("input",{type:"date",value:r.from,onChange:h=>i(f=>({...f,from:h.target.value})),className:"flex-1 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),o.jsx("input",{type:"date",value:r.to,onChange:h=>i(f=>({...f,to:h.target.value})),className:"flex-1 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("select",{value:a,onChange:h=>l(h.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:e.allStatuses}),o.jsx("option",{value:"pending",children:e.pending}),o.jsx("option",{value:"approved",children:e.approved}),o.jsx("option",{value:"rejected",children:e.rejected})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.receiptNumber}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.date}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.item}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.quantity}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.amount}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.reason}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.status})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(h=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:h.receiptId}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(h.date).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.itemName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.quantity}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[h.amount.toFixed(3)," ",e.currency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.reason}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${h.status==="approved"?"bg-green-100 text-green-800":h.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e[h.status]})})]},h.id))})]})})]})]})}const nM={ar:{customers:"العملاء",addCustomer:"إضافة عميل",searchCustomer:"ابحث عن عميل...",noSearchResults:"لا توجد نتائج للبحث",noCustomers:"لا يوجد عملاء",loading:"جاري التحميل...",filter:"تصفية",customer:"العميل",phoneNumber:"رقم الهاتف",orders:"طلبات",lastOrder:"آخر طلب",edit:"تعديل",addNewCustomer:"إضافة عميل جديد",editCustomer:"تعديل بيانات العميل",customerName:"اسم العميل",customerPhone:"رقم هاتف العميل",save:"حفظ",cancel:"إلغاء",required:"مطلوب",optional:"اختياري",deleteCustomer:"حذف العميل",confirmDelete:"هل أنت متأكد من حذف هذا العميل؟",delete:"حذف",never:"لم يطلب بعد",errorLoadingCustomers:"حدث خطأ أثناء تحميل العملاء",errorSavingCustomer:"حدث خطأ أثناء حفظ العميل",errorDeletingCustomer:"حدث خطأ أثناء حذف العميل"},en:{customers:"Customers",addCustomer:"Add Customer",searchCustomer:"Search for a customer...",noSearchResults:"No search results found",noCustomers:"No customers found",loading:"Loading...",filter:"Filter",customer:"Customer",phoneNumber:"Phone Number",orders:"Orders",lastOrder:"Last Order",edit:"Edit",addNewCustomer:"Add New Customer",editCustomer:"Edit Customer",customerName:"Customer Name",customerPhone:"Customer Phone",save:"Save",cancel:"Cancel",required:"Required",optional:"Optional",deleteCustomer:"Delete Customer",confirmDelete:"Are you sure you want to delete this customer?",delete:"Delete",never:"Never ordered",errorLoadingCustomers:"Error loading customers",errorSavingCustomer:"Error saving customer",errorDeletingCustomer:"Error deleting customer"}};function sM(){const{language:t}=Y(),{user:e}=ce(),n=nM[t],[s,r]=w.useState(""),[i,a]=w.useState([]),[l,c]=w.useState(!0),[d,u]=w.useState(null),[h,f]=w.useState(!1),[m,x]=w.useState(null),[g,y]=w.useState(null);w.useEffect(()=>{e!=null&&e.businessCode&&v()},[e==null?void 0:e.businessCode]);const v=async()=>{try{c(!0);const _=await mS(e.businessCode);a(_)}catch(_){console.error("Error loading customers:",_),u(n.errorLoadingCustomers)}finally{c(!1)}},p=async _=>{_.preventDefault(),u(null);const C=new FormData(_.currentTarget),S={customer_name:C.get("customer_name"),phone_number:C.get("phone_number")};try{m?await gS(m.customer_id,S):await $0({...S,number_of_orders:0,business_code:e.businessCode}),await v(),f(!1),x(null)}catch(k){console.error("Error saving customer:",k),u(n.errorSavingCustomer)}},b=async _=>{try{await xS(_),await v(),y(null)}catch(C){console.error("Error deleting customer:",C),u(n.errorDeletingCustomer)}},j=i.filter(_=>_.customer_name.toLowerCase().includes(s.toLowerCase())||_.phone_number.includes(s));return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.customers}),o.jsxs("button",{onClick:()=>{x(null),f(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),n.addCustomer]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:_=>r(_.target.value),placeholder:n.searchCustomer,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(Hu,{className:"w-5 h-5 ml-2"}),n.filter]})]})}),d&&o.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:o.jsx("p",{className:"text-sm text-red-600",children:d})}),o.jsx("div",{className:"overflow-x-auto",children:l?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):j.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s?n.noSearchResults:n.noCustomers})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.customer}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.phoneNumber}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.orders}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.lastOrder}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:n.edit})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(_=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"})}),o.jsx("div",{className:"mr-4",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.customer_name})})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.phone_number}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[_.number_of_orders," ",n.orders]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.last_order?new Date(_.last_order).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}):n.never}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:[o.jsx("button",{onClick:()=>{x(_),f(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:n.edit}),o.jsx("button",{onClick:()=>y(_.customer_id),className:"text-red-600 hover:text-red-900",children:n.delete})]})]},_.customer_id))})]})})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:m?n.editCustomer:n.addNewCustomer}),o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.customerName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"customer_name",defaultValue:m==null?void 0:m.customer_name,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.customerPhone," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"tel",name:"phone_number",defaultValue:m==null?void 0:m.phone_number,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{f(!1),x(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:n.save})]})]})]})}),g&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.deleteCustomer}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.confirmDelete}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>y(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{onClick:()=>b(g),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:n.delete})]})]})})]})}const gh={ar:{cashDrawer:"درج النقود",currentBalance:"الرصيد الحالي",totalDeposits:"إجمالي الإيداعات",totalWithdrawals:"إجمالي السحوبات",transactionHistory:"سجل المعاملات",newTransaction:"معاملة جديدة",date:"التاريخ",type:"النوع",amount:"المبلغ",reason:"السبب",balance:"الرصيد",deposit:"إيداع",withdrawal:"سحب",transactionType:"نوع المعاملة",cancel:"إلغاء",confirm:"تأكيد",balanceOverTime:"تطور الرصيد",dailyTransactions:"المعاملات اليومية",currency:"ر.ع",transactionAdded:"تمت إضافة المعاملة بنجاح",loading:"جاري التحميل...",errorLoadingRecords:"حدث خطأ أثناء تحميل السجلات",errorProcessingTransaction:"حدث خطأ أثناء معالجة المعاملة",processing:"جاري المعالجة...",today:"اليوم",thisWeek:"هذا الأسبوع",thisMonth:"هذا الشهر",totalSales:"إجمالي المبيعات النقدية",totalReturns:"إجمالي المرتجعات",manualAdditions:"الإضافات اليدوية",manualRemovals:"السحوبات اليدوية",netCashFlow:"صافي التدفق النقدي",totalTransactions:"عدد المعاملات",cashier:"الكاشير",previousBalance:"الرصيد السابق",newBalance:"الرصيد الجديد",sale:"مبيعات",return:"مرتجعات"},en:{cashDrawer:"Cash Drawer",currentBalance:"Current Balance",totalDeposits:"Total Deposits",totalWithdrawals:"Total Withdrawals",transactionHistory:"Transaction History",newTransaction:"New Transaction",date:"Date",type:"Type",amount:"Amount",reason:"Reason",balance:"Balance",deposit:"Deposit",withdrawal:"Withdrawal",transactionType:"Transaction Type",cancel:"Cancel",confirm:"Confirm",balanceOverTime:"Balance Over Time",dailyTransactions:"Daily Transactions",currency:"OMR",transactionAdded:"Transaction added successfully",loading:"Loading...",errorLoadingRecords:"Error loading records",errorProcessingTransaction:"Error processing transaction",processing:"Processing...",today:"Today",thisWeek:"This Week",thisMonth:"This Month",totalSales:"Total Cash Sales",totalReturns:"Total Returns",manualAdditions:"Manual Additions",manualRemovals:"Manual Removals",netCashFlow:"Net Cash Flow",totalTransactions:"Total Transactions",cashier:"Cashier",previousBalance:"Previous Balance",newBalance:"New Balance",sale:"Sales",return:"Returns"}};function rM({onTransaction:t}){const{language:e}=Y(),n=gh[e],[s,r]=w.useState(!1),[i,a]=w.useState("deposit"),[l,c]=w.useState(""),[d,u]=w.useState(""),[h,f]=w.useState(!1),[m,x]=w.useState(null),g=async y=>{if(y.preventDefault(),!(!l||!d))try{f(!0),x(null),await t(i,parseFloat(l),d),r(!1),c(""),u("")}catch(v){console.error("Error processing transaction:",v),x(n.errorProcessingTransaction)}finally{f(!1)}};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>r(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:n.newTransaction}),s&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.newTransaction}),o.jsxs("form",{onSubmit:g,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.transactionType}),o.jsxs("select",{value:i,onChange:y=>a(y.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:e==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"deposit",children:n.deposit}),o.jsx("option",{value:"withdrawal",children:n.withdrawal})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.amount}),o.jsx("input",{type:"number",step:"0.001",min:"0",value:l,onChange:y=>c(y.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.reason}),o.jsx("textarea",{value:d,onChange:y=>u(y.target.value),required:!0,rows:3,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:e==="ar"?"rtl":"ltr"})]}),m&&o.jsx("div",{className:"bg-red-50 text-red-600 p-2 rounded-md text-sm",children:m}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 text-gray-700 hover:text-gray-900",disabled:h,children:n.cancel}),o.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:h?n.processing:n.confirm})]})]})]})})]})}Er.getChart("cash-balance-chart")||Er.register(nl,sl,Ei,tr,xa,Wy,qy,Uy);function iM({transactions:t}){const{language:e}=Y(),n=gh[e],s=e==="ar"?Xu:Fl,r=w.useMemo(()=>{const u=Ga(new Date),h=Y0(u,29);return V0({start:h,end:u})},[]),i=w.useMemo(()=>{const u=new Map,h=new Map;let f=0;return r.forEach(m=>{const x=Fn(m,"yyyy-MM-dd");h.set(x,{deposits:0,withdrawals:0})}),t.forEach(m=>{const x=Fn(new Date(m.date),"yyyy-MM-dd");if(h.has(x)){const g=h.get(x);m.type==="deposit"?g.deposits+=m.amount:g.withdrawals+=m.amount,h.set(x,g)}}),r.forEach(m=>{const x=Fn(m,"yyyy-MM-dd"),g=h.get(x);f+=g.deposits-g.withdrawals,u.set(x,f)}),{labels:r.map(m=>Fn(m,"MMM d",{locale:s})),balances:Array.from(u.values()),transactions:Array.from(h.values())}},[t,r,s]),a={responsive:!0,plugins:{legend:{position:"top",align:"end",rtl:e==="ar",labels:{boxWidth:10,usePointStyle:!0}},title:{display:!0,text:n.balanceOverTime}},scales:{y:{beginAtZero:!0,ticks:{callback:u=>`${u} ${n.currency}`}}}},l={responsive:!0,plugins:{legend:{position:"top",align:"end",rtl:e==="ar",labels:{boxWidth:10,usePointStyle:!0}},title:{display:!0,text:n.dailyTransactions}},scales:{y:{beginAtZero:!0,ticks:{callback:u=>`${u} ${n.currency}`}}}},c={labels:i.labels,datasets:[{label:n.balance,data:i.balances,borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.5)",tension:.4}]},d={labels:i.labels,datasets:[{label:n.deposits,data:i.transactions.map(u=>u.deposits),backgroundColor:"rgba(34, 197, 94, 0.5)",borderColor:"rgb(34, 197, 94)",borderWidth:1},{label:n.withdrawals,data:i.transactions.map(u=>u.withdrawals),backgroundColor:"rgba(239, 68, 68, 0.5)",borderColor:"rgb(239, 68, 68)",borderWidth:1}]};return o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsx(Jy,{id:"cash-balance-chart",options:a,data:c})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:o.jsx(X5,{id:"cash-transactions-chart",options:l,data:d})})]})}function oM(){const{language:t}=Y(),{user:e}=ce(),{getCurrentBranch:n}=Ze(),s=gh[t],[r,i]=w.useState(!0),[a,l]=w.useState(null),[c,d]=w.useState([]),[u,h]=w.useState("today");w.useState(!1);const f=n(),m=w.useMemo(()=>c.reduce((p,b)=>(b.cash_change_reason==="sale"?p.totalSales+=b.cash_additions||0:b.cash_change_reason==="return"?p.totalReturns+=b.cash_removals||0:(b.cash_additions>0&&(p.totalManualAdditions+=b.cash_additions),b.cash_removals>0&&(p.totalManualRemovals+=b.cash_removals)),p),{totalSales:0,totalReturns:0,totalManualAdditions:0,totalManualRemovals:0}),[c]);w.useEffect(()=>{e!=null&&e.businessCode&&f&&x()},[e==null?void 0:e.businessCode,f]);const x=async()=>{try{i(!0);const p=await fk(e.businessCode,{branchName:f.branch_name});d(p)}catch(p){console.error("Error loading cash records:",p),l(s.errorLoadingRecords)}finally{i(!1)}},g=w.useMemo(()=>c.map(p=>({id:p.tracking_id,type:p.cash_additions>0?"deposit":"withdrawal",amount:p.cash_additions>0?p.cash_additions:p.cash_removals,reason:p.cash_change_reason||"",date:p.created_at,balanceAfter:p.new_total_cash})),[c]),y=w.useMemo(()=>{var p;return((p=c[0])==null?void 0:p.new_total_cash)||0},[c]);w.useMemo(()=>c.reduce((p,b)=>p+(b.cash_additions||0),0),[c]),w.useMemo(()=>c.reduce((p,b)=>p+(b.cash_removals||0),0),[c]);const v=async(p,b,j)=>{try{if(!f)throw new Error("No branch selected");await pk(e.businessCode,f.branch_name,e.name,p==="deposit"?b:-b,j),await x()}catch(_){throw console.error("Error processing transaction:",_),_}};return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:s.cashDrawer}),o.jsx("div",{className:"flex space-x-2 space-x-reverse",children:o.jsxs("select",{value:u,onChange:p=>h(p.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"today",children:s.today}),o.jsx("option",{value:"week",children:s.thisWeek}),o.jsx("option",{value:"month",children:s.thisMonth})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx(ho,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:s.currentBalance}),o.jsxs("p",{className:"text-3xl font-bold mt-1",children:[y.toFixed(3)," ",s.currency]})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:o.jsx(i1,{className:"w-6 h-6 text-blue-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:s.totalDeposits}),o.jsxs("p",{className:"text-3xl font-bold mt-1",children:[g.filter(p=>p.type==="deposit").reduce((p,b)=>p+b.amount,0).toFixed(3)," ",s.currency]})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:o.jsx(s1,{className:"w-6 h-6 text-red-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:s.totalWithdrawals}),o.jsxs("p",{className:"text-3xl font-bold mt-1",children:[g.filter(p=>p.type==="withdrawal").reduce((p,b)=>p+b.amount,0).toFixed(3)," ",s.currency]})]})]})}),o.jsxs("div",{className:"col-span-full grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s.totalSales}),o.jsxs("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:[m.totalSales.toFixed(3)," ",s.currency]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s.totalReturns}),o.jsxs("p",{className:"mt-2 text-3xl font-semibold text-red-600",children:[m.totalReturns.toFixed(3)," ",s.currency]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s.manualAdditions}),o.jsxs("p",{className:"mt-2 text-3xl font-semibold text-green-600",children:[m.totalManualAdditions.toFixed(3)," ",s.currency]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-500",children:s.manualRemovals}),o.jsxs("p",{className:"mt-2 text-3xl font-semibold text-yellow-600",children:[m.totalManualRemovals.toFixed(3)," ",s.currency]})]})]}),o.jsx(iM,{transactions:g})]}),r?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s.loading})}):a?o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:a}):o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(e1,{className:"w-5 h-5 text-gray-500"}),o.jsx("h2",{className:"text-lg font-semibold",children:s.transactionHistory})]})}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.date}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.cashier}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.type}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.amount}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.reason}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.previousBalance}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.newBalance})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((p,b)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p.cashier_name||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.cash_additions>0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.cash_additions>0?s.deposit:s.withdrawal})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(p.cash_additions||p.cash_removals).toFixed(3)," ",s.currency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`text-sm ${p.cash_change_reason==="sale"?"text-green-600":p.cash_change_reason==="return"?"text-red-600":"text-gray-500"}`,children:p.cash_change_reason==="sale"?s.sale:p.cash_change_reason==="return"?s.return:p.cash_change_reason})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[p.previous_total_cash.toFixed(3)," ",s.currency]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[p.new_total_cash.toFixed(3)," ",s.currency]})]},p.tracking_id))})]}),o.jsx("div",{className:"p-4 border-t bg-gray-50",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-500",children:s.netCashFlow}),o.jsxs("p",{className:`mt-1 text-lg font-semibold ${m.totalSales+m.totalManualAdditions-m.totalReturns-m.totalManualRemovals>0?"text-green-600":"text-red-600"}`,children:[(m.totalSales+m.totalManualAdditions-m.totalReturns-m.totalManualRemovals).toFixed(3)," ",s.currency]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-500",children:s.totalTransactions}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:c.length})]})]})})]})]}),o.jsx(rM,{onTransaction:v})]})}const aM={ar:{reports:"التقارير",selectDate:"اختر التاريخ",exportReport:"تصدير التقرير",monthlySales:"المبيعات الشهرية",topSellingProducts:"المنتجات الأكثر مبيعاً",customerAnalytics:"تحليل العملاء",inventory:"المخزون",chartComingSoon:"سيتم إضافة الرسم البياني هنا"},en:{reports:"Reports",selectDate:"Select Date",exportReport:"Export Report",monthlySales:"Monthly Sales",topSellingProducts:"Top Selling Products",customerAnalytics:"Customer Analytics",inventory:"Inventory",chartComingSoon:"Chart will be added here"}};function lM(){const{language:t}=Y(),e=aM[t];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.reports}),o.jsxs("div",{className:"flex space-x-4 space-x-reverse",children:[o.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(_r,{className:"w-5 h-5 ml-2"}),e.selectDate]}),o.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(Zx,{className:"w-5 h-5 ml-2"}),e.exportReport]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.monthlySales}),o.jsx("div",{className:"aspect-[4/3] bg-gray-50 rounded-lg flex items-center justify-center",children:o.jsx("p",{className:"text-gray-500",children:e.chartComingSoon})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.topSellingProducts}),o.jsx("div",{className:"aspect-[4/3] bg-gray-50 rounded-lg flex items-center justify-center",children:o.jsx("p",{className:"text-gray-500",children:e.chartComingSoon})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.customerAnalytics}),o.jsx("div",{className:"aspect-[4/3] bg-gray-50 rounded-lg flex items-center justify-center",children:o.jsx("p",{className:"text-gray-500",children:e.chartComingSoon})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:e.inventory}),o.jsx("div",{className:"aspect-[4/3] bg-gray-50 rounded-lg flex items-center justify-center",children:o.jsx("p",{className:"text-gray-500",children:e.chartComingSoon})})]})]})]})}const Xy={ar:{settings:"الإعدادات",saveSettings:"حفظ الإعدادات",saving:"جاري الحفظ...",productTypes:"أنواع المنتجات",allowedProducts:"المنتجات المسموح بها",foodProducts:"منتجات غذائية",nonFoodProducts:"منتجات غير غذائية",defaultProductType:"النوع الافتراضي للمنتجات",receipt:"الفاتورة",receiptHeader:"ترويسة الفاتورة",receiptFooter:"تذييل الفاتورة",showLogo:"إظهار شعار المتجر في الفاتورة",loyaltySystem:"نظام الولاء",enableLoyalty:"تفعيل نظام النقاط والولاء",tax:"الضريبة",enableTax:"تفعيل الضريبة",taxPercentage:"نسبة الضريبة (%)",settingsSaved:"تم حفظ الإعدادات بنجاح",vendorCommission:"عمولة الموردين",enableCommission:"تفعيل العمولة على مبيعات الموردين",defaultCommission:"العمولة الافتراضية",minimumAmount:"الحد الأدنى للمبلغ",minimumAmountHint:"سيتم تطبيق العمولة فقط على المبيعات التي تتجاوز هذا المبلغ",cancel:"إلغاء",currency:"ر.ع",businessLogo:"شعار المتجر",uploadLogo:"رفع شعار المتجر",chooseFile:"اختر صورة",uploadInstructions:"PNG, JPG حتى 5MB",uploading:"جاري الرفع...",errorUploadingLogo:"حدث خطأ أثناء رفع الشعار",loading:"جاري التحميل...",errorLoadingSettings:"حدث خطأ أثناء تحميل الإعدادات",errorSavingSettings:"حدث خطأ أثناء حفظ الإعدادات"},en:{settings:"Settings",saveSettings:"Save Settings",saving:"Saving...",productTypes:"Product Types",allowedProducts:"Allowed Products",foodProducts:"Food Products",nonFoodProducts:"Non-Food Products",defaultProductType:"Default Product Type",receipt:"Receipt",receiptHeader:"Receipt Header",receiptFooter:"Receipt Footer",showLogo:"Show Store Logo on Receipt",loyaltySystem:"Loyalty System",enableLoyalty:"Enable Points and Loyalty System",tax:"Tax",enableTax:"Enable Tax",taxPercentage:"Tax Percentage (%)",settingsSaved:"Settings saved successfully",vendorCommission:"Vendor Commission",enableCommission:"Enable commission on vendor sales",defaultCommission:"Default Commission",minimumAmount:"Minimum Amount",minimumAmountHint:"Commission will only apply to sales above this amount",cancel:"Cancel",currency:"OMR",businessLogo:"Business Logo",uploadLogo:"Upload Business Logo",chooseFile:"Choose file",uploadInstructions:"PNG, JPG up to 5MB",uploading:"Uploading...",errorUploadingLogo:"Error uploading logo",loading:"Loading...",errorLoadingSettings:"Error loading settings",errorSavingSettings:"Error saving settings"}};function cM({settings:t,onUpdate:e}){const{language:n}=Y();ce();const s=Xy[n],[r,i]=Ke.useState(!1),a=async l=>{try{i(!0),e(l)}catch(c){console.error("Error updating vendor commission settings:",c)}finally{i(!1)}};return o.jsxs("div",{className:"p-6 bg-white rounded-lg shadow divide-y",children:[o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-4",children:[o.jsx(s0,{className:"w-5 h-5 text-indigo-600"}),o.jsx("h2",{className:"text-lg font-medium",children:s.vendorCommission})]}),o.jsxs("div",{className:"pt-4 space-y-4",children:[o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("input",{type:"checkbox",checked:t.vendor_commission_enabled,onChange:l=>a({vendor_commission_enabled:l.target.checked}),disabled:r,className:"rounded text-indigo-600 focus:ring-indigo-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.enableCommission})]})}),t.vendor_commission_enabled&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.defaultCommission}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"number",value:t.default_commission_rate,onChange:l=>a({default_commission_rate:parseFloat(l.target.value)}),disabled:r,min:"0",max:"100",step:"0.1",className:"w-24 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("span",{className:"mr-2",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.minimumAmount}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"number",value:t.minimum_commission_amount,onChange:l=>a({minimum_commission_amount:parseFloat(l.target.value)}),disabled:r,min:"0",step:"0.1",className:"w-32 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("span",{className:"mr-2",children:s.currency})]}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s.minimumAmountHint})]})]})]})]})}function dM(){const{language:t}=Y(),{user:e}=ce(),{settings:n,setSettings:s}=_n(),r=Xy[t],[i,a]=w.useState(!1),[l,c]=w.useState(null),{upload:d,isUploading:u}=eh(),[h,f]=w.useState(null);w.useEffect(()=>{n!=null&&n.url_logo_of_business&&f(n.url_logo_of_business)},[n==null?void 0:n.url_logo_of_business]);const m=async g=>{var v;const y=(v=g.target.files)==null?void 0:v[0];if(y){c(null);try{const p=URL.createObjectURL(y);f(p);const b=await d(y);if(console.log("Uploaded logo URL:",b),!b)throw new Error("Failed to upload logo");n&&(s({...n,url_logo_of_business:b}),await Fd(e.businessCode,{url_logo_of_business:b}),console.log("Logo URL saved to settings"))}catch(p){console.error("Error uploading logo:",p),c(r.errorUploadingLogo),f(null),n!=null&&n.url_logo_of_business&&f(n.url_logo_of_business)}}},x=async()=>{a(!0),c(null);const g={receipt_header:n.receipt_header,receipt_footer:n.receipt_footer,url_logo_of_business:n.url_logo_of_business,loyalty_system_enabled:n.loyalty_system_enabled,vendor_commission_enabled:n.vendor_commission_enabled,default_commission_rate:n.default_commission_rate,minimum_commission_amount:n.minimum_commission_amount,tax_enabled:n.tax_enabled,tax_rate:n.tax_rate};try{if(!(e!=null&&e.businessCode)||!n)return;console.log("Saving settings:",g),await Fd(e.businessCode,g);const y=await F0(e.businessCode);s(y),alert(r.settingsSaved)}catch(y){console.error("Error saving settings:",y),c(r.errorSavingSettings)}finally{a(!1)}};return n?o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:r.settings}),o.jsx("button",{onClick:x,disabled:i,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-gray-400",children:i?r.saving:r.saveSettings})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow divide-y",children:[o.jsxs("div",{className:"p-6",children:[l&&o.jsx("div",{className:"mb-4 rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:l})})]})}),o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-6",children:[o.jsx(t1,{className:"w-5 h-5 text-indigo-600"}),o.jsx("h2",{className:"text-lg font-medium",children:r.businessLogo})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"flex items-start space-x-4 space-x-reverse",children:[o.jsx("div",{className:"w-32 h-32 border-2 border-gray-300 rounded-lg overflow-hidden flex items-center justify-center bg-gray-50",children:h?o.jsxs("div",{className:"relative w-full h-full",children:[o.jsx("img",{src:h,alt:"Business logo",className:"w-full h-full object-contain"}),o.jsx("button",{type:"button",onClick:()=>{f(null),n&&s({...n,url_logo_of_business:null})},className:"absolute top-1 right-1 bg-red-100 text-red-600 rounded-full p-1 hover:bg-red-200",children:"×"})]}):o.jsx(Be,{className:"w-12 h-12 text-gray-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r.uploadLogo}),o.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:o.jsxs("div",{className:"space-y-1 text-center",children:[o.jsx(qu,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("div",{className:"flex text-sm text-gray-600",children:o.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500",children:[o.jsx("span",{children:r.chooseFile}),o.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"sr-only",disabled:u})]})}),o.jsx("p",{className:"text-xs text-gray-500",children:u?r.uploading:r.uploadInstructions})]})})]})]})})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-4",children:[o.jsx(i0,{className:"w-5 h-5 text-indigo-600"}),o.jsx("h2",{className:"text-lg font-medium",children:r.productTypes})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.receiptHeader,":"]}),o.jsx("textarea",{value:n.receipt_header||"",onChange:g=>s({...n,receipt_header:g.target.value}),rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.receiptFooter,":"]}),o.jsx("textarea",{value:n.receipt_footer||"",onChange:g=>s({...n,receipt_footer:g.target.value}),rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("input",{type:"checkbox",checked:!!n.url_logo_of_business,onChange:g=>s({...n,url_logo_of_business:g.target.checked?"":null}),className:"rounded text-indigo-600 focus:ring-indigo-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r.showLogo})]})})]})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-4",children:[o.jsx(Gi,{className:"w-5 h-5 text-indigo-600"}),o.jsx("h2",{className:"text-lg font-medium",children:r.loyaltySystem})]}),o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("input",{type:"checkbox",checked:n.loyalty_system_enabled,onChange:g=>s({...n,loyalty_system_enabled:g.target.checked}),className:"rounded text-indigo-600 focus:ring-indigo-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r.enableLoyalty})]})})]}),o.jsx(cM,{settings:n,onUpdate:g=>{s({...n,...g})}}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-4",children:[o.jsx(s0,{className:"w-5 h-5 text-indigo-600"}),o.jsx("h2",{className:"text-lg font-medium",children:r.tax})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx("input",{type:"checkbox",checked:n.tax_enabled,onChange:g=>s({...n,tax_enabled:g.target.checked}),className:"rounded text-indigo-600 focus:ring-indigo-500"}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:r.enableTax})]})}),n.tax_enabled&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.taxPercentage,":"]}),o.jsx("input",{type:"number",min:"0",max:"100",value:n.tax_rate||0,onChange:g=>s({...n,tax_rate:parseFloat(g.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:"ltr"})]}),l&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:l})})]})})]})]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500",children:r.loading})})}const uM={ar:{settings:"الإعدادات",businessInformation:"معلومات المتجر",businessName:"اسم المتجر",ownerName:"اسم المالك",email:"البريد الإلكتروني",phone:"رقم الهاتف",businessCode:"رمز المتجر",businessCodeHint:"رمز المتجر يستخدم للتعريف الفريد في النظام ولا يمكن تغييره",save:"حفظ التغييرات",saving:"جاري الحفظ...",loading:"جاري التحميل...",errorLoadingProfile:"حدث خطأ أثناء تحميل البيانات",errorSavingProfile:"حدث خطأ أثناء حفظ التغييرات",profileUpdated:"تم تحديث البيانات بنجاح"},en:{settings:"Settings",businessInformation:"Business Information",businessName:"Business Name",ownerName:"Owner Name",email:"Email",phone:"Phone",businessCode:"Business Code",businessCodeHint:"Business code is used for unique identification and cannot be changed",save:"Save Changes",saving:"Saving...",loading:"Loading...",errorLoadingProfile:"Error loading profile data",errorSavingProfile:"Error saving changes",profileUpdated:"Profile updated successfully"}},Sp=Dl("https://qpzpxtlzgtdxaskmgoku.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI");async function Zy(t){try{const{data:e,error:n}=await V.from("vendor_assignments").select("*").eq("owner_business_code",t);if(n)throw n;if(!e)return[];const{data:s,error:r}=await V.from("profiles").select("*").in("his_email",e.map(a=>a.vendor_email_identifier));if(r)throw r;return e.map(a=>{const l=s==null?void 0:s.find(c=>c.his_email===a.vendor_email_identifier);return{...a,profile:l?{full_name:l.full_name,phone_number:l.phone_number,"vendor_business _name":l["vendor_business _name"]}:void 0}})}catch(e){throw console.error("Error fetching vendor assignments:",e),e}}async function hM(t){var n;let e;try{const s=`VND${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:r}=await V.from("profiles").select("*").eq("his_email",t.email).maybeSingle();if(r)throw new Error("A vendor with this email already exists");try{const{data:c,error:d}=await Sp.auth.admin.createUser({email:t.email,password:t.password,email_confirm:!0,user_metadata:{role:"vendor",business_code:s}});if(d)throw d;e=c.user.id}catch(c){throw(n=c.message)!=null&&n.includes("already been registered")?new Error("Email already registered. Please use a different email."):c}let i;const{data:a,error:l}=await Sp.from("profiles").insert({user_id:e,full_name:t.full_name,his_email:t.email,phone_number:t.phone_number,role:"vendor",is_vendor:!0,business_code:s,working_status:"working","vendor_business _name":t.vendor_business_name}).select().single();if(l)throw l;if(i=a,!i)throw new Error("Failed to create/update vendor profile");return{business_code:i.business_code,full_name:i.full_name||"",vendor_business_name:i["vendor_business _name"]||"",his_email:i.his_email||""}}catch(s){throw console.error("Error in createVendor:",s,{existingUser}),s}}async function ev(t){const{data:e,error:n}=await V.from("vendor_assignments").select("*").eq("vendor_business_code",t);if(n)throw console.error("Error fetching vendor assignments:",n),n;return e||[]}async function fM(t){const{data:e,error:n}=await V.from("profiles").select('business_code, full_name, "vendor_business _name", his_email').eq("his_email",t).eq("is_vendor",!0).maybeSingle();return n?(console.error("Error checking vendor email:",n),null):e!=null&&e.business_code?{business_code:e.business_code,full_name:e.full_name||"",vendor_business_name:e["vendor_business _name"]||"",his_email:t}:(console.error("Vendor profile incomplete:",e),null)}async function kp(t){try{const{data:e,error:n}=await V.from("profiles").select('business_code, "vendor_business _name"').eq("his_email",t.vendor_email_identifier).eq("is_vendor",!0).single();if(n||!e)throw new Error("Vendor not found");const{data:s,error:r}=await V.from("profiles").select("business_name, role").eq("business_code",t.owner_business_code).eq("role","owner").single();if(r||!(s!=null&&s.business_name))throw new Error("Could not find owner profile. Make sure the business code belongs to a store owner.");const{data:i,error:a}=await V.from("vendor_assignments").select("assignment_id").eq("vendor_business_code",e.business_code).eq("branch_name",t.branch_name);if(a)throw console.error("Error checking existing assignments:",a),a;if(i&&i.length>0)throw new Error("Vendor already assigned to this branch");const{data:l,error:c}=await V.from("vendor_assignments").insert([{vendor_business_code:e.business_code,owner_business_code:t.owner_business_code,branch_name:t.branch_name,vendor_email_identifier:t.vendor_email_identifier,owner_business_name:s.business_name}]).select().single();if(c)throw console.error("Error assigning vendor:",c),c;return l}catch(e){throw console.error("Error in assignVendor:",e),e}}async function mM(t){const{error:e}=await V.from("vendor_assignments").delete().eq("assignment_id",t);if(e)throw console.error("Error removing vendor assignment:",e),e;return!0}async function pM(t){const{data:e,error:n}=await V.from("profiles").select('business_code, full_name, "vendor_business _name", his_email').eq("business_code",t).eq("is_vendor",!0).single();if(n)throw console.error("Error fetching vendor profile:",n),n;return e?{business_code:e.business_code,full_name:e.full_name||"",vendor_business_name:e["vendor_business _name"]||"",his_email:e.his_email||""}:null}async function gM(t,e){const{error:n}=await V.from("profiles").update({full_name:e.full_name,"vendor_business _name":e.vendor_business_name,his_email:e.his_email}).eq("business_code",t).eq("is_vendor",!0);if(n)throw console.error("Error updating vendor profile:",n),n}function xM(){const{language:t}=Y(),{user:e}=ce(),n=uM[t],[s,r]=w.useState(null),[i,a]=w.useState(!0),[l,c]=w.useState(!1),[d,u]=w.useState(null),[h,f]=w.useState(!1);w.useEffect(()=>{e!=null&&e.businessCode&&m()},[e==null?void 0:e.businessCode]);const m=async()=>{try{a(!0);const g=await pM(e.businessCode);r(g)}catch(g){console.error("Error loading profile:",g),u(n.errorLoadingProfile)}finally{a(!1)}},x=async g=>{g.preventDefault(),u(null),f(!1),c(!0);try{const y=new FormData(g.currentTarget),v={full_name:y.get("full_name"),vendor_business_name:y.get("business_name"),his_email:y.get("email")};await gM(e.businessCode,v),f(!0),await m()}catch(y){console.error("Error updating profile:",y),u(n.errorSavingProfile)}finally{c(!1)}};return i?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h1",{className:"text-2xl font-bold",children:n.settings})}),o.jsx("div",{className:"bg-white rounded-lg shadow",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse mb-6",children:[o.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:o.jsx(Be,{className:"w-6 h-6 text-indigo-600"})}),o.jsx("h2",{className:"text-lg font-semibold",children:n.businessInformation})]}),o.jsxs("form",{onSubmit:x,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.businessName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"business_name",defaultValue:(s==null?void 0:s.vendor_business_name)||"",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.ownerName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"full_name",defaultValue:(s==null?void 0:s.full_name)||"",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.email," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx(t0,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"email",name:"email",defaultValue:(s==null?void 0:s.his_email)||"",required:!0,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.businessCode}),o.jsx("input",{type:"text",value:(s==null?void 0:s.business_code)||"",readOnly:!0,className:"w-full px-3 py-2 border rounded-md bg-gray-50",dir:"ltr"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n.businessCodeHint})]}),d&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:d})})]})}),h&&o.jsx("div",{className:"rounded-md bg-green-50 p-4",children:o.jsx("p",{className:"text-sm text-green-700",children:n.profileUpdated})}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-gray-400",children:l?n.saving:n.save})})]})]})})]})}const yM={ar:{branches:"الفروع",addBranch:"إضافة فرع",editBranch:"تعديل الفرع",branchName:"اسم الفرع",location:"الموقع",phone:"رقم الهاتف",searchBranch:"ابحث عن فرع...",status:"الحالة",active:"نشط",inactive:"غير نشط",currentBranch:"الفرع الحالي",allBranches:"جميع الفروع",save:"حفظ",cancel:"إلغاء",activate:"تفعيل",deactivate:"إيقاف",confirmDeactivate:"هل أنت متأكد من إيقاف هذا الفرع؟",confirmActivate:"تأكيد تفعيل الفرع",confirmActivateMessage:"هل أنت متأكد من تفعيل فرع {name}؟",confirm:"تأكيد",branchAdded:"تم إضافة الفرع بنجاح",branchUpdated:"تم تحديث الفرع بنجاح",branchDeactivated:"تم إيقاف الفرع بنجاح",branchActivated:"تم تفعيل الفرع بنجاح",loading:"جاري التحميل...",errorLoadingBranches:"حدث خطأ أثناء تحميل الفروع",errorSavingBranch:"حدث خطأ أثناء حفظ الفرع",errorDeactivatingBranch:"حدث خطأ أثناء إيقاف الفرع",errorActivatingBranch:"حدث خطأ أثناء تفعيل الفرع"},en:{branches:"Branches",addBranch:"Add Branch",editBranch:"Edit Branch",branchName:"Branch Name",location:"Location",phone:"Phone Number",searchBranch:"Search for a branch...",status:"Status",active:"Active",inactive:"Inactive",currentBranch:"Current Branch",allBranches:"All Branches",save:"Save",cancel:"Cancel",activate:"Activate",deactivate:"Deactivate",confirmDeactivate:"Are you sure you want to deactivate this branch?",confirmActivate:"Confirm Branch Activation",confirmActivateMessage:"Are you sure you want to activate branch {name}?",confirm:"Confirm",branchAdded:"Branch added successfully",branchUpdated:"Branch updated successfully",branchDeactivated:"Branch deactivated successfully",branchActivated:"Branch activated successfully",loading:"Loading...",errorLoadingBranches:"Error loading branches",errorSavingBranch:"Error saving branch",errorDeactivatingBranch:"Error deactivating branch",errorActivatingBranch:"Error activating branch"}};async function vM(t){const{data:e,error:n}=await V.from("branches").select("*").eq("business_code",t);if(n)throw console.error("Error fetching branches:",n),n;return e||[]}async function bM(t){const{data:e,error:n}=await V.from("branches").insert([t]).select().single();if(n)throw console.error("Error creating branch:",n),n;return e}async function wM(t,e){const{data:n,error:s}=await V.from("branches").update(e).eq("branch_id",t).select().single();if(s)throw console.error("Error updating branch:",s),s;return n}async function _M(t,e){try{const{data:n,error:s}=await V.from("branches").update({is_active:e}).eq("branch_id",t).select().single();if(s)throw s;if(!n)throw new Error("Branch not found");return n}catch(n){throw console.error("Error updating branch status:",n),n}}function jM(){const{language:t}=Y(),{user:e}=ce(),n=yM[t],[s,r]=w.useState(null),[i,a]=w.useState([]),[l,c]=w.useState(!0),[d,u]=w.useState(null),[h,f]=w.useState(!1),[m,x]=w.useState(null),[g,y]=w.useState("");w.useEffect(()=>{e!=null&&e.businessCode&&v()},[e==null?void 0:e.businessCode]);const v=async()=>{try{c(!0);const _=await vM(e.businessCode);a(_)}catch(_){console.error("Error loading branches:",_),u(n.errorLoadingBranches)}finally{c(!1)}},p=async _=>{_.preventDefault(),u(null);const C=new FormData(_.currentTarget);try{const S={branch_name:C.get("name"),is_active:C.get("status")==="active",business_code:e.businessCode};m?await wM(m.branch_id,S):await bM(S),await v(),f(!1),x(null)}catch(S){console.error("Error saving branch:",S),u(n.errorSavingBranch)}},b=async _=>{try{await _M(_.branch_id,!_.is_active),await v()}catch(C){console.error("Error toggling branch status:",C),u(_.is_active?n.errorDeactivatingBranch:n.errorActivatingBranch)}},j=i.filter(_=>_.branch_name.toLowerCase().includes(g.toLowerCase())||_.location.toLowerCase().includes(g.toLowerCase()));return l?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.branches}),o.jsxs("button",{onClick:()=>f(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),n.addBranch]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:g,onChange:_=>y(_.target.value),placeholder:n.searchBranch,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]})}),d&&o.jsx("div",{className:"p-4 bg-red-50",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:d})})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.branchName}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.status}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:n.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(_=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(wr,{className:"h-6 w-6 text-gray-400"})}),o.jsx("div",{className:"mr-4",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.branch_name})})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${_.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n[_.is_active?"active":"inactive"]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>{x(_),f(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:n.edit}),o.jsx("button",{onClick:()=>_.is_active?confirm(n.confirmDeactivate)&&b(_):r(_),className:`${_.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,children:_.is_active?n.deactivate:n.activate})]})]},_.branch_id))})]})})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:m?n.editBranch:n.addBranch}),o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.branchName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"name",defaultValue:m==null?void 0:m.branch_name,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.status}),o.jsxs("select",{name:"status",defaultValue:m!=null&&m.is_active?"active":"inactive",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"active",children:n.active}),o.jsx("option",{value:"inactive",children:n.inactive})]})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{f(!1),x(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:n.save})]})]})]})}),s&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.confirmActivate}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.confirmActivateMessage.replace("{name}",s.branch_name)}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>r(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{onClick:()=>{b(s),r(null)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:n.confirm})]})]})})]})}const tv={ar:{cashiers:"إدارة الكاشير",addCashier:"إضافة كاشير",searchCashier:"ابحث عن كاشير...",noSearchResults:"لا توجد نتائج للبحث",noCashiers:"لا يوجد كاشير",loading:"جاري التحميل...",filter:"تصفية",cashier:"الكاشير",name:"الاسم",email:"البريد الإلكتروني",phoneNumber:"رقم الهاتف",branch:"الفرع",changeStatus:"تغيير الحالة",selectNewStatus:"اختر الحالة الجديدة",selectBranch:"اختر الفرع",status:"الحالة",actions:"إجراءات",edit:"تعديل",delete:"حذف",confirmDelete:"تأكيد الحذف",deleteConfirmMessage:"هل أنت متأكد من حذف الكاشير {name}؟ سيتم حذف حسابه بشكل نهائي.",active:"نشط",onLeave:"في إجازة",suspended:"موقوف",working:"يعمل",vacation:"إجازة",sick:"مرضي",absent:"غائب",salary:"الراتب",addSalary:"إضافة راتب",editSalary:"تعديل الراتب",basicSalary:"الراتب الأساسي",bonus:"المكافآت",deductions:"الخصومات",paymentDate:"تاريخ الدفع",notes:"ملاحظات",totalSalary:"إجمالي الراتب",salaryHistory:"سجل الرواتب",viewSalary:"عرض الراتب",currency:"ر.ع",addNewCashier:"إضافة كاشير جديد",editCashier:"تعديل بيانات الكاشير",cashierName:"اسم الكاشير",password:"كلمة المرور",confirmPassword:"تأكيد كلمة المرور",save:"حفظ",cancel:"إلغاء",required:"مطلوب",delete:"حذف",confirmAction:"تأكيد الإجراء",confirmActionMessage:"هل أنت متأكد من تنفيذ هذا الإجراء؟",confirm:"تأكيد",currency:"ر.ع",errorLoadingCashiers:"حدث خطأ أثناء تحميل الكاشير",errorSavingCashier:"حدث خطأ أثناء حفظ الكاشير",errorUpdatingStatus:"حدث خطأ أثناء تحديث الحالة",errorUpdatingSalary:"حدث خطأ أثناء تحديث الراتب",errorDeletingCashier:"حدث خطأ أثناء حذف الكاشير"},en:{cashiers:"Cashier Management",addCashier:"Add Cashier",searchCashier:"Search for a cashier...",noSearchResults:"No search results found",noCashiers:"No cashiers found",loading:"Loading...",filter:"Filter",cashier:"Cashier",name:"Name",email:"Email",phoneNumber:"Phone Number",branch:"Branch",changeStatus:"Change Status",selectNewStatus:"Select new status",selectBranch:"Select Branch",status:"Status",actions:"Actions",edit:"Edit",delete:"Delete",confirmDelete:"Confirm Delete",deleteConfirmMessage:"Are you sure you want to delete cashier {name}? Their account will be permanently removed.",active:"Active",onLeave:"On Leave",working:"Working",vacation:"Vacation",sick:"Sick",absent:"Absent",salary:"Salary",addSalary:"Add Salary",editSalary:"Edit Salary",basicSalary:"Basic Salary",bonus:"Bonus",deductions:"Deductions",paymentDate:"Payment Date",notes:"Notes",totalSalary:"Total Salary",salaryHistory:"Salary History",viewSalary:"View Salary",currency:"OMR",addNewCashier:"Add New Cashier",editCashier:"Edit Cashier",cashierName:"Cashier Name",password:"Password",confirmPassword:"Confirm Password",permissions:"Permissions",canManageProducts:"Manage Products",canManageCustomers:"Manage Customers",canViewReports:"View Reports",canProcessRefunds:"Process Refunds",save:"Save",cancel:"Cancel",required:"Required",passwordMismatch:"Passwords do not match",suspendCashier:"Suspend Cashier",confirmSuspend:"Are you sure you want to suspend this cashier?",suspended:"Suspended",activeCashier:"Activate Cashier",errorUpdatingSalary:"Error updating salary",errorDeletingCashier:"Error deleting cashier"}};function NM({isOpen:t,onClose:e,onSubmit:n,initialData:s}){const{language:r}=Y(),i=tv[r],a=d=>{d.preventDefault();const u=new FormData(d.currentTarget);n({basicSalary:parseFloat(u.get("basicSalary")),bonus:parseFloat(u.get("bonus"))||0,deductions:parseFloat(u.get("deductions"))||0,notes:u.get("notes"),paymentDate:u.get("paymentDate")})};if(!t)return null;const l=(d,u,h)=>d+u-h,c=d=>{const u=d.target.form;if(!u)return;const h=parseFloat(u.basicSalary.value)||0,f=parseFloat(u.bonus.value)||0,m=parseFloat(u.deductions.value)||0,x=l(h,f,m),g=u.querySelector("#total-salary");g&&(g.textContent=x.toFixed(3))};return o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-6",children:[o.jsx("div",{className:"bg-indigo-100 p-2 rounded-full",children:o.jsx(ho,{className:"w-6 h-6 text-indigo-600"})}),o.jsx("h2",{className:"text-xl font-semibold",children:s?i.editSalary:i.addSalary})]}),o.jsxs("form",{onSubmit:a,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.basicSalary," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",name:"basicSalary",defaultValue:s==null?void 0:s.basicSalary,onChange:c,required:!0,min:"0",step:"0.001",className:"w-full pl-3 pr-12 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:i.currency})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i.bonus}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",name:"bonus",defaultValue:s==null?void 0:s.bonus,onChange:c,min:"0",step:"0.001",className:"w-full pl-3 pr-12 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:i.currency})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i.deductions}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"number",name:"deductions",defaultValue:s==null?void 0:s.deductions,onChange:c,min:"0",step:"0.001",className:"w-full pl-3 pr-12 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:i.currency})]})]}),o.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(G_,{className:"w-5 h-5 text-gray-500"}),o.jsxs("span",{className:"font-medium",children:[i.totalSalary,":"]})]}),o.jsxs("div",{className:"text-xl font-bold text-indigo-600",children:[o.jsx("span",{id:"total-salary",children:l((s==null?void 0:s.basicSalary)||0,(s==null?void 0:s.bonus)||0,(s==null?void 0:s.deductions)||0).toFixed(3)}),o.jsx("span",{className:"mr-1 text-sm",children:i.currency})]})]})}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.paymentDate," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"date",name:"paymentDate",defaultValue:s==null?void 0:s.paymentDate,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i.notes}),o.jsx("textarea",{name:"notes",defaultValue:s==null?void 0:s.notes,rows:3,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:r==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:i.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:i.save})]})]})]})})}const hi=Dl("https://qpzpxtlzgtdxaskmgoku.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI");async function SM(t){const{data:e,error:n}=await V.from("profiles").select("*").eq("business_code",t).eq("role","cashier").order("created_at",{ascending:!1});if(n)throw console.error("Error fetching cashiers:",n),n;return e||[]}async function kM(t){let e;try{const{data:n}=await hi.auth.admin.listUsers(),s=n.users.find(a=>a.email===t.email);if(s){e=s.id;const{error:a}=await hi.auth.admin.updateUserById(e,{password:t.password,user_metadata:{role:"cashier",business_code:t.business_code}});if(a)throw a}else{const{data:a,error:l}=await hi.auth.admin.createUser({email:t.email,password:t.password,email_confirm:!0,user_metadata:{role:"cashier",business_code:t.business_code}});if(l)throw l;e=a.user.id}const{data:r,error:i}=await hi.from("profiles").upsert({user_id:e,full_name:t.full_name,his_email:t.email,main_branch:t.main_branch,phone_number:t.phone_number,salary:t.salary,role:"cashier",business_code:t.business_code,working_status:t.working_status}).select().single();if(i)throw i;return r}catch(n){throw console.error("Error in createCashier:",n),n}}async function Cp(t,e){const{data:n,error:s}=await V.from("profiles").update(e).eq("user_id",t).eq("role","cashier").select().single();if(s)throw console.error("Error updating cashier:",s),s;return n}async function CM(t,e){const{data:n,error:s}=await V.from("profiles").update({working_status:e}).eq("user_id",t).eq("role","cashier").select().single();if(s)throw console.error("Error updating cashier status:",s),s;return n}async function PM(t){try{const{data:e,error:n}=await V.from("profiles").select("role").eq("user_id",t).single();if(n)throw console.error("Error checking cashier profile:",n),n;if((e==null?void 0:e.role)!=="cashier")throw new Error("User is not a cashier");const{error:s}=await V.from("profiles").delete().match({user_id:t,role:"cashier"});if(s)throw console.error("Error deleting cashier profile:",s),s;const{error:r}=await hi.auth.admin.deleteUser(t);if(r)throw console.error("Error deleting auth user:",r),r;return!0}catch(e){throw console.error("Error in deleteCashier:",e),e}}function EM(){const{language:t}=Y(),{user:e}=ce(),{branches:n}=Ze(),s=tv[t],[r,i]=w.useState([]),[a,l]=w.useState(!0),[c,d]=w.useState(null),[u,h]=w.useState(!1),[f,m]=w.useState(null),[x,g]=w.useState(!1),[y,v]=w.useState(null),[p,b]=w.useState(""),[j,_]=w.useState(null),[C,S]=w.useState(null),k=async E=>{try{await PM(E.user_id),await A(),S(null)}catch(T){console.error("Error deleting cashier:",T),d(s.errorDeletingCashier)}};w.useEffect(()=>{e!=null&&e.businessCode&&A()},[e==null?void 0:e.businessCode]);const A=async()=>{try{l(!0);const E=await SM(e.businessCode);i(E)}catch(E){console.error("Error loading cashiers:",E),d(s.errorLoadingCashiers)}finally{l(!1)}},P=async E=>{if(f)try{await Cp(f.user_id,{salary:E.basicSalary}),await A(),h(!1),m(null)}catch(T){console.error("Error updating salary:",T),d(s.errorUpdatingSalary)}},D=async E=>{E.preventDefault(),d(null);const T=new FormData(E.currentTarget),N={email:T.get("email"),password:T.get("password"),working_status:T.get("working_status"),full_name:T.get("full_name"),main_branch:T.get("main_branch"),salary:parseFloat(T.get("salary")),business_code:e.businessCode,phone_number:T.get("phone_number")};try{y?await Cp(y.user_id,{full_name:N.full_name,main_branch:N.main_branch,salary:N.salary,working_status:N.working_status,phone_number:N.phone_number}):await kM(N),await A(),g(!1),v(null)}catch(R){console.error("Error saving cashier:",R),d(s.errorSavingCashier)}},M=async(E,T)=>{try{await CM(E,T),await A(),_(null)}catch(N){console.error("Error updating status:",N),d(s.errorUpdatingStatus)}},B=r.filter(E=>{var T,N;return((T=E.full_name)==null?void 0:T.toLowerCase().includes(p.toLowerCase()))||((N=E.his_email)==null?void 0:N.toLowerCase().includes(p.toLowerCase()))});return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:s.cashiers}),o.jsxs("button",{onClick:()=>{v(null),g(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),s.addCashier]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:p,onChange:E=>b(E.target.value),placeholder:s.searchCashier,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(Hu,{className:"w-5 h-5 ml-2"}),s.filter]})]})}),c&&o.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:o.jsx("p",{className:"text-sm text-red-600",children:c})}),o.jsx("div",{className:"overflow-x-auto",children:a?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s.loading})}):B.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:p?s.noSearchResults:s.noCashiers})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.name}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.email}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.phoneNumber}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.branch}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.status}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.salary}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:s.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(E=>{var T;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"})}),o.jsx("div",{className:"mr-4",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.full_name})})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.his_email}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.phone_number?E.phone_number:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.main_branch}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E.working_status==="working"?"bg-green-100 text-green-800":E.working_status==="vacation"?"bg-yellow-100 text-yellow-800":E.working_status==="sick"?"bg-orange-100 text-orange-800":E.working_status==="absent"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s[E.working_status]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(T=E.salary)==null?void 0:T.toFixed(3)," ",s.currency]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:[o.jsx("button",{onClick:()=>{v(E),g(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:s.edit}),o.jsx("button",{onClick:()=>{m(E),h(!0)},className:"text-green-600 hover:text-green-900 ml-4",children:s.salary}),o.jsx("button",{onClick:()=>_(E.user_id),className:"text-yellow-600 hover:text-yellow-900 ml-4",children:s.changeStatus}),o.jsx("button",{onClick:()=>S(E),className:"text-red-600 hover:text-red-900",children:s.delete})]})]},E.user_id)})})]})})]}),o.jsx(NM,{isOpen:u,onClose:()=>{h(!1),m(null)},onSubmit:P,initialData:f?{basicSalary:f.salary||0,bonus:0,deductions:0,paymentDate:new Date().toISOString().split("T")[0]}:void 0}),x&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:y?s.editCashier:s.addNewCashier}),o.jsxs("form",{onSubmit:D,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.cashierName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"full_name",defaultValue:y==null?void 0:y.full_name,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.email," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"email",name:"email",defaultValue:y==null?void 0:y.his_email,required:!0,readOnly:!!y,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${y?"bg-gray-100":""}`,dir:"ltr"})]}),!y&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.password," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"password",name:"password",required:!0,minLength:6,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.phoneNumber," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"tel",name:"phone_number",defaultValue:y==null?void 0:y.phone_number,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.status," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{name:"working_status",defaultValue:(y==null?void 0:y.working_status)||"working",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"working",children:s.working}),o.jsx("option",{value:"vacation",children:s.vacation}),o.jsx("option",{value:"sick",children:s.sick}),o.jsx("option",{value:"absent",children:s.absent}),o.jsx("option",{value:"suspended",children:s.suspended})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.branch," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{name:"main_branch",defaultValue:y==null?void 0:y.main_branch,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:s.selectBranch}),n.filter(E=>E.is_active).map(E=>o.jsx("option",{value:E.branch_name,children:E.branch_name},E.branch_id))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.salary," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"salary",defaultValue:y==null?void 0:y.salary,required:!0,min:"0",step:"0.001",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{g(!1),v(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:s.save})]})]})]})}),j&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:s.changeStatus}),o.jsx("p",{className:"text-gray-600 mb-6",children:s.selectNewStatus}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>_(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>M(j,"working"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:s.working}),o.jsx("button",{onClick:()=>M(j,"vacation"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2",children:s.vacation}),o.jsx("button",{onClick:()=>M(j,"sick"),className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:s.sick}),o.jsx("button",{onClick:()=>M(j,"absent"),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:s.absent}),o.jsx("button",{onClick:()=>M(j,"suspended"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:s.suspended})]})]})]})}),C&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:s.confirmDelete}),o.jsx("p",{className:"text-gray-600 mb-6",children:s.deleteConfirmMessage.replace("{name}",C.full_name||"")}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>S(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{onClick:()=>k(C),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:s.confirmDelete})]})]})})]})}const MM={ar:{managers:"إدارة المدراء",addManager:"إضافة مدير",searchManager:"ابحث عن مدير...",noSearchResults:"لا توجد نتائج للبحث",noManagers:"لا يوجد مدراء",loading:"جاري التحميل...",filter:"تصفية",manager:"المدير",name:"الاسم",email:"البريد الإلكتروني",phoneNumber:"رقم الهاتف",branch:"الفرع",changeStatus:"تغيير الحالة",selectNewStatus:"اختر الحالة الجديدة",selectBranch:"اختر الفرع",status:"الحالة",actions:"إجراءات",edit:"تعديل",delete:"حذف",confirmDelete:"تأكيد الحذف",deleteConfirmMessage:"هل أنت متأكد من حذف المدير {name}؟ سيتم حذف حسابه بشكل نهائي.",active:"نشط",onLeave:"في إجازة",suspended:"موقوف",working:"يعمل",vacation:"إجازة",sick:"مرضي",absent:"غائب",salary:"الراتب",addNewManager:"إضافة مدير جديد",editManager:"تعديل بيانات المدير",managerName:"اسم المدير",password:"كلمة المرور",save:"حفظ",cancel:"إلغاء",required:"مطلوب",delete:"حذف",confirmAction:"تأكيد الإجراء",confirmActionMessage:"هل أنت متأكد من تنفيذ هذا الإجراء؟",confirm:"تأكيد",currency:"ر.ع",errorLoadingManagers:"حدث خطأ أثناء تحميل المدراء",errorSavingManager:"حدث خطأ أثناء حفظ المدير",errorUpdatingStatus:"حدث خطأ أثناء تحديث الحالة",errorDeletingManager:"حدث خطأ أثناء حذف المدير"},en:{managers:"Manager Management",addManager:"Add Manager",searchManager:"Search for a manager...",noSearchResults:"No search results found",noManagers:"No managers found",loading:"Loading...",filter:"Filter",manager:"Manager",name:"Name",email:"Email",phoneNumber:"Phone Number",branch:"Branch",changeStatus:"Change Status",selectNewStatus:"Select new status",selectBranch:"Select Branch",status:"Status",actions:"Actions",edit:"Edit",delete:"Delete",confirmDelete:"Confirm Delete",deleteConfirmMessage:"Are you sure you want to delete manager {name}? Their account will be permanently removed.",active:"Active",onLeave:"On Leave",working:"Working",vacation:"Vacation",sick:"Sick",absent:"Absent",salary:"Salary",addNewManager:"Add New Manager",editManager:"Edit Manager",managerName:"Manager Name",password:"Password",save:"Save",cancel:"Cancel",required:"Required",passwordMismatch:"Passwords do not match",suspended:"Suspended",errorLoadingManagers:"Error loading managers",errorSavingManager:"Error saving manager",errorDeletingManager:"Error deleting manager",currency:"OMR"}},fi=Dl("https://qpzpxtlzgtdxaskmgoku.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwenB4dGx6Z3RkeGFza21nb2t1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTA0NDY5MSwiZXhwIjoyMDUwNjIwNjkxfQ.BEuzci7QUMLF3BELDe3hqFyOhK7aK66fcg8oM7dY9YI");async function TM(t){const{data:e,error:n}=await V.from("profiles").select("*").eq("business_code",t).eq("role","manager").order("created_at",{ascending:!1});if(n)throw console.error("Error fetching managers:",n),n;return e||[]}async function OM(t){let e;try{const{data:n}=await fi.auth.admin.listUsers(),s=n.users.find(a=>a.email===t.email);if(s){e=s.id;const{error:a}=await fi.auth.admin.updateUserById(e,{password:t.password,user_metadata:{role:"manager",business_code:t.business_code}});if(a)throw a}else{const{data:a,error:l}=await fi.auth.admin.createUser({email:t.email,password:t.password,email_confirm:!0,user_metadata:{role:"manager",business_code:t.business_code}});if(l)throw l;e=a.user.id}const{data:r,error:i}=await fi.from("profiles").upsert({user_id:e,full_name:t.full_name,his_email:t.email,main_branch:t.main_branch,phone_number:t.phone_number,salary:t.salary,role:"manager",business_code:t.business_code,working_status:t.working_status}).select().single();if(i)throw i;return r}catch(n){throw console.error("Error in createManager:",n),n}}async function AM(t,e){const{data:n,error:s}=await V.from("profiles").update(e).eq("user_id",t).eq("role","manager").select().single();if(s)throw console.error("Error updating manager:",s),s;return n}async function RM(t,e){const{data:n,error:s}=await V.from("profiles").update({working_status:e}).eq("user_id",t).eq("role","manager").select().single();if(s)throw console.error("Error updating manager status:",s),s;return n}async function DM(t){try{const{data:e,error:n}=await V.from("profiles").select("role").eq("user_id",t).single();if(n)throw console.error("Error checking manager profile:",n),n;if((e==null?void 0:e.role)!=="manager")throw new Error("User is not a manager");const{error:s}=await V.from("profiles").delete().match({user_id:t,role:"manager"});if(s)throw console.error("Error deleting manager profile:",s),s;const{error:r}=await fi.auth.admin.deleteUser(t);if(r)throw console.error("Error deleting auth user:",r),r;return!0}catch(e){throw console.error("Error in deleteManager:",e),e}}function IM(){const{language:t}=Y(),{user:e}=ce(),{branches:n}=Ze(),s=MM[t],r=(e==null?void 0:e.role)==="owner",[i,a]=w.useState([]),[l,c]=w.useState(!0),[d,u]=w.useState(null),[h,f]=w.useState(!1),[m,x]=w.useState(null),[g,y]=w.useState(""),[v,p]=w.useState(null),[b,j]=w.useState(null);w.useEffect(()=>{e!=null&&e.businessCode&&_()},[e==null?void 0:e.businessCode]);const _=async()=>{try{c(!0);const P=await TM(e.businessCode);a(P)}catch(P){console.error("Error loading managers:",P),u(s.errorLoadingManagers)}finally{c(!1)}},C=async P=>{P.preventDefault(),u(null);const D=new FormData(P.currentTarget),M={email:D.get("email"),password:D.get("password"),working_status:D.get("working_status"),full_name:D.get("full_name"),main_branch:D.get("main_branch"),salary:parseFloat(D.get("salary")),phone_number:D.get("phone_number"),business_code:e.businessCode};try{m?await AM(m.user_id,{full_name:M.full_name,main_branch:M.main_branch,salary:M.salary,working_status:M.working_status,phone_number:M.phone_number}):await OM(M),await _(),f(!1),x(null)}catch(B){console.error("Error saving manager:",B),u(s.errorSavingManager)}},S=async(P,D)=>{try{await RM(P,D),await _(),p(null)}catch(M){console.error("Error updating status:",M),u(s.errorUpdatingStatus)}},k=async P=>{try{await DM(P.user_id),await _(),j(null)}catch(D){console.error("Error deleting manager:",D),u(s.errorDeletingManager)}},A=i.filter(P=>{var D,M;return((D=P.full_name)==null?void 0:D.toLowerCase().includes(g.toLowerCase()))||((M=P.his_email)==null?void 0:M.toLowerCase().includes(g.toLowerCase()))});return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:s.managers}),r&&o.jsxs("button",{onClick:()=>{x(null),f(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),s.addManager]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:g,onChange:P=>y(P.target.value),placeholder:s.searchManager,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(Hu,{className:"w-5 h-5 ml-2"}),s.filter]})]})}),d&&o.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:o.jsx("p",{className:"text-sm text-red-600",children:d})}),o.jsx("div",{className:"overflow-x-auto",children:l?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s.loading})}):A.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:g?s.noSearchResults:s.noManagers})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.name}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.email}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.phoneNumber}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.branch}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.status}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.salary}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:s.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(P=>{var D;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200"})}),o.jsx("div",{className:"mr-4",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.full_name})})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:P.his_email}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:P.phone_number?P.phone_number:"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:P.main_branch}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${P.working_status==="working"?"bg-green-100 text-green-800":P.working_status==="vacation"?"bg-yellow-100 text-yellow-800":P.working_status==="sick"?"bg-orange-100 text-orange-800":P.working_status==="absent"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s[P.working_status]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(D=P.salary)==null?void 0:D.toFixed(3)," ",s.currency]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:[o.jsx("button",{onClick:()=>{x(P),f(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:s.edit}),r&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>p(P.user_id),className:"text-yellow-600 hover:text-yellow-900 ml-4",children:s.changeStatus}),o.jsx("button",{onClick:()=>j(P),className:"text-red-600 hover:text-red-900",children:s.delete})]})]})]},P.user_id)})})]})})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:m?s.editManager:s.addNewManager}),o.jsxs("form",{onSubmit:C,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.managerName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"full_name",defaultValue:m==null?void 0:m.full_name,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.email," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"email",name:"email",defaultValue:m==null?void 0:m.his_email,required:!0,readOnly:!!m,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${m?"bg-gray-100":""}`,dir:"ltr"})]}),!m&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.password," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"password",name:"password",required:!0,minLength:6,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.phoneNumber," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"tel",name:"phone_number",defaultValue:m==null?void 0:m.phone_number,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.status," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{name:"working_status",defaultValue:(m==null?void 0:m.working_status)||"working",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"working",children:s.working}),o.jsx("option",{value:"vacation",children:s.vacation}),o.jsx("option",{value:"sick",children:s.sick}),o.jsx("option",{value:"absent",children:s.absent}),o.jsx("option",{value:"suspended",children:s.suspended})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.branch," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{name:"main_branch",defaultValue:m==null?void 0:m.main_branch,required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:s.selectBranch}),n.filter(P=>P.is_active).map(P=>o.jsx("option",{value:P.branch_name,children:P.branch_name},P.branch_id))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.salary," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"salary",defaultValue:m==null?void 0:m.salary,required:!0,min:"0",step:"0.001",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{f(!1),x(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:s.save})]})]})]})}),v&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:s.changeStatus}),o.jsx("p",{className:"text-gray-600 mb-6",children:s.selectNewStatus}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>p(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>S(v,"working"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:s.working}),o.jsx("button",{onClick:()=>S(v,"vacation"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2",children:s.vacation}),o.jsx("button",{onClick:()=>S(v,"sick"),className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:s.sick}),o.jsx("button",{onClick:()=>S(v,"absent"),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:s.absent}),o.jsx("button",{onClick:()=>S(v,"suspended"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:s.suspended})]})]})]})}),b&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:s.confirmDelete}),o.jsx("p",{className:"text-gray-600 mb-6",children:s.deleteConfirmMessage.replace("{name}",b.full_name||"")}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>j(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{onClick:()=>k(b),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:s.confirmDelete})]})]})})]})}const LM={ar:{subVendors:"إدارة الموردين",addVendor:"إضافة مورد",vendorName:"اسم المورد",vendorBusinessName:"اسم المتجر",phoneNumber:"رقم الهاتف",password:"كلمة المرور",searchVendor:"ابحث عن مورد...",filter:"تصفية",totalVendors:"إجمالي الموردين",activeVendors:"موردين نشطين",pendingApproval:"في انتظار الموافقة",vendor:"المورد",vendorName:"اسم المورد",vendorBusinessName:"اسم المتجر",newVendorDetails:"تفاصيل المورد الجديد",createAndAssign:"إنشاء وتعيين",passwordHint:"سيتم إرسال كلمة المرور إلى البريد الإلكتروني للمورد",productCount:"عدد المنتجات",sales:"المبيعات",status:"الحالة",joinDate:"تاريخ الانضمام",actions:"إجراءات",edit:"تعديل",suspend:"إيقاف",active:"نشط",pending:"في انتظار الموافقة",suspended:"متوقف",loading:"جاري التحميل...",noVendors:"لا يوجد موردين",vendorEmail:"البريد الإلكتروني للمورد",branch:"الفرع",selectBranch:"اختر الفرع",assignmentDate:"تاريخ التعيين",assignedBranches:"الفروع المعينة",unknownBusiness:"متجر غير معروف",businessName:"اسم المتجر",email:"البريد الإلكتروني",phone:"رقم الهاتف",add:"إضافة",remove:"إزالة",confirm:"تأكيد",cancel:"إلغاء",confirmRemove:"تأكيد إزالة المورد",removeConfirmationMessage:"هل أنت متأكد من إزالة هذا المورد؟",vendorNotFound:"لم يتم العثور على المورد بهذا البريد الإلكتروني",errorAddingVendor:"حدث خطأ أثناء إضافة المورد",product:"منتج",currency:"ر.ع"},en:{subVendors:"Vendor Management",addVendor:"Add Vendor",vendorName:"Vendor Name",vendorBusinessName:"Business Name",phoneNumber:"Phone Number",password:"Password",searchVendor:"Search for a vendor...",filter:"Filter",totalVendors:"Total Vendors",activeVendors:"Active Vendors",pendingApproval:"Pending Approval",vendor:"Vendor",vendorName:"Vendor Name",vendorBusinessName:"Business Name",newVendorDetails:"New Vendor Details",createAndAssign:"Create & Assign",passwordHint:"Password will be sent to vendor's email",productCount:"Product Count",sales:"Sales",status:"Status",joinDate:"Join Date",actions:"Actions",edit:"Edit",suspend:"Suspend",active:"Active",pending:"Pending Approval",suspended:"Suspended",loading:"Loading...",noVendors:"No vendors found",vendorEmail:"Vendor Email",branch:"Branch",selectBranch:"Select Branch",assignmentDate:"Assignment Date",assignedBranches:"Assigned Branches",unknownBusiness:"Unknown Business",businessName:"Business Name",email:"Email",phone:"Phone",add:"Add",remove:"Remove",confirm:"Confirm",cancel:"Cancel",confirmRemove:"Confirm Vendor Removal",removeConfirmationMessage:"Are you sure you want to remove this vendor?",vendorNotFound:"No vendor found with this email",errorAddingVendor:"Error adding vendor",product:"Product",currency:"OMR"}};function FM(){const{language:t}=Y(),{user:e}=ce(),{branches:n}=Ze(),s=LM[t],[r,i]=w.useState([]),[a,l]=w.useState(!0),[c,d]=w.useState(!1),[u,h]=w.useState(""),[f,m]=w.useState(""),[x,g]=w.useState(""),[y,v]=w.useState(!1),[p,b]=w.useState({full_name:"",phone_number:"",vendor_business_name:"",password:""}),[j,_]=w.useState(null),[C,S]=w.useState(null);w.useEffect(()=>{e!=null&&e.businessCode&&k()},[e==null?void 0:e.businessCode]);const k=async()=>{try{l(!0);const N=await Zy(e.businessCode);i(N)}catch(N){console.error("Error loading vendors:",N)}finally{l(!1)}},A=async N=>{if(N.preventDefault(),_(null),!x){_(s.selectBranchFirst);return}try{if(y){const R=await hM({email:f,password:p.password,full_name:p.full_name,vendor_business_name:p.vendor_business_name,phone_number:p.phone_number});await kp({vendor_business_code:R.business_code,owner_business_code:e.businessCode,owner_business_name:"",branch_name:x,vendor_email_identifier:f})}else{const R=await fM(f);if(!R){v(!0);return}await kp({vendor_business_code:R.business_code,owner_business_code:e.businessCode,owner_business_name:"",branch_name:x,vendor_email_identifier:f})}await k(),d(!1),m(""),g(""),v(!1),b({full_name:"",phone_number:"",vendor_business_name:"",password:""})}catch(R){console.error("Error adding vendor:",R),_(s.errorAddingVendor)}},P=async N=>{try{await mM(N.assignment_id),await k(),S(null)}catch(R){console.error("Error removing vendor:",R)}},D=r.filter(N=>N.vendor_email_identifier.toLowerCase().includes(u.toLowerCase())||N.branch_name.toLowerCase().includes(u.toLowerCase())),[M,B]=w.useState(new Set),E=N=>{B(R=>{const O=new Set(R);return O.has(N)?O.delete(N):O.add(N),O})},T=w.useMemo(()=>{const N=new Map;return r.forEach(R=>{const O=N.get(R.vendor_email_identifier)||[];N.set(R.vendor_email_identifier,[...O,R])}),N},[r]);return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:s.subVendors}),o.jsxs("button",{onClick:()=>d(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),s.addVendor]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:u,onChange:N=>h(N.target.value),placeholder:s.searchVendor,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]})}),o.jsx("div",{className:"overflow-x-auto",children:a?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s.loading})}):D.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:s.noVendors})}):o.jsx("div",{className:"divide-y divide-gray-200",children:Array.from(T.entries()).map(([N,R])=>{var z,U,K,G;const O=M.has(N);return o.jsxs("div",{className:"bg-white",children:[o.jsxs("div",{className:"px-6 py-4 cursor-pointer hover:bg-gray-50 flex items-center justify-between",onClick:()=>E(N),children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:o.jsx(Be,{className:"h-6 w-6 text-indigo-600"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm text-gray-600",children:((z=R[0].profile)==null?void 0:z["vendor_business _name"])&&o.jsx("span",{className:"text-lg font-semibold text-indigo-600",children:(U=R[0].profile)==null?void 0:U["vendor_business _name"]})}),o.jsx("div",{className:"text-sm font-medium text-gray-900 mt-1",children:((K=R[0].profile)==null?void 0:K.full_name)||s.unknownBusiness}),o.jsx("div",{className:"text-xs text-gray-400",children:N})]})]}),O?o.jsx(J_,{className:"h-5 w-5 text-gray-500"}):o.jsx(K_,{className:"h-5 w-5 text-gray-500"})]}),O&&o.jsxs("div",{className:"border-t border-gray-100",children:[o.jsx("div",{className:"px-6 py-3 bg-gray-50",children:o.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-medium text-gray-500",children:s.phone}),o.jsx("p",{className:"text-sm text-gray-900 mt-1",children:((G=R[0].profile)==null?void 0:G.phone_number)||"-"})]})})}),o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.branch}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.assignmentDate}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:s.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map(ye=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ye.branch_name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ye.date_of_assignment).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:o.jsx("button",{onClick:()=>S(ye),className:"text-red-600 hover:text-red-900",children:s.remove})})]},ye.assignment_id))})]})]})]},N)})})})]}),c&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:y?s.newVendorDetails:s.addVendor}),o.jsxs("form",{onSubmit:A,className:"space-y-4",children:[y?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.vendorBusinessName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:p.vendor_business_name,onChange:N=>b(R=>({...R,vendor_business_name:N.target.value})),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.vendorName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:p.full_name,onChange:N=>b(R=>({...R,full_name:N.target.value})),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.phoneNumber," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"tel",value:p.phone_number,onChange:N=>b(R=>({...R,phone_number:N.target.value})),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.password," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"password",value:p.password,onChange:N=>b(R=>({...R,password:N.target.value})),required:!0,minLength:6,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s.passwordHint})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.vendorEmail," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"email",value:f,onChange:N=>m(N.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.branch," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:x,onChange:N=>g(N.target.value),required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:s.selectBranch}),n.filter(N=>N.is_active).map(N=>o.jsx("option",{value:N.branch_name,children:N.branch_name},N.branch_id))]})]})]}),j&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:j})})]})}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{d(!1),_(null),v(!1),b({full_name:"",phone_number:"",vendor_business_name:"",password:""}),g("")},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:y?s.createAndAssign:s.add})]})]})]})}),C&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:s.confirmRemove}),o.jsx("p",{className:"text-gray-600 mb-6",children:s.removeConfirmationMessage}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>S(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:s.cancel}),o.jsx("button",{onClick:()=>P(C),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:s.confirm})]})]})})]})}const BM={ar:{rentalManagement:"إدارة الإيجارات",rentedSpaces:"المساحات المؤجرة",paidRentals:"الإيجارات المدفوعة",overduePayments:"مدفوعات متأخرة",selectAllBranches:"جميع الفروع",searchSpace:"ابحث عن مساحة أو مورد...",allSpaces:"جميع المساحات",pendingPayments:"مدفوعات معلقة",space:"المساحة",vendor:"المورد",monthlyRent:"الإيجار الشهري",paymentStatus:"حالة الدفع",nextPayment:"الدفعة القادمة",nextPaymentDate:"موعد الدفعة القادمة",updatePayment:"تحديث حالة الدفع",markAsPaid:"تحديد كمدفوع",markAsPending:"تحديد كمعلق",markAsOverdue:"تحديد كمتأخر",currentStatus:"الحالة الحالية",paid:"مدفوع",pending:"معلق",overdue:"متأخر",dueIn:"يستحق خلال {days} يوم",dueToday:"يستحق اليوم",paidOnTime:"تم الدفع في الموعد",paymentOverdue:"متأخر في الدفع",addRental:"إضافة إيجار",spaceName:"اسم المساحة",selectVendor:"اختر المورد",selectBranch:"اختر الفرع",branchName:"اسم الفرع",branchTitle:"الفرع المؤجر",sortAsc:"ترتيب تصاعدي",sortDesc:"ترتيب تنازلي",save:"حفظ",delete:"حذف",confirmDelete:"تأكيد الحذف",deleteConfirmMessage:"هل أنت متأكد من حذف إيجار {name}؟",close:"إغلاق",loading:"جاري التحميل...",noRentals:"لا توجد إيجارات",noSearchResults:"لا توجد نتائج للبحث",errorLoadingRentals:"حدث خطأ أثناء تحميل الإيجارات",errorAddingRental:"حدث خطأ أثناء إضافة الإيجار",errorUpdatingStatus:"حدث خطأ أثناء تحديث الحالة",errorDeletingRental:"حدث خطأ أثناء حذف الإيجار",actions:"إجراءات",cancel:"إلغاء",currency:"ر.ع"},en:{rentalManagement:"Rental Management",rentedSpaces:"Rented Spaces",paidRentals:"Paid Rentals",overduePayments:"Overdue Payments",selectAllBranches:"All Branches",searchSpace:"Search for space or vendor...",allSpaces:"All Spaces",pendingPayments:"Pending Payments",space:"Space",vendor:"Vendor",monthlyRent:"Monthly Rent",paymentStatus:"Payment Status",nextPayment:"Next Payment",nextPaymentDate:"Next Payment Date",updatePayment:"Update Payment Status",markAsPaid:"Mark as Paid",markAsPending:"Mark as Pending",markAsOverdue:"Mark as Overdue",currentStatus:"Current Status",paid:"Paid",pending:"Pending",overdue:"Overdue",dueIn:"Due in {days} days",dueToday:"Due today",paidOnTime:"Paid on time",paymentOverdue:"Payment overdue",addRental:"Add Rental",spaceName:"Space Name",selectVendor:"Select Vendor",selectBranch:"Select Branch",branchName:"Branch Name",branchTitle:"Rented Branch",sortAsc:"Sort ascending",sortDesc:"Sort descending",save:"Save",delete:"Delete",confirmDelete:"Confirm Delete",deleteConfirmMessage:"Are you sure you want to delete rental for {name}?",close:"Close",loading:"Loading...",noRentals:"No rentals found",noSearchResults:"No search results found",errorLoadingRentals:"Error loading rentals",errorAddingRental:"Error adding rental",errorUpdatingStatus:"Error updating status",errorDeletingRental:"Error deleting rental",actions:"Actions",cancel:"Cancel",currency:"OMR"}};async function $M(t){const{data:e,error:n}=await V.from("vendor_rentals").select("*").eq("owner_business_name",t).order("created_at",{ascending:!1});if(n)throw console.error("Error fetching rentals:",n),n;return e||[]}async function zM(t){const{data:e,error:n}=await V.from("vendor_rentals").insert([{...t,payment_status:"pending"}]).select().single();if(n)throw console.error("Error creating rental:",n),n;return e}async function UM(t,e,n){const s={payment_status:e,updated_at:new Date().toISOString()},{data:r,error:i}=await V.from("vendor_rentals").update(s).eq("rental_id",t).select().single();if(i)throw console.error("Error updating rental payment status:",i),i;return r}async function VM(t){const{error:e}=await V.from("vendor_rentals").delete().eq("rental_id",t);if(e)throw console.error("Error deleting rental:",e),e;return!0}function WM(){const{language:t}=Y(),{user:e}=ce(),n=BM[t],[s,r]=w.useState([]),[i,a]=w.useState([]),[l,c]=w.useState(!0),[d,u]=w.useState(null),[h,f]=w.useState(""),[m,x]=w.useState("all"),[g,y]=w.useState("all"),[v,p]=w.useState(!1),[b,j]=w.useState(null),[_,C]=w.useState(!1),[S,k]=w.useState(null),[A,P]=w.useState(""),[D,M]=w.useState(""),[B,E]=w.useState("space_name"),[T,N]=w.useState("asc");w.useEffect(()=>{e!=null&&e.businessCode&&(O(),R())},[e==null?void 0:e.businessCode]);const R=async()=>{try{const I=await Zy(e.businessCode);r(I)}catch(I){console.error("Error loading assignments:",I)}},O=async()=>{try{c(!0),u(null);const I=await $M(e.businessCode);a(I)}catch(I){console.error("Error loading rentals:",I),u(n.errorLoadingRentals)}finally{c(!1)}},z=w.useMemo(()=>{const I=new Map;return s.forEach(ee=>{var Te;I.has(ee.vendor_email_identifier)||I.set(ee.vendor_email_identifier,{email:ee.vendor_email_identifier,name:((Te=ee.profile)==null?void 0:Te["vendor_business _name"])||"",businessCode:ee.vendor_business_code})}),Array.from(I.values())},[s]),U=w.useMemo(()=>A?s.filter(I=>I.vendor_email_identifier===A).map(I=>I.branch_name):[],[A,s]),K=w.useMemo(()=>z.find(I=>I.email===A),[A,z]),G=async I=>{try{if(u(null),!K)throw new Error("Please select a vendor");const ee={space_name:I.get("space_name"),vendor_bussnies_code:K.businessCode,vendor_business_name:K.name,owner_business_name:e.businessCode,branch_name_rental:D,monthly_rent:parseFloat(I.get("monthly_rent")),next_payment_date:I.get("next_payment_date")};await zM(ee),await O(),C(!1)}catch(ee){console.error("Error adding rental:",ee),u(n.errorAddingRental)}},ye=async(I,ee)=>{try{u(null),await UM(I.rental_id,ee),await O(),j(null)}catch(Te){console.error("Error updating payment status:",Te),u(n.errorUpdatingStatus)}},F=async I=>{try{u(null),await VM(I.rental_id),await O(),k(null)}catch(ee){console.error("Error deleting rental:",ee),u(n.errorDeletingRental)}},J=w.useMemo(()=>{const I=new Set;return i.forEach(ee=>{I.add(ee.branch_name_rental)}),Array.from(I).sort()},[i]),X=i.filter(I=>{const ee=I.space_name.toLowerCase().includes(h.toLowerCase())||I.vendor_business_name.toLowerCase().includes(h.toLowerCase())||I.branch_name_rental.toLowerCase().includes(h.toLowerCase()),Te=m==="all"||I.payment_status===m,$r=g==="all"||I.branch_name_rental===g;return ee&&Te&&$r}),Wt=I=>{B===I?N(ee=>ee==="asc"?"desc":"asc"):(E(I),N("asc"))},zl=w.useMemo(()=>[...X].sort((I,ee)=>{let Te=0;switch(B){case"space_name":Te=I.space_name.localeCompare(ee.space_name);break;case"vendor_business_name":Te=I.vendor_business_name.localeCompare(ee.vendor_business_name);break;case"branch_name_rental":Te=I.branch_name_rental.localeCompare(ee.branch_name_rental);break;case"monthly_rent":Te=I.monthly_rent-ee.monthly_rent;break;case"payment_status":Te=I.payment_status.localeCompare(ee.payment_status);break;case"next_payment_date":Te=new Date(I.next_payment_date).getTime()-new Date(ee.next_payment_date).getTime();break}return T==="asc"?Te:-Te}),[X,B,T]),Ot=({field:I,children:ee})=>o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer group",onClick:()=>Wt(I),title:B===I&&T==="asc"?n.sortDesc:n.sortAsc,children:o.jsxs("div",{className:"flex items-center justify-end space-x-1 space-x-reverse",children:[o.jsx("span",{children:ee}),o.jsx(Wu,{className:`w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity ${B===I?"opacity-100 text-indigo-500":"text-gray-400"}`})]})}),xo=I=>{const ee=new Date,$r=new Date(I).getTime()-ee.getTime();return Math.ceil($r/(1e3*60*60*24))},Br=I=>{const ee=xo(I.next_payment_date);return I.payment_status==="overdue"?{text:n.paymentOverdue,className:"bg-red-100 text-red-800"}:ee===0?{text:n.dueToday,className:"bg-yellow-100 text-yellow-800"}:I.payment_status==="paid"?{text:n.paidOnTime,className:"bg-green-100 text-green-800"}:{text:n.dueIn.replace("{days}",ee.toString()),className:"bg-yellow-100 text-yellow-800"}},Ul=i.filter(I=>I.payment_status==="overdue").length,yo=i.length,Vl=i.filter(I=>I.payment_status==="paid").length;return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.rentalManagement}),o.jsxs("button",{onClick:()=>C(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),n.addRental]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:o.jsx(wr,{className:"w-6 h-6 text-indigo-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:n.rentedSpaces}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:yo})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx(wr,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:n.paidRentals}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:Vl})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:o.jsx(_r,{className:"w-6 h-6 text-red-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:n.overduePayments}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:Ul})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:h,onChange:I=>f(I.target.value),placeholder:n.searchSpace,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("select",{value:g,onChange:I=>y(I.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:n.selectAllBranches}),J.map(I=>o.jsx("option",{value:I,children:I},I))]}),o.jsxs("select",{value:m,onChange:I=>x(I.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:n.allSpaces}),o.jsx("option",{value:"paid",children:n.paidRentals}),o.jsx("option",{value:"pending",children:n.pendingPayments}),o.jsx("option",{value:"overdue",children:n.overduePayments})]})]})}),d&&o.jsx("div",{className:"p-4 bg-red-50 border-b border-red-200",children:o.jsx("p",{className:"text-sm text-red-600",children:d})}),o.jsx("div",{className:"overflow-x-auto",children:l?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):X.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:h?n.noSearchResults:n.noRentals})}):o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx(Ot,{field:"space_name",children:n.space}),o.jsx(Ot,{field:"vendor_business_name",children:n.vendor}),o.jsx(Ot,{field:"branch_name_rental",children:n.branchTitle}),o.jsx(Ot,{field:"monthly_rent",children:n.monthlyRent}),o.jsx(Ot,{field:"payment_status",children:n.paymentStatus}),o.jsx(Ot,{field:"next_payment_date",children:n.nextPaymentDate}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:n.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:zl.map(I=>{const ee=Br(I);return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.space_name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.vendor_business_name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I.branch_name_rental}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[I.monthly_rent.toFixed(3)," ",n.currency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ee.className}`,children:ee.text})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(I.next_payment_date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>{j(I),p(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:n.updatePayment}),o.jsx("button",{onClick:()=>k(I),className:"text-red-600 hover:text-red-900",children:n.delete})]})]},I.rental_id)})})]})})]}),v&&b&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[o.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[n.updatePayment," - ",b.space_name]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.currentStatus}),o.jsx("div",{className:`inline-flex px-2 py-1 rounded-full text-sm ${b.payment_status==="paid"?"bg-green-100 text-green-800":b.payment_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:n[b.payment_status]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("button",{onClick:()=>ye(b,"paid"),className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:n.markAsPaid}),o.jsx("button",{onClick:()=>ye(b,"pending"),className:"w-full px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2",children:n.markAsPending}),o.jsx("button",{onClick:()=>ye(b,"overdue"),className:"w-full px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:n.markAsOverdue})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>{p(!1),j(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.close})})]})]})}),_&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.addRental}),o.jsxs("form",{onSubmit:I=>{I.preventDefault(),G(new FormData(I.currentTarget))},className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.spaceName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"space_name",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.vendor," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:A,onChange:I=>{P(I.target.value),M("")},required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:n.selectVendor}),z.map(I=>o.jsx("option",{value:I.email,children:I.name},I.email))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.branchName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:D,onChange:I=>M(I.target.value),required:!0,disabled:!A,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:n.selectBranch}),U.map(I=>o.jsx("option",{value:I,children:I},I))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.monthlyRent," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"monthly_rent",required:!0,min:"0",step:"0.001",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.nextPaymentDate," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"date",name:"next_payment_date",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{C(!1)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:n.save})]})]})]})}),S&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.confirmDelete}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.deleteConfirmMessage.replace("{name}",S.space_name)}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{onClick:()=>F(S),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:n.confirmDelete})]})]})})]})}const HM={ar:{coupons:"إدارة الكوبونات",addCoupon:"إضافة كوبون",editCoupon:"تعديل الكوبون",searchCoupon:"ابحث عن كوبون...",allCoupons:"جميع الكوبونات",activeCoupons:"الكوبونات النشطة",expiredCoupons:"الكوبونات المنتهية",couponCode:"رمز الكوبون",discountType:"نوع الخصم",discountValue:"قيمة الخصم",startDate:"تاريخ البدء",expiryDate:"تاريخ الانتهاء",status:"الحالة",usageCount:"عدد الاستخدامات",maxUsage:"الحد الأقصى للاستخدام",actions:"إجراءات",active:"نشط",expired:"منتهي",inactive:"غير نشط",deactivate:"إيقاف",activate:"تفعيل",deactivateCoupon:"إيقاف الكوبون",activateCoupon:"تفعيل الكوبون",deactivateConfirmMessage:"هل أنت متأكد من إيقاف هذا الكوبون؟",activateConfirmMessage:"هل أنت متأكد من تفعيل هذا الكوبون؟",fixed:"مبلغ ثابت",percentage:"نسبة مئوية",unlimited:"غير محدود",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",couponName:"اسم الكوبون",description:"الوصف",minimumPurchase:"الحد الأدنى للشراء",generateCode:"توليد رمز",currency:"ر.ع",required:"مطلوب",optional:"اختياري",couponDeleted:"تم حذف الكوبون بنجاح",couponAdded:"تم إضافة الكوبون بنجاح",couponUpdated:"تم تحديث الكوبون بنجاح",confirmDelete:"هل أنت متأكد من حذف هذا الكوبون؟",usedCoupons:"الكوبونات المستخدمة",remainingUses:"الاستخدامات المتبقية",noLimit:"بلا حد",times:"مرات"},en:{coupons:"Coupon Management",addCoupon:"Add Coupon",editCoupon:"Edit Coupon",searchCoupon:"Search for a coupon...",allCoupons:"All Coupons",activeCoupons:"Active Coupons",expiredCoupons:"Expired Coupons",couponCode:"Coupon Code",discountType:"Discount Type",discountValue:"Discount Value",startDate:"Start Date",expiryDate:"Expiry Date",status:"Status",usageCount:"Usage Count",maxUsage:"Maximum Usage",actions:"Actions",active:"Active",expired:"Expired",inactive:"Inactive",deactivate:"Deactivate",activate:"Activate",deactivateCoupon:"Deactivate Coupon",activateCoupon:"Activate Coupon",deactivateConfirmMessage:"Are you sure you want to deactivate this coupon?",activateConfirmMessage:"Are you sure you want to activate this coupon?",fixed:"Fixed Amount",percentage:"Percentage",unlimited:"Unlimited",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",couponName:"Coupon Name",description:"Description",minimumPurchase:"Minimum Purchase",generateCode:"Generate Code",currency:"OMR",required:"Required",optional:"Optional",couponDeleted:"Coupon deleted successfully",couponAdded:"Coupon added successfully",couponUpdated:"Coupon updated successfully",confirmDelete:"Are you sure you want to delete this coupon?",usedCoupons:"Used Coupons",remainingUses:"Remaining Uses",noLimit:"No Limit",times:"times"}};function qM(){const{language:t}=Y(),{user:e}=ce(),n=HM[t],[s,r]=w.useState([]),[i,a]=w.useState(!0),[l,c]=w.useState(null),[d,u]=w.useState(!1),[h,f]=w.useState(null),[m,x]=w.useState(""),[g,y]=w.useState("all"),[v,p]=w.useState("created_at"),[b,j]=w.useState("desc"),[_,C]=w.useState(null);w.useEffect(()=>{e!=null&&e.businessCode&&S()},[e==null?void 0:e.businessCode]);const S=async()=>{try{a(!0);const N=await yk(e.businessCode);r(N)}catch(N){console.error("Error loading coupons:",N),c(n.errorLoadingCoupons)}finally{a(!1)}},k=N=>{v===N?j(R=>R==="asc"?"desc":"asc"):(p(N),j("asc"))},A=({field:N,children:R})=>o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer group",onClick:()=>k(N),title:v===N&&b==="asc"?n.sortDesc:n.sortAsc,children:o.jsxs("div",{className:"flex items-center justify-end space-x-1 space-x-reverse",children:[o.jsx("span",{children:R}),o.jsx(Wu,{className:`w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity ${v===N?"opacity-100 text-indigo-500":"text-gray-400"}`})]})}),P=s.filter(N=>{const R=N.coupon_code.toLowerCase().includes(m.toLowerCase()),O=N.expiry_date&&new Date(N.expiry_date)<new Date;return R&&(g==="all"||g==="active"&&!O||g==="expired"&&O)}),D=Ke.useMemo(()=>[...P].sort((N,R)=>{let O=0;switch(v){case"coupon_code":O=N.coupon_code.localeCompare(R.coupon_code);break;case"discount_value":O=N.discount_value-R.discount_value;break;case"number_of_uses":O=N.number_of_uses-R.number_of_uses;break;case"expiry_date":!N.expiry_date&&!R.expiry_date?O=0:N.expiry_date?R.expiry_date?O=new Date(N.expiry_date).getTime()-new Date(R.expiry_date).getTime():O=-1:O=1;break;case"created_at":O=new Date(N.created_at).getTime()-new Date(R.created_at).getTime();break}return b==="asc"?O:-O}),[P,v,b]),M=N=>{const R=N.expiry_date&&new Date(N.expiry_date)<new Date;if(N.is_active){if(R)return{text:n.expired,className:"bg-red-100 text-red-800"}}else return{text:n.inactive,className:"bg-gray-100 text-gray-800"};return N.max_uses&&N.number_of_uses>=N.max_uses?{text:n.expired,className:"bg-red-100 text-red-800"}:{text:n.active,className:"bg-green-100 text-green-800"}},B=async N=>{try{await am(N.coupon_id,{is_active:!N.is_active}),await S(),C(null)}catch(R){console.error("Error toggling coupon status:",R),c(n.errorUpdatingStatus)}},E=async N=>{try{const R={business_code:e.businessCode,coupon_code:N.get("code"),discount_type:N.get("type"),discount_value:parseFloat(N.get("value")),max_uses:N.get("maxUsage")?parseInt(N.get("maxUsage")):null,expiry_date:N.get("expiryDate")||null,min_purchase_amount:N.get("minimumPurchase")?parseFloat(N.get("minimumPurchase")):0,max_purchase_amount:N.get("maximumPurchase")?parseFloat(N.get("maximumPurchase")):0,is_active:!0};h?await am(h.coupon_id,R):await vk(R),await S(),u(!1),f(null)}catch(R){console.error("Error saving coupon:",R),c(n.errorSavingCoupon)}},T=async N=>{try{await bk(N),await S()}catch(R){console.error("Error deleting coupon:",R),c(n.errorDeletingCoupon)}};return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.coupons}),o.jsxs("button",{onClick:()=>u(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),n.addCoupon]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:m,onChange:N=>x(N.target.value),placeholder:n.searchCoupon,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("select",{value:g,onChange:N=>y(N.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:n.allCoupons}),o.jsx("option",{value:"active",children:n.activeCoupons}),o.jsx("option",{value:"expired",children:n.expiredCoupons})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx(A,{field:"coupon_code",children:n.couponCode}),o.jsx(A,{field:"discount_value",children:n.discountType}),o.jsx(A,{field:"expiry_date",children:n.expiryDate}),o.jsx(A,{field:"number_of_uses",children:n.usageCount}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.status}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:n.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(N=>{const R=M(N);return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.coupon_code})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:N.discount_type==="fixed"?o.jsxs("span",{children:[N.discount_value," ",n.currency]}):o.jsxs("span",{children:[N.discount_value,"%"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:N.expiry_date?new Date(N.expiry_date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"-"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[N.number_of_uses," / ",N.max_uses||n.unlimited]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${R.className}`,children:R.text})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>f(N),className:"text-indigo-600 hover:text-indigo-900 ml-4",children:n.edit}),o.jsx("button",{onClick:()=>C(N),className:`text-${N.is_active?"red":"green"}-600 hover:text-${N.is_active?"red":"green"}-900 ml-4`,children:N.is_active?n.deactivate:n.activate}),o.jsx("button",{onClick:()=>{window.confirm(n.confirmDelete)&&T(N.coupon_id)},className:"text-red-600 hover:text-red-900",children:n.delete})]})]},N.coupon_id)})})]})})]}),(d||h)&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:h?n.editCoupon:n.addCoupon}),o.jsx("form",{onSubmit:N=>{N.preventDefault(),E(new FormData(N.currentTarget))},children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.couponCode," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsx("input",{type:"text",name:"code",defaultValue:h==null?void 0:h.coupon_code,required:!0,className:"flex-1 px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"}),o.jsx("button",{type:"button",onClick:N=>{const R=N.currentTarget.previousElementSibling;R.value=wk()},className:"px-3 py-2 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",children:o.jsx(l1,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.discountType," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{name:"type",defaultValue:(h==null?void 0:h.discount_type)||"fixed",required:!0,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"fixed",children:n.fixed}),o.jsx("option",{value:"percentage",children:n.percentage})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.discountValue," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"value",defaultValue:h==null?void 0:h.discount_value,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.expiryDate}),o.jsx("input",{type:"date",name:"expiryDate",defaultValue:h!=null&&h.expiry_date?new Date(h.expiry_date).toISOString().split("T")[0]:"",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.minimumPurchase}),o.jsx("input",{type:"number",name:"minimumPurchase",defaultValue:h==null?void 0:h.min_purchase_amount,min:"0",step:"0.01",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.maxUsage}),o.jsx("input",{type:"number",name:"maxUsage",defaultValue:h==null?void 0:h.max_uses,min:"0",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:()=>{u(!1),f(null)},className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:n.save})]})]})})]})}),_&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:_.is_active?n.deactivateCoupon:n.activateCoupon}),o.jsx("p",{className:"text-gray-600 mb-6",children:_.is_active?n.deactivateConfirmMessage:n.activateConfirmMessage}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{onClick:()=>B(_),className:`px-4 py-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${_.is_active?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"bg-green-600 hover:bg-green-700 focus:ring-green-500"}`,children:n.confirm})]})]})}),l&&o.jsx("div",{className:"fixed bottom-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:l})]})}const YM={ar:{developerInfo:"معلومات المطور",developerName:"سالم السناني",role:"مطور برمجيات أول",about:"نبذة",description:"مطور برمجيات متخصص في تطوير حلول الأعمال المتكاملة وأنظمة نقاط البيع. خبرة واسعة في تطوير تطبيقات الويب والموبايل مع التركيز على تقديم حلول عملية وفعالة للشركات.",specialties:"التخصصات",skills:["تطوير الويب","تطوير الموبايل","أنظمة نقاط البيع","قواعد البيانات","تطوير واجهات المستخدم","حلول الأعمال","الدعم الفني"],support:"الدعم الفني",supportText:"للحصول على الدعم الفني أو الاستفسارات، يرجى التواصل عبر البريد الإلكتروني أو الهاتف. نحن هنا لمساعدتكم وضمان عمل النظام بكفاءة.",contactInfo:"معلومات التواصل",email:"البريد الإلكتروني",phone:"الهاتف"},en:{developerInfo:"Developer Information",developerName:"Salim Al Senani",role:"Senior Software Developer",about:"About",description:"Software developer specializing in integrated business solutions and POS systems. Extensive experience in web and mobile application development with a focus on delivering practical and effective solutions for businesses.",specialties:"Specialties",skills:["Web Development","Mobile Development","POS Systems","Databases","UI Development","Business Solutions","Technical Support"],support:"Technical Support",supportText:"For technical support or inquiries, please contact via email or phone. We are here to help you and ensure the system runs efficiently.",contactInfo:"Contact Information",email:"Email",phone:"Phone"}};function QM(){const{language:t}=Y(),e=YM[t];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h1",{className:"text-2xl font-bold",children:e.developerInfo})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[o.jsx("div",{className:"relative h-48 bg-gradient-to-r from-indigo-500 to-purple-600",children:o.jsx("div",{className:"absolute -bottom-16 left-1/2 transform -translate-x-1/2",children:o.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-white bg-white shadow-lg flex items-center justify-center",children:o.jsx("span",{className:"text-4xl font-bold text-indigo-600",children:"SA"})})})}),o.jsxs("div",{className:"pt-20 pb-8 px-6 text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.developerName}),o.jsx("p",{className:"mt-2 text-gray-600",children:e.role}),o.jsxs("div",{className:"mt-8 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-center space-x-3 space-x-reverse",children:[o.jsx(t0,{className:"w-5 h-5 text-gray-500"}),o.jsx("a",{href:"mailto:contact.salim.alsenani@gmail.com",className:"text-indigo-600 hover:text-indigo-800",children:"contact.salim.alsenani@gmail.com"})]}),o.jsxs("div",{className:"flex items-center justify-center space-x-3 space-x-reverse",children:[o.jsx(r1,{className:"w-5 h-5 text-gray-500"}),o.jsx("a",{href:"tel:+96892309390",className:"text-indigo-600 hover:text-indigo-800",children:"+968 92309390"})]})]}),o.jsx("div",{className:"mt-8",children:o.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:e.about}),o.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:e.description})]})}),o.jsx("div",{className:"mt-8",children:o.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:e.specialties}),o.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.skills.map((n,s)=>o.jsx("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-sm",children:n},s))})]})}),o.jsx("div",{className:"mt-8",children:o.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:e.support}),o.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:e.supportText})]})})]})]})]})}const GM={ar:{storeOwners:"أصحاب المتاجر",addOwner:"إضافة مالك متجر",editOwner:"تعديل بيانات المالك",searchOwners:"ابحث عن مالك متجر...",owner:"المالك",contact:"معلومات الاتصال",stores:"المتاجر",status:"الحالة",lastLogin:"آخر تسجيل دخول",actions:"إجراءات",edit:"تعديل",suspend:"إيقاف",delete:"حذف",save:"حفظ",cancel:"إلغاء",active:"نشط",suspended:"موقوف",never:"لم يسجل الدخول بعد",confirmSuspend:"هل أنت متأكد من إيقاف هذا المالك؟",confirmDelete:"هل أنت متأكد من حذف هذا المالك؟",ownerName:"اسم المالك",email:"البريد الإلكتروني",phone:"رقم الهاتف",username:"اسم المستخدم",password:"كلمة المرور",confirmPassword:"تأكيد كلمة المرور",required:"مطلوب",optional:"اختياري",passwordMismatch:"كلمات المرور غير متطابقة"},en:{storeOwners:"Store Owners",addOwner:"Add Store Owner",editOwner:"Edit Store Owner",searchOwners:"Search for store owner...",owner:"Owner",contact:"Contact Info",stores:"Stores",status:"Status",lastLogin:"Last Login",actions:"Actions",edit:"Edit",suspend:"Suspend",delete:"Delete",save:"Save",cancel:"Cancel",active:"Active",suspended:"Suspended",never:"Never logged in",confirmSuspend:"Are you sure you want to suspend this owner?",confirmDelete:"Are you sure you want to delete this owner?",ownerName:"Owner Name",email:"Email",phone:"Phone",username:"Username",password:"Password",confirmPassword:"Confirm Password",required:"Required",optional:"Optional",passwordMismatch:"Passwords do not match"}};function KM(){const{language:t}=Y(),e=GM[t],[n,s]=w.useState(""),[r,i]=w.useState(!1),[a,l]=w.useState(null),c=[{id:"1",name:"أحمد محمد",email:"ahmed@store.com",phone:"96812345678",storeCount:2,status:"active",joinDate:"2024-01-01",lastLogin:"2024-03-15T10:30:00"},{id:"2",name:"فاطمة علي",email:"fatima@store.com",phone:"96887654321",storeCount:1,status:"suspended",joinDate:"2024-02-01",lastLogin:null}];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.storeOwners}),o.jsxs("button",{onClick:()=>i(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),e.addOwner]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value),placeholder:e.searchOwners,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.owner}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.contact}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.stores}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.status}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.lastLogin}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:e.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(d=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:o.jsx(Be,{className:"h-6 w-6 text-indigo-600"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.name}),o.jsx("div",{className:"text-sm text-gray-500",children:d.email})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.phone}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.storeCount}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e[d.status]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.lastLogin?new Date(d.lastLogin).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}):e.never}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>l(d),className:"text-indigo-600 hover:text-indigo-900 ml-4",children:e.edit}),o.jsx("button",{onClick:()=>{confirm(d.status==="active"?e.confirmSuspend:e.confirmDelete)&&console.log("Changing owner status:",d.id)},className:"text-red-600 hover:text-red-900",children:d.status==="active"?e.suspend:e.delete})]})]},d.id))})]})})]})]})}const JM={ar:{cashiers:"الكاشير",addCashier:"إضافة كاشير",editCashier:"تعديل بيانات الكاشير",searchCashiers:"ابحث عن كاشير...",cashier:"الكاشير",store:"المتجر",contact:"معلومات الاتصال",status:"الحالة",lastLogin:"آخر تسجيل دخول",actions:"إجراءات",edit:"تعديل",suspend:"إيقاف",delete:"حذف",save:"حفظ",cancel:"إلغاء",active:"نشط",suspended:"موقوف",never:"لم يسجل الدخول بعد",confirmSuspend:"هل أنت متأكد من إيقاف هذا الكاشير؟",confirmDelete:"هل أنت متأكد من حذف هذا الكاشير؟",cashierName:"اسم الكاشير",email:"البريد الإلكتروني",phone:"رقم الهاتف",username:"اسم المستخدم",password:"كلمة المرور",confirmPassword:"تأكيد كلمة المرور",required:"مطلوب",optional:"اختياري",passwordMismatch:"كلمات المرور غير متطابقة"},en:{cashiers:"Cashiers",addCashier:"Add Cashier",editCashier:"Edit Cashier",searchCashiers:"Search for cashier...",cashier:"Cashier",store:"Store",contact:"Contact Info",status:"Status",lastLogin:"Last Login",actions:"Actions",edit:"Edit",suspend:"Suspend",delete:"Delete",save:"Save",cancel:"Cancel",active:"Active",suspended:"Suspended",never:"Never logged in",confirmSuspend:"Are you sure you want to suspend this cashier?",confirmDelete:"Are you sure you want to delete this cashier?",cashierName:"Cashier Name",email:"Email",phone:"Phone",username:"Username",password:"Password",confirmPassword:"Confirm Password",required:"Required",optional:"Optional",passwordMismatch:"Passwords do not match"}};function XM(){const{language:t}=Y(),e=JM[t],[n,s]=w.useState(""),[r,i]=w.useState(!1),[a,l]=w.useState(null),c=[{id:"1",name:"فاطمة أحمد",email:"fatima@store.com",phone:"96812345678",storeId:"1",storeName:"سوبرماركت السعادة",status:"active",joinDate:"2024-01-01",lastLogin:"2024-03-15T10:30:00"},{id:"2",name:"نورة سالم",email:"noura@store.com",phone:"96887654321",storeId:"2",storeName:"متجر البركة",status:"suspended",joinDate:"2024-02-01",lastLogin:null}];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.cashiers}),o.jsxs("button",{onClick:()=>i(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),e.addCashier]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value),placeholder:e.searchCashiers,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.cashier}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.store}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.contact}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.status}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.lastLogin}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:e.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(d=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:o.jsx(Gi,{className:"h-6 w-6 text-indigo-600"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.name}),o.jsx("div",{className:"text-sm text-gray-500",children:d.email})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.storeName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.phone}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e[d.status]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.lastLogin?new Date(d.lastLogin).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}):e.never}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>l(d),className:"text-indigo-600 hover:text-indigo-900 ml-4",children:e.edit}),o.jsx("button",{onClick:()=>{confirm(d.status==="active"?e.confirmSuspend:e.confirmDelete)&&console.log("Changing cashier status:",d.id)},className:"text-red-600 hover:text-red-900",children:d.status==="active"?e.suspend:e.delete})]})]},d.id))})]})})]})]})}const ZM={ar:{superAdmin:"إدارة المتاجر",addVendor:"إضافة متجر جديد",searchVendor:"ابحث عن متجر...",filter:"تصفية",totalVendors:"إجمالي المتاجر",activeVendors:"المتاجر النشطة",suspendedVendors:"المتاجر المعلقة",vendor:"المتجر",storeName:"اسم المتجر",ownerName:"اسم المالك",email:"البريد الإلكتروني",phone:"رقم الهاتف",location:"الموقع",status:"الحالة",joinDate:"تاريخ الانضمام",actions:"إجراءات",edit:"تعديل",suspend:"تعليق",activate:"تفعيل",delete:"حذف",active:"نشط",suspended:"معلق",inactive:"غير نشط",save:"حفظ",cancel:"إلغاء",required:"مطلوب",optional:"اختياري",username:"اسم المستخدم",password:"كلمة المرور",confirmPassword:"تأكيد كلمة المرور",passwordMismatch:"كلمات المرور غير متطابقة",confirmSuspend:"هل أنت متأكد من تعليق هذا المتجر؟",confirmDelete:"هل أنت متأكد من حذف هذا المتجر؟",vendorAdded:"تم إضافة المتجر بنجاح",vendorUpdated:"تم تحديث بيانات المتجر بنجاح",vendorDeleted:"تم حذف المتجر بنجاح",statusChanged:"تم تغيير حالة المتجر بنجاح",subVendorsCount:"عدد الموردين",cashiersCount:"عدد الكاشير",lastLogin:"آخر تسجيل دخول",never:"لم يسجل الدخول بعد"},en:{superAdmin:"Stores Management",addVendor:"Add New Store",searchVendor:"Search for a store...",filter:"Filter",totalVendors:"Total Stores",activeVendors:"Active Stores",suspendedVendors:"Suspended Stores",vendor:"Store",storeName:"Store Name",ownerName:"Owner Name",email:"Email",phone:"Phone",location:"Location",status:"Status",joinDate:"Join Date",actions:"Actions",edit:"Edit",suspend:"Suspend",activate:"Activate",delete:"Delete",active:"Active",suspended:"Suspended",inactive:"Inactive",save:"Save",cancel:"Cancel",required:"Required",optional:"Optional",username:"Username",password:"Password",confirmPassword:"Confirm Password",passwordMismatch:"Passwords do not match",confirmSuspend:"Are you sure you want to suspend this store?",confirmDelete:"Are you sure you want to delete this store?",vendorAdded:"Store added successfully",vendorUpdated:"Store updated successfully",vendorDeleted:"Store deleted successfully",statusChanged:"Store status changed successfully",subVendorsCount:"Sub-vendors Count",cashiersCount:"Cashiers Count",lastLogin:"Last Login",never:"Never logged in"}};function eT(){const{language:t}=Y(),e=ZM[t],[n,s]=w.useState(""),[r,i]=w.useState(!1),[a,l]=w.useState(null),c=[{id:"1",storeName:"سوبرماركت السعادة",ownerName:"أحمد محمد",username:"ahmed_store",email:"ahmed@store.com",phone:"96812345678",location:"مسقط، عمان",status:"active",joinDate:"2024-01-01",lastLogin:"2024-03-15T10:30:00",subVendorsCount:5,cashiersCount:8},{id:"2",storeName:"متجر البركة",ownerName:"فاطمة علي",username:"fatima_store",email:"fatima@store.com",phone:"96887654321",location:"صلالة، عمان",status:"suspended",joinDate:"2024-02-01",lastLogin:null,subVendorsCount:2,cashiersCount:3}];return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.superAdmin}),o.jsxs("button",{onClick:()=>i(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),e.addVendor]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:o.jsx(Be,{className:"w-6 h-6 text-indigo-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.totalVendors}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:c.length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx(Be,{className:"w-6 h-6 text-green-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.activeVendors}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:c.filter(d=>d.status==="active").length})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:o.jsx(xt,{className:"w-6 h-6 text-red-600"})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e.suspendedVendors}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:c.filter(d=>d.status==="suspended").length})]})]})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value),placeholder:e.searchVendor,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.vendor}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.location}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.subVendorsCount}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.status}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.lastLogin}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:e.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(d=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:o.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:o.jsx(Be,{className:"h-6 w-6 text-indigo-600"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.storeName}),o.jsx("div",{className:"text-sm text-gray-500",children:d.ownerName})]})]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-gray-900",children:d.location}),o.jsx("div",{className:"text-sm text-gray-500",children:d.phone})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm text-gray-900",children:[d.subVendorsCount," ",t==="ar"?"مورد":"vendors"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[d.cashiersCount," ",t==="ar"?"كاشير":"cashiers"]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e[d.status]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.lastLogin?new Date(d.lastLogin).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"}):e.never}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>l(d),className:"text-indigo-600 hover:text-indigo-900 ml-4",children:e.edit}),o.jsx("button",{onClick:()=>{confirm(d.status==="active"?e.confirmSuspend:e.confirmDelete)&&console.log("Changing vendor status:",d.id)},className:"text-red-600 hover:text-red-900",children:d.status==="active"?e.suspend:e.delete})]})]},d.id))})]})})]})]})}function nv({selectedBusinessCode:t,onBusinessChange:e,assignments:n,className:s=""}){const{language:r}=Y(),i=Array.from(new Map(n.map(c=>[c.owner_business_code,c.owner_business_name])).entries()).map(([c,d])=>({code:c,name:d})),l={ar:{proposedBusinesses:"المتاجر المقترحة",allBusinesses:"جميع المتاجر",selectBusiness:"اختر متجر..."},en:{proposedBusinesses:"Proposed Businesses",allBusinesses:"All Businesses",selectBusiness:"Select business..."}}[r];return o.jsxs("div",{className:`flex items-center space-x-2 space-x-reverse ${s}`,children:[o.jsx(Be,{className:"w-5 h-5 text-gray-400"}),o.jsxs("select",{value:t,onChange:c=>e(c.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:r==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:l.allBusinesses}),i.map(c=>o.jsx("option",{value:c.code,children:c.name},c.code))]})]})}const tT={ar:{dashboard:"لوحة تحكم المورد",loading:"جاري التحميل...",noAssignments:"لم يتم تعيينك لأي متجر بعد",totalStores:"إجمالي المتاجر",allBusinesses:"جميع المتاجر",allBranches:"جميع الفروع",allOwners:"جميع أصحاب المتاجر",activeProducts:"المنتجات النشطة",monthlyRevenue:"الإيرادات الشهرية",commission:"نسبة العمولة",allStores:"جميع المتاجر",salesOverTime:"المبيعات عبر الزمن",salesAmount:"قيمة المبيعات",products:"المنتجات",productName:"اسم المنتج",store:"المتجر",branch:"الفرع",price:"السعر",quantity:"الكمية",status:"الحالة",active:"نشط",inactive:"غير نشط",outOfStock:"نفذت الكمية",edit:"تعديل",currency:"ر.ع",today:"اليوم",thisWeek:"هذا الأسبوع",thisMonth:"هذا الشهر",lastMonth:"الشهر الماضي"},en:{dashboard:"Vendor Dashboard",loading:"Loading...",noAssignments:"You have not been assigned to any stores yet",totalStores:"Total Stores",allBusinesses:"All Businesses",allBranches:"All Branches",allOwners:"All Store Owners",activeProducts:"Active Products",monthlyRevenue:"Monthly Revenue",commission:"Commission Rate",allStores:"All Stores",salesOverTime:"Sales Over Time",salesAmount:"Sales Amount",products:"Products",productName:"Product Name",store:"Store",branch:"Branch",price:"Price",quantity:"Quantity",status:"Status",active:"Active",inactive:"Inactive",outOfStock:"Out of Stock",edit:"Edit",currency:"OMR",today:"Today",thisWeek:"This Week",thisMonth:"This Month",lastMonth:"Last Month"}};function nT(){var m;const{language:t}=Y(),{user:e}=ce(),n=tT[t],[s,r]=w.useState([]),[i,a]=w.useState("all"),[l,c]=w.useState(null),[d,u]=w.useState(!0);w.useEffect(()=>{e!=null&&e.businessCode&&h()},[e==null?void 0:e.businessCode]);const h=async()=>{try{u(!0);const x=await ev(e.businessCode);r(x),x.length>0&&c(x[0])}catch(x){console.error("Error loading assignments:",x)}finally{u(!1)}},f={totalProducts:45,monthlyRevenue:5678.9,activeProducts:42,commission:10};return d?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):s.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full space-y-4",children:[o.jsx(Be,{className:"w-16 h-16 text-gray-400"}),o.jsx("p",{className:"text-gray-500",children:n.noAssignments})]}):o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.dashboard}),o.jsx("div",{className:"flex items-center space-x-4 space-x-reverse w-full max-w-xl",children:o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx(nv,{selectedBusinessCode:i,onBusinessChange:a,assignments:s,className:"w-full"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.branch}),o.jsxs("select",{value:(l==null?void 0:l.branch_name)||"",onChange:x=>{if(x.target.value==="all")c({...l,branch_name:"all"});else{const g=s.find(y=>y.owner_business_code===i&&y.branch_name===x.target.value);g&&c(g)}},className:"w-full border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",disabled:i==="all",children:[o.jsx("option",{value:"all",children:n.allBranches}),i!=="all"&&s.filter(x=>x.owner_business_code===i).map(x=>o.jsx("option",{value:x.branch_name,children:x.branch_name},x.assignment_id))]})]})]})})]}),l&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`border rounded-lg p-4 ${i==="all"?"bg-gray-50 border-gray-100":"bg-indigo-50 border-indigo-100"}`,children:o.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[o.jsx(Be,{className:`w-8 h-8 ${i==="all"?"text-gray-600":"text-indigo-600"}`}),o.jsx("div",{children:o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i==="all"?n.allBusinesses:(m=s.find(x=>x.owner_business_code===i))==null?void 0:m.owner_business_name})})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:n.activeProducts}),o.jsx("h3",{className:"text-2xl font-bold",children:f.activeProducts})]}),o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx(tn,{className:"w-6 h-6 text-green-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:n.monthlyRevenue}),o.jsxs("h3",{className:"text-2xl font-bold",children:[f.monthlyRevenue.toFixed(3)," ",n.currency]})]}),o.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:o.jsx(a0,{className:"w-6 h-6 text-blue-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:n.commission}),o.jsxs("h3",{className:"text-2xl font-bold",children:[f.commission,"%"]})]}),o.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:o.jsx(ho,{className:"w-6 h-6 text-yellow-600"})})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-1",children:n.totalProducts}),o.jsx("h3",{className:"text-2xl font-bold",children:f.totalProducts})]}),o.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:o.jsx(tn,{className:"w-6 h-6 text-purple-600"})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:n.latestSales}),o.jsx("p",{className:"text-gray-500 text-center py-8",children:n.noSalesData})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",children:n.topProducts}),o.jsx("p",{className:"text-gray-500 text-center py-8",children:n.noProductsData})]})]})]})]})}function sT({onSubmit:t,initialData:e,ownerBusinessCode:n,vendorBusinessCode:s,assignments:r,onCancel:i}){const{language:a}=Y(),l=Lr[a],{upload:c,isUploading:d,error:u}=eh(),{generateProductBarcode:h}=Zu(),[f,m]=w.useState((e==null?void 0:e.type)||"non-food"),[x,g]=w.useState((e==null?void 0:e.expiry_date)||""),[y,v]=w.useState((e==null?void 0:e.image_url)||""),[p,b]=w.useState(null),[j,_]=w.useState((e==null?void 0:e.barcode)||""),[C,S]=w.useState(null),[k,A]=w.useState((e==null?void 0:e.branch_name)||""),P=r.find(T=>T.owner_business_code===n),D=r.filter(T=>T.owner_business_code===n).map(T=>T.branch_name),M=async(T,N)=>{try{const R=await h({productId:Math.random().toString(36).substring(7),vendorId:s,name:T,price:N});return _(R),R}catch(R){return console.error("Error generating barcode:",R),null}};w.useEffect(()=>{S(n!=="all"&&!k?l.selectBranchFirst:null)},[n,k]);const B=async T=>{var R;const N=(R=T.target.files)==null?void 0:R[0];if(N){const O=URL.createObjectURL(N);b(O);try{const z=await c(N);z&&v(z)}catch{S(l.errorUploadingImage)}}},E=async T=>{if(T.preventDefault(),S(null),n==="all"){S(l.selectBusinessFirst);return}if(!k){S(l.selectBranchFirst);return}const N=new FormData(T.currentTarget),R=N.get("product_name"),O=parseFloat(N.get("price"));let z=j;if(!e&&!z&&(z=await M(R,O),!z)){S(l.errorGeneratingBarcode);return}const U={product_name:R,type:f,price:O,quantity:parseInt(N.get("quantity"),10),description:N.get("description"),image_url:y,barcode:z,business_code_of_owner:n,business_code_if_vendor:s,branch_name:k,current_page:"upcoming_products",accepted:!1,trackable:f==="food"};f==="food"&&x&&(U.expiry_date=x);try{await t(U)}catch{S(l.errorSavingProduct)}};return o.jsxs("form",{onSubmit:E,className:"space-y-6",dir:a==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:`border rounded-lg p-4 space-y-4 ${n==="all"?"bg-red-50 border-red-100":"bg-indigo-50 border-indigo-100"}`,children:[o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(Be,{className:`w-5 h-5 ${n==="all"?"text-red-600":"text-indigo-600"}`}),o.jsxs("span",{className:"font-medium",children:[l.sendingTo,":"]}),o.jsx("span",{className:n==="all"?"text-red-700 font-bold":"text-indigo-700",children:(P==null?void 0:P.owner_business_name)||l.selectBusiness})]}),o.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[o.jsx(wr,{className:`w-5 h-5 ${n==="all"?"text-red-600":"text-indigo-600"}`}),o.jsxs("select",{value:k,onChange:T=>A(T.target.value),required:!0,className:`flex-1 border rounded-md focus:ring-2 ${n==="all"?"bg-red-50 focus:ring-red-500 focus:border-red-500 cursor-not-allowed":"focus:ring-indigo-500 focus:border-indigo-500"}`,disabled:n==="all",dir:a==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"",children:l.selectBranch}),D.map(T=>o.jsx("option",{value:T,children:T},T))]})]})]}),o.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-yellow-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-yellow-700",children:l.pendingApprovalNotice})})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l.productImage," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"flex items-center space-x-4 space-x-reverse",children:o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:p?o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:p,alt:"Product preview",className:"h-40 w-40 object-cover rounded-md"}),o.jsx("button",{type:"button",onClick:()=>{b(null),v("")},className:"absolute top-0 right-0 -mr-2 -mt-2 bg-red-100 text-red-600 rounded-full p-1 hover:bg-red-200",children:"×"})]}):o.jsxs("div",{className:"space-y-1 text-center",children:[o.jsx(qu,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("div",{className:"flex text-sm text-gray-600",children:o.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500",children:[o.jsx("span",{children:l.chooseImage}),o.jsx("input",{type:"file",accept:"image/*",required:!(e!=null&&e.image_url),onChange:B,className:"sr-only"})]})}),o.jsx("p",{className:"text-xs text-gray-500",children:l.uploadInstructions})]})})})})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.productType," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{value:f,onChange:T=>m(T.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[o.jsx("option",{value:"food",children:l.food}),o.jsx("option",{value:"non-food",children:l.nonFood})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.productName," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"product_name",defaultValue:e==null?void 0:e.product_name,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:a==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.price," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"price",defaultValue:e==null?void 0:e.price,step:"0.001",min:"0",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:"ltr"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.quantity," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",name:"quantity",defaultValue:e==null?void 0:e.quantity,min:"0",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:"ltr"})]}),f==="food"&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.expiryDate," ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(_r,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:x,onChange:T=>g(T.target.value),required:!0,className:"block w-full pr-10 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l.description,o.jsxs("span",{className:"text-gray-500 text-xs mr-1",children:["(",l.optional,")"]})]}),o.jsx("textarea",{name:"description",defaultValue:e==null?void 0:e.description,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",dir:a==="ar"?"rtl":"ltr"})]})]}),(C||u)&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:C||u})})]})}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:l.cancel}),o.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:d?l.uploading:e?l.updateProduct:l.addProduct})]})]})}function rT(){const{language:t}=Y(),{user:e}=ce(),n=Lr[t],[s,r]=w.useState([]),[i,a]=w.useState("all"),[l,c]=w.useState("all"),[d,u]=w.useState([]),[h,f]=w.useState(!0),[m,x]=w.useState(!1),[g,y]=w.useState(null),[v,p]=w.useState(""),[b,j]=w.useState("all"),[_,C]=w.useState(null),[S,k]=w.useState(null);w.useEffect(()=>{e!=null&&e.businessCode&&A()},[e==null?void 0:e.businessCode]),w.useEffect(()=>{e!=null&&e.businessCode&&P()},[i,e==null?void 0:e.businessCode]);const A=async()=>{try{f(!0);const E=await ev(e.businessCode);r(E)}catch(E){console.error("Error loading assignments:",E),C(n.errorLoadingAssignments)}finally{f(!1)}},P=async()=>{if(e!=null&&e.businessCode)try{f(!0);const E=await Tk({businessCode:i==="all"?void 0:i,vendorBusinessCode:e.businessCode,branchName:l==="all"?void 0:l});u(E)}catch(E){console.error("Error loading products:",E),C(n.errorLoadingProducts)}finally{f(!1)}},D=async E=>{if(i)try{const T={...E,business_code_of_owner:i,business_code_if_vendor:e.businessCode,current_page:"upcoming_products",accepted:!1};g?await ey(g.product_id,T):await Z0(T),await P(),x(!1),y(null)}catch(T){console.error("Error saving product:",T),C(n.errorSavingProduct)}},M=async E=>{try{await ty(E.product_id),await P(),k(null)}catch(T){console.error("Error deleting product:",T),C(n.errorDeletingProduct)}},B=d.filter(E=>{const T=E.product_name.toLowerCase().includes(v.toLowerCase()),N=b==="all"||E.type===b;return T&&N});return h&&s.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{className:"text-gray-500",children:n.loading})}):s.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full space-y-4",children:[o.jsx(tn,{className:"w-16 h-16 text-gray-400"}),o.jsx("p",{className:"text-gray-500",children:n.noAssignments})]}):o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:n.products}),o.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse w-full max-w-xl",children:[o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx(nv,{selectedBusinessCode:i,onBusinessChange:a,assignments:s,className:"w-full"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:n.branch}),o.jsxs("select",{value:l,onChange:E=>c(E.target.value),className:"w-full border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",disabled:i==="all",children:[o.jsx("option",{value:"all",children:n.allBranches}),i!=="all"&&s.filter(E=>E.owner_business_code===i).map(E=>o.jsx("option",{value:E.branch_name,children:E.branch_name},E.assignment_id))]})]})]}),o.jsxs("button",{onClick:()=>{if(i==="all"){C(n.selectBusinessFirst);return}y(null),x(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center",children:[o.jsx(Tt,{className:"w-5 h-5 ml-2"}),n.addProduct]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:v,onChange:E=>p(E.target.value),placeholder:n.searchProduct,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("select",{value:b,onChange:E=>j(E.target.value),className:"border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:n.allProducts}),o.jsx("option",{value:"food",children:n.foodProducts}),o.jsx("option",{value:"non-food",children:n.nonFoodProducts})]})]})}),_&&o.jsx("div",{className:"p-4 bg-red-50",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(xt,{className:"h-5 w-5 text-red-400"})}),o.jsx("div",{className:"mr-3",children:o.jsx("p",{className:"text-sm text-red-700",children:_})})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.product}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.business}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.branch}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.type}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.price}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.quantity}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:n.status}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:n.actions})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(E=>{var T;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:E.image_url?o.jsx("img",{src:E.image_url,alt:E.product_name,className:"h-10 w-10 rounded-full object-cover"}):o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:o.jsx(tn,{className:"h-6 w-6 text-gray-500"})})}),o.jsxs("div",{className:"mr-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.product_name}),E.description&&o.jsx("div",{className:"text-sm text-gray-500",children:E.description})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:((T=s.find(N=>N.owner_business_code===E.business_code_of_owner))==null?void 0:T.owner_business_name)||n.unknownBusiness})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:E.branch_name})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E.type==="food"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:E.type==="food"?n.food:n.nonFood}),E.type==="food"&&E.expiry_date&&o.jsxs("div",{className:"mt-1 text-xs",children:[o.jsxs("span",{className:"text-gray-500",children:[n.expiryDate,":"]}),o.jsx("span",{className:`mr-1 ${new Date(E.expiry_date)<new Date?"text-red-600 font-medium":"text-gray-900"}`,children:new Date(E.expiry_date).toLocaleDateString(t==="ar"?"ar":"en-US",{dateStyle:"medium"})})]})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[E.price.toFixed(3)," ",n.currency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.quantity}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E.accepted?"bg-green-100 text-green-800":E.rejection_reason?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:E.accepted?n.approved:E.rejection_reason?n.rejected:n.pending}),E.rejection_reason&&o.jsx("p",{className:"text-xs text-red-600 mt-1",children:E.rejection_reason})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[o.jsx("button",{onClick:()=>{y(E),x(!0)},className:"text-indigo-600 hover:text-indigo-900 ml-4",children:n.edit}),o.jsx("button",{onClick:()=>k(E),className:"text-red-600 hover:text-red-900",children:n.delete})]})]},E.product_id)})})]})})]}),m&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:g?n.editProduct:n.addProduct}),o.jsx(sT,{onSubmit:D,initialData:g||void 0,ownerBusinessCode:i,assignments:s,onCancel:()=>{x(!1),y(null)}})]})}),S&&o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:n.confirmDelete}),o.jsx("p",{className:"text-gray-600 mb-6",children:n.deleteConfirmationMessage.replace("{name}",S.product_name)}),o.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[o.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:n.cancel}),o.jsx("button",{onClick:()=>M(S),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:n.confirmDelete})]})]})})]})}const iT={ar:{receiptsHistory:"سجل الفواتير",export:"تصدير",searchReceipt:"بحث برقم الفاتورة أو رقم العميل...",allStatuses:"جميع الحالات",completed:"مكتمل",refunded:"مسترجع",cancelled:"ملغي",allPaymentMethods:"جميع طرق الدفع",cash:"نقدي",card:"بطاقة",receiptNumber:"رقم الفاتورة",date:"التاريخ",customer:"العميل",amount:"المبلغ",paymentMethod:"طريقة الدفع",status:"الحالة",view:"عرض",guestCustomer:"عميل عابر",currency:"ر.ع"},en:{receiptsHistory:"Receipts History",export:"Export",searchReceipt:"Search by receipt number or customer...",allStatuses:"All Statuses",completed:"Completed",refunded:"Refunded",cancelled:"Cancelled",allPaymentMethods:"All Payment Methods",cash:"Cash",card:"Card",receiptNumber:"Receipt Number",date:"Date",customer:"Customer",amount:"Amount",paymentMethod:"Payment Method",status:"Status",view:"View",guestCustomer:"Guest Customer",currency:"OMR"}},oT=Array.from({length:10},(t,e)=>({id:`RCP${1e3+e}`,date:new Date(2024,2,20-e).toISOString(),customerName:e%3===0?null:`عميل ${e+1}`,customerPhone:e%3===0?null:`9681234567${e}`,total:100+e*25.5,items:3+e,paymentMethod:e%2===0?"cash":"card",status:e%5===0?"refunded":e%7===0?"cancelled":"completed"}));function aT(){const{language:t}=Y(),e=iT[t],[n,s]=w.useState({from:"",to:""}),[r,i]=w.useState(""),[a,l]=w.useState("all"),[c,d]=w.useState("all"),u=()=>{console.log("Exporting receipts...")},h=oT.filter(f=>{var p,b;const m=((p=f.customerName)==null?void 0:p.toLowerCase().includes(r.toLowerCase()))||!1||((b=f.customerPhone)==null?void 0:b.includes(r))||!1||f.id.toLowerCase().includes(r.toLowerCase()),x=a==="all"||f.status===a,g=c==="all"||f.paymentMethod===c,y=new Date(f.date),v=(!n.from||y>=new Date(n.from))&&(!n.to||y<=new Date(n.to));return m&&x&&g&&v});return o.jsxs("div",{className:"space-y-6",dir:t==="ar"?"rtl":"ltr",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e.receiptsHistory}),o.jsxs("button",{onClick:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[o.jsx(Zx,{className:"w-5 h-5 ml-2"}),e.export]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(ze,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"text",value:r,onChange:f=>i(f.target.value),placeholder:e.searchReceipt,className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr"})]}),o.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(_r,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:n.from,onChange:f=>s(m=>({...m,from:f.target.value})),className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),o.jsxs("div",{className:"relative flex-1",children:[o.jsx(_r,{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400"}),o.jsx("input",{type:"date",value:n.to,onChange:f=>s(m=>({...m,to:f.target.value})),className:"w-full pr-10 py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),o.jsxs("select",{value:a,onChange:f=>l(f.target.value),className:"w-full py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:e.allStatuses}),o.jsx("option",{value:"completed",children:e.completed}),o.jsx("option",{value:"refunded",children:e.refunded}),o.jsx("option",{value:"cancelled",children:e.cancelled})]}),o.jsxs("select",{value:c,onChange:f=>d(f.target.value),className:"w-full py-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:t==="ar"?"rtl":"ltr",children:[o.jsx("option",{value:"all",children:e.allPaymentMethods}),o.jsx("option",{value:"cash",children:e.cash}),o.jsx("option",{value:"card",children:e.card})]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.receiptNumber}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.date}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.customer}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.amount}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.paymentMethod}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.status}),o.jsx("th",{scope:"col",className:"relative px-6 py-3",children:o.jsx("span",{className:"sr-only",children:e.view})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(f=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:f.id}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(f.date).toLocaleDateString(t==="ar"?"ar":"en-US")}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.customerName?o.jsxs("div",{children:[o.jsx("div",{children:f.customerName}),o.jsx("div",{className:"text-xs text-gray-400",children:f.customerPhone})]}):e.guestCustomer}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[f.total.toFixed(2)," ",e.currency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.paymentMethod==="cash"?e.cash:e.card}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${f.status==="completed"?"bg-green-100 text-green-800":f.status==="refunded"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status==="completed"?e.completed:f.status==="refunded"?e.refunded:e.cancelled})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:o.jsx("button",{className:"text-indigo-600 hover:text-indigo-900",children:e.view})})]},f.id))})]})})]})]})}function lT({children:t}){const{user:e}=ce(),{settings:n,isLoading:s}=lS();return rs(),e?s?o.jsx("div",{className:"flex items-center justify-center h-screen",children:o.jsx("p",{className:"text-gray-500",children:"Loading settings..."})}):o.jsx(o.Fragment,{children:t}):o.jsx(Ha,{to:"/login",replace:!0})}function cT(){const{user:t}=ce();return rs().pathname==="/"&&!t?o.jsx(Ha,{to:"/login",replace:!0}):o.jsxs(C_,{children:[o.jsx(de,{path:"/login",element:o.jsx(dS,{})}),o.jsxs(de,{path:"/",element:o.jsx(lT,{children:o.jsx(aS,{})}),children:[o.jsx(de,{index:!0,element:o.jsx(Ha,{to:"/dashboard",replace:!0})}),(t==null?void 0:t.role)==="super_admin"?o.jsxs(o.Fragment,{children:[o.jsx(de,{path:"dashboard",element:o.jsx(KM,{})}),o.jsx(de,{path:"cashiers",element:o.jsx(XM,{})}),o.jsx(de,{path:"vendors",element:o.jsx(eT,{})})]}):(t==null?void 0:t.role)==="vendor"?o.jsxs(o.Fragment,{children:[o.jsx(de,{path:"dashboard",element:o.jsx(nT,{})}),o.jsx(de,{path:"products",element:o.jsx(rT,{})}),o.jsx(de,{path:"settings",element:o.jsx(xM,{})})]}):o.jsxs(o.Fragment,{children:[o.jsx(de,{path:"dashboard",element:o.jsx(hS,{})}),o.jsx(de,{path:"pos",element:o.jsx(jk,{})}),o.jsx(de,{path:"products",element:o.jsx(zk,{})}),o.jsx(de,{path:"upcoming-products",element:o.jsx(Ak,{})}),o.jsx(de,{path:"customers",element:o.jsx(sM,{})}),o.jsx(de,{path:"cash-drawer",element:o.jsx(oM,{})}),o.jsx(de,{path:"returns",element:o.jsx(tM,{})}),o.jsx(de,{path:"receipts",element:o.jsx(aT,{})}),o.jsx(de,{path:"reports",element:o.jsx(lM,{})}),((t==null?void 0:t.role)==="owner"||(t==null?void 0:t.role)==="manager")&&o.jsxs(o.Fragment,{children:[o.jsx(de,{path:"cashiers",element:o.jsx(EM,{})}),o.jsx(de,{path:"managers",element:o.jsx(IM,{})}),o.jsx(de,{path:"sub-vendors",element:o.jsx(FM,{})}),o.jsx(de,{path:"rentals",element:o.jsx(WM,{})}),o.jsx(de,{path:"branches",element:o.jsx(jM,{})}),o.jsx(de,{path:"coupons",element:o.jsx(qM,{})}),o.jsx(de,{path:"settings",element:o.jsx(dM,{})}),o.jsx(de,{path:"developer",element:o.jsx(QM,{})})]})]})]})]})}function dT(){return o.jsx(D_,{children:o.jsx(cT,{})})}zx(document.getElementById("root")).render(o.jsx(w.StrictMode,{children:o.jsx(dT,{})}));export{Pp as g};
